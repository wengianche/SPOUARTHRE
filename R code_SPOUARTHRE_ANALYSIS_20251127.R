#Project - SPOUSAL AGGREGATION OF ARTHRITIS AND COAGGREGATION OF OTHER CHRONIC COMORBIDITIES 
#BASED ON ANALYSIS PLAN_VERSION X CREATED BY PI WENG IAN CHE
#CREATED: 20251127
#UPDATED: 20251203
#ANALYST: WENG IAN CHE
#PURPOSE OF THIS SYNTAX: EXPLORE PERFORM STATISTICAL ANALYSES 
#R VERSION: version 4.4.3 (2025-02-28)
----------------------------------------------------------------------
#DATA SOURCE:
#CHARLS: hcharls_all_sp11 and hcharls_imp_all_long
#ELSA: helsa_all_sp27 (with original missing codes), helsa_all_sp28 (refine missing codes for occupation) and helsa_imp_all_long
#SHARE: hshare_all_26 and hshare_imp_all_long
#MHAS: hmhas_all_sp23 and hmhas_imp_all_long
#KLoSA: hklosa_all_sp22 
  
  
#Logbook
######################################################  
######################################################

#Things to pay attention
###################################################### 
######################################################

#Outline
######################################################
#INSTALL AND LOAD LIBRARY

#DESCRIPTIVE ANALYSES
#1. Household and individual characteristics at inclusion, as well as respondents' other chronic conditions by respondent gender and presence of arthritis in respondents
#2. Spousal arthritis/rheumatism and other chronic conditions by respondent gender and presence of arthritis in respondents

#STATISTICAL ANALYSES
#1. Spousal aggregation of arthritis/rheumatism: Crude models
#2. Complete case_Spousal aggregation of arthritis/rheumatism: Adjusted models
#3. Spousal coaggregation of other chronic diseases in individuals with arthritis/rheumatism: Crude models
#4. Complete case_Spousal coaggregation of other chronic diseases in individuals with arthritis/rheumatism: Adjusted models (No causal effects)
#5. Complete case_Spousal coaggregation of other chronic diseases in individuals with arthritis/rheumatism: Adjusted models (Causal direction from other chronic disease to arthritis)
#6. Complete case_Spousal coaggregation of other chronic diseases in individuals with arthritis/rheumatism: Adjusted models (Causal direction from arthritis to other chronic disease)

#ADDITIONAL ANALYSES
#1. Exclude Proxy interview: Crude models
#2. Exclude Proxy interview: Adjusted models
#3. Requiring >=2 self-reported doctor diagnosed arthritis across participating waves: Crude models
#4. Requiring >=2 self-reported doctor diagnosed arthritis across participating waves: Adjusted models
#5. Requiring >=2 self-reported doctor diagnosed other chronic diseases across participating waves: Crude models
#6. Requiring >=2 self-reported doctor diagnosed other chronic diseases across participating waves: Adjusted models
######################################################  
###################################################### 
#INSTALL AND LOAD LIBRARY, AND COUSTOM FUNCTION
###################################################### 
library(pacman)
pacman::p_load(Hmisc, #attach labels to variables
               haven,
               tidyverse,
               ggalluvial,
               ggplot2,
               plotly,
               labelled,
               writexl,
               gmodels,
               kableExtra,
               janitor,
               gtsummary,
               gt,
               cardx,
               naniar,
               mice,
               mitools,
               broom.mixed,
               MatchIt,
               VIM,
               corrplot
) 
#Function to get 2X2 table with frequency and proportion presented
freq_table <- function(table) {
  list(
    counts = addmargins(table),
    row_proportions = addmargins(prop.table(table, 1)),
    column_proportions = addmargins(prop.table(table, 2)),
    overall_proportions = addmargins(prop.table(table))
  )
}
###################################################### 
#DESCRIPTIVE ANALYSES
#1. Household and individual characteristics at inclusion, as well as respondents' other chronic conditions by respondent gender and presence of arthritis in respondents
#2. Spousal arthritis/rheumatism and other chronic conditions by respondent gender and presence of arthritis in respondents
###################################################### 
#1. Household and individual characteristics at inclusion, as well as respondents' other chronic conditions by respondent gender and presence of arthritis in respondents
###################################################### 
#CHARLS
###################################################### 
#Load data
setwd("/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/CHARLS")
load("hcharls_all_sp11.rda")

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

#Male as respondents and female as spouses
hcharls_male_t1 <- hcharls_male %>% mutate(across(where(haven::is.labelled), as.factor)) %>% mutate(rdrinkr=as.numeric(rdrinkr)) %>%
  select(rage, rabyear, hrural, rmcurln, raeducl, rmbmin, rmbmicat, rpact, rdrinkr, rsmokev, roccup, roccup3, hincome, hkcnt, ramomeducl, radadeducl, rclstress2, rshlta, radlfive, rmobilsev, rchrondis, arthritis, arthritis_dm, hibpe, hibpe_dm, diabe, diabe_dm, cancre, cancre_dm, lunge, lunge_dm, hearte, hearte_dm, stroke, stroke_dm, psyche, psyche_dm, dyslipe, dyslipe_dm, livere, livere_dm, kidneye, kidneye_dm, digeste, digeste_dm, asthmae) %>%
  tbl_summary(
    by = arthritis,
    type=list(
      rdrinkr ~ "continuous"
    ),
    statistic = list(
      all_continuous() ~ "{median} ({p25}, {p75})",
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_continuous() ~ 1,
                  all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      rage ~ "Age at interview", 
      rabyear ~ "Birth year",
      hrural ~ "Household living area",
      rmcurln ~ "Length of current marriage",
      raeducl ~ "Highest attained education level",
      roccup3 ~ "Occupation",
      hincome ~ "Household income",
      rpact ~ "Physcial activity",
      rdrinkr ~ "Number of drinks per day",
      rsmokev ~ "Ever smoking",
      rmbmin ~ "Measured BMI_cont",
      rmbmicat ~ "Measured BMI_cat",
      ramomeducl ~ "Maternal education",
      radadeducl ~ "Paternal education",
      hkcnt ~ "Weekly contact with children",
      rclstress2 ~ "Childhood/lifetime stressful events",
      rshlta ~ "Self-reported health, alternative scale",
      radlfive ~ "ADL summary, five",
      rmobilsev ~ "Mobility summary, seven",
      rchrondis ~ "Any other chronic diseases",
      hibpe ~ "Doctor-diagnosed hypertension",
      hibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      diabe ~ "Doctor-diagnosed diabetes",
      diabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      cancre ~ "Doctor-diagnosed cancer",
      cancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
      lunge ~ "Doctor-diagnosed lung disease",
      lunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
      hearte ~ "Doctor-diagnosed heart disease",
      hearte_dm ~ "Doctor-diagnosed/medication-indicated heart disease",
      stroke ~ "Doctor-diagnosed stroke",
      stroke_dm ~ "Doctor-diagnosed/medication-indicated stroke",
      psyche ~ "Doctor-diagnosed psychiatric problems",
      psyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
      dyslipe ~ "Doctor-diagnosed dyslipidemia",
      dyslipe_dm ~ "Doctor-diagnosed/medication-indicated dyslipidemia",
      livere ~ "Doctor-diagnosed liver disease",
      livere_dm ~ "Doctor-diagnosed/medication-indicated liver disease",
      kidneye ~ "Doctor-diagnosed kidney disease",
      kidneye_dm ~ "Doctor-diagnosed/medication-indicated kidney disease",
      digeste ~ "Doctor-diagnosed digestive disease",
      digeste_dm ~ "Doctor-diagnosed/medication-indicated digestive disease",
      asthmae ~ "Doctor-diagnosed asthmae")
  ) %>%
  add_p(
    test = list(
      all_continuous() ~ "wilcox.test", 
      ramomeducl ~ "fisher.test",
      rmobilsev ~ "fisher.test",
      hrural ~ "chisq.test",
      raeducl ~ "chisq.test",
      roccup3 ~ "chisq.test",
      rpact ~ "chisq.test",
      rsmokev ~ "chisq.test",
      rmbmicat ~ "chisq.test",
      radadeducl ~ "chisq.test",
      hkcnt ~ "chisq.test",
      rclstress2 ~ "chisq.test",
      rshlta ~ "chisq.test",
      radlfive ~ "chisq.test",
      rchrondis ~ "chisq.test",
      hibpe ~ "chisq.test",
      hibpe_dm ~ "chisq.test",
      diabe ~ "chisq.test",
      diabe_dm ~ "chisq.test",
      cancre ~ "chisq.test",
      cancre_dm ~ "chisq.test",
      lunge ~ "chisq.test",
      lunge_dm ~ "chisq.test",
      hearte ~ "chisq.test",
      hearte_dm ~ "chisq.test",
      stroke ~ "chisq.test",
      stroke_dm ~ "chisq.test",
      psyche ~ "chisq.test",
      psyche_dm ~ "chisq.test",
      dyslipe ~ "chisq.test",
      dyslipe_dm ~ "chisq.test",
      livere ~ "chisq.test",
      livere_dm ~ "chisq.test",
      kidneye ~ "chisq.test",
      kidneye_dm ~ "chisq.test",
      digeste ~ "chisq.test",
      digeste_dm ~ "chisq.test",
      asthmae ~ "chisq.test"
    ),
    test.args = list(
      ramomeducl ~ list(simulate.p.value = TRUE, B = 10000),
      rmobilsev ~ list(simulate.p.value = TRUE, B = 10000)),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 1. Baseline Characteristics, diagnoses of other chronic diseases among male respondents**") %>%
  bold_labels() %>%
  italicize_levels()
  
#Female as respondents and male as spouses  
hcharls_female_t1 <- hcharls_female %>% mutate(across(where(haven::is.labelled), as.factor)) %>% mutate(rdrinkr=as.numeric(rdrinkr)) %>%
  select(rage, rabyear, hrural, rmcurln, raeducl, rmbmin, rmbmicat, rpact, rdrinkr, rsmokev, roccup, roccup3, hincome, hkcnt, ramomeducl, radadeducl, rclstress2, rshlta, radlfive, rmobilsev, rchrondis, arthritis, arthritis_dm, hibpe, hibpe_dm, diabe, diabe_dm, cancre, cancre_dm, lunge, lunge_dm, hearte, hearte_dm, stroke, stroke_dm, psyche, psyche_dm, dyslipe, dyslipe_dm, livere, livere_dm, kidneye, kidneye_dm, digeste, digeste_dm, asthmae) %>%
    tbl_summary(
      by = arthritis,
      type=list(
        rdrinkr ~ "continuous"
      ),
      statistic = list(
        all_continuous() ~ "{median} ({p25}, {p75})",
        all_categorical() ~ "{n} ({p}%)"
      ),
      digits = list(all_continuous() ~ 1,
                    all_categorical() ~ 1),
      missing = "ifany",
      missing_text = "Missing values",
      label = list(
        rage ~ "Age at interview", 
        rabyear ~ "Birth year",
        hrural ~ "Household living area",
        rmcurln ~ "Length of current marriage",
        raeducl ~ "Highest attained education level",
        roccup3 ~ "Occupation",
        hincome ~ "Household income",
        rpact ~ "Physcial activity",
        rdrinkr ~ "Number of drinks per day",
        rsmokev ~ "Ever smoking",
        rmbmin ~ "Measured BMI_cont",
        rmbmicat ~ "Measured BMI_cat",
        ramomeducl ~ "Maternal education",
        radadeducl ~ "Paternal education",
        hkcnt ~ "Weekly contact with children",
        rclstress2 ~ "Childhood/lifetime stressful events",
        rshlta ~ "Self-reported health, alternative scale",
        radlfive ~ "ADL summary, five",
        rmobilsev ~ "Mobility summary, seven",
        rchrondis ~ "Any other chronic diseases",
        hibpe ~ "Doctor-diagnosed hypertension",
        hibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
        diabe ~ "Doctor-diagnosed diabetes",
        diabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
        cancre ~ "Doctor-diagnosed cancer",
        cancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
        lunge ~ "Doctor-diagnosed lung disease",
        lunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
        hearte ~ "Doctor-diagnosed heart disease",
        hearte_dm ~ "Doctor-diagnosed/medication-indicated heart disease",
        stroke ~ "Doctor-diagnosed stroke",
        stroke_dm ~ "Doctor-diagnosed/medication-indicated stroke",
        psyche ~ "Doctor-diagnosed psychiatric problems",
        psyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
        dyslipe ~ "Doctor-diagnosed dyslipidemia",
        dyslipe_dm ~ "Doctor-diagnosed/medication-indicated dyslipidemia",
        livere ~ "Doctor-diagnosed liver disease",
        livere_dm ~ "Doctor-diagnosed/medication-indicated liver disease",
        kidneye ~ "Doctor-diagnosed kidney disease",
        kidneye_dm ~ "Doctor-diagnosed/medication-indicated kidney disease",
        digeste ~ "Doctor-diagnosed digestive disease",
        digeste_dm ~ "Doctor-diagnosed/medication-indicated digestive disease",
        asthmae ~ "Doctor-diagnosed asthmae")
    ) %>%
    add_p(
      test = list(
        all_continuous() ~ "wilcox.test", 
        ramomeducl ~ "fisher.test",
        rmobilsev ~ "chisq.test",
        hrural ~ "chisq.test",
        raeducl ~ "chisq.test",
        roccup3 ~ "chisq.test",
        rpact ~ "chisq.test",
        rsmokev ~ "chisq.test",
        rmbmicat ~ "chisq.test",
        radadeducl ~ "chisq.test",
        hkcnt ~ "chisq.test",
        rclstress2 ~ "chisq.test",
        rshlta ~ "chisq.test",
        radlfive ~ "chisq.test",
        rchrondis ~ "chisq.test",
        hibpe ~ "chisq.test",
        hibpe_dm ~ "chisq.test",
        diabe ~ "chisq.test",
        diabe_dm ~ "chisq.test",
        cancre ~ "chisq.test",
        cancre_dm ~ "chisq.test",
        lunge ~ "chisq.test",
        lunge_dm ~ "chisq.test",
        hearte ~ "chisq.test",
        hearte_dm ~ "chisq.test",
        stroke ~ "chisq.test",
        stroke_dm ~ "chisq.test",
        psyche ~ "chisq.test",
        psyche_dm ~ "chisq.test",
        dyslipe ~ "chisq.test",
        dyslipe_dm ~ "chisq.test",
        livere ~ "chisq.test",
        livere_dm ~ "chisq.test",
        kidneye ~ "chisq.test",
        kidneye_dm ~ "chisq.test",
        digeste ~ "chisq.test",
        digeste_dm ~ "chisq.test",
        asthmae ~ "chisq.test"
      ),
      test.args = list(
        ramomeducl ~ list(simulate.p.value = TRUE, B = 10000)),
      pvalue_fun = function(x) style_pvalue(x, digits = 3)
    ) %>%
    add_overall() %>%
    modify_caption("**Table 1. Baseline Characteristics, diagnoses of other chronic diseases among female respondents**") %>%
    bold_labels() %>%
    italicize_levels()
###################################################### 
#ELSA
###################################################### 
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/ELSA')
load("helsa_all_sp28.rda")

#Divide dataset by respondent gender and recode rarelig_e
helsa_male <- helsa_all_sp28 %>% mutate(
  rarelig_e2=case_when(
    rarelig_e==1 ~ rarelig_e ,
    rarelig_e==8 ~ rarelig_e,
    is.na(rarelig_e) ~ rarelig_e,
    TRUE ~ 2)) %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% mutate(
  rarelig_e2=case_when(
    rarelig_e==1 ~ rarelig_e ,
    rarelig_e==8 ~ rarelig_e,
    is.na(rarelig_e) ~ rarelig_e,
    TRUE ~ 2)) %>% filter(ragender==2)

#Male as respondents and female as spouses
helsa_male_t1 <- helsa_male %>% mutate(across(where(haven::is.labelled), as.factor)) %>% mutate(rdrinkr=as.numeric(rdrinkr)) %>%
  select(rage, rabyear, rabplace, raracem, rmcurln, raeducl, rarelig_e2, rmbmin, rmbmicat, rpact, rdrinkr, rdrinke, rsmokev, roccup2_2, hincome, rkcnt, ramomeduage, radadeduage, rclstress, rshlt, radlfive, riadlza, rmobilsev, rchrondis, rspsupport, arthritis, hibpe, hibpe_dm, diabe, diabe_dm, cancre, cancre_dm, lunge, lunge_dm, hearte, stroke, psyche, psyche_dm, hchole, hchole_dm, asthmae, asthmae_dm, catracte, parkine, osteoe, osteoe_dm) %>%
  tbl_summary(
    by = arthritis,
    type=list(
      rdrinkr ~ "continuous",
      roccup2_2 ~ "categorical"
    ),
    statistic = list(
      all_continuous() ~ "{median} ({p25}, {p75})",
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_continuous() ~ 1,
                  all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      rage ~ "Age at interview", 
      rabyear ~ "Birth year",
      rabplace ~ "Birthplace",
      raracem ~ "Ethnicity",
      rarelig_e2 ~ "Religion",
      rmcurln ~ "Length of current marriage",
      raeducl ~ "Highest attained education level",
      roccup2_2 ~ "Occupation",
      hincome ~ "Household income",
      rpact ~ "Physcial activity",
      rdrinke ~ "Ever drinking",
      rdrinkr ~ "Number of drinks per day",
      rsmokev ~ "Ever smoking",
      rmbmin ~ "Measured BMI_cont",
      rmbmicat ~ "Measured BMI_cat",
      ramomeduage ~ "Maternal education",
      radadeduage ~ "Paternal education",
      rkcnt ~ "Weekly contact with children",
      rclstress ~ "Childhood/lifetime stressful events",
      rspsupport ~ "Spouse support 6-item score ",
      rshlt ~ "Self-reported health",
      radlfive ~ "ADL summary, five",
      riadlza ~ "IADL summary, five",
      rmobilsev ~ "Mobility summary, seven",
      rchrondis ~ "Any other chronic diseases",
      hibpe ~ "Doctor-diagnosed hypertension",
      hibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      diabe ~ "Doctor-diagnosed diabetes",
      diabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      cancre ~ "Doctor-diagnosed cancer",
      cancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
      lunge ~ "Doctor-diagnosed lung disease",
      lunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
      hearte ~ "Doctor-diagnosed heart disease",
      stroke ~ "Doctor-diagnosed stroke",
      psyche ~ "Doctor-diagnosed psychiatric problems",
      psyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
      hchole ~ "Doctor-diagnosed high cholesterol",
      hchole_dm ~ "Doctor-diagnosed/medication-indicated high cholesterol",
      asthmae ~ "Doctor-diagnosed asthmae",
      asthmae_dm ~ "Doctor-diagnosed/medication-indicated asthmae",
      parkine ~ "Doctor-diagnosed Parkinson's disease",
      osteoe ~ "Doctor-diagnosed osteoporosis",
      osteoe_dm ~ "Doctor-diagnosed/medication-indicated osteoporosis")
    ) %>%
  add_p(
    test = list(
      all_continuous() ~ "wilcox.test", 
      radlfive ~ "fisher.test",
      riadlza ~ "fisher.test",
      rmbmicat ~ "fisher.test",
      rspsupport ~ "fisher.test",
      rabplace ~ "chisq.test",
      raracem ~ "chisq.test",
      raeducl ~ "chisq.test",
      roccup2_2 ~ "chisq.test",
      rpact ~ "chisq.test",
      rdrinke ~ "chisq.test",
      rsmokev ~ "chisq.test",
      ramomeduage ~ "chisq.test",
      radadeduage ~ "chisq.test",
      rkcnt ~ "chisq.test",
      rclstress ~ "chisq.test",
      rshlt ~ "chisq.test",
      rmobilsev ~ "chisq.test",
      rchrondis ~ "chisq.test",
      hibpe ~ "chisq.test",
      hibpe_dm ~ "chisq.test",
      diabe ~ "chisq.test",
      diabe_dm ~ "chisq.test",
      cancre ~ "chisq.test",
      cancre_dm ~ "chisq.test",
      lunge ~ "chisq.test",
      lunge_dm ~ "chisq.test",
      hearte ~ "chisq.test",
      stroke ~ "chisq.test",
      psyche ~ "chisq.test",
      psyche_dm ~ "chisq.test",
      hchole ~ "chisq.test",
      hchole_dm ~ "chisq.test",
      asthmae ~ "chisq.test",
      asthmae_dm ~ "chisq.test",
      parkine ~ "chisq.test",
      osteoe ~ "chisq.test",
      osteoe_dm ~ "chisq.test"
    ),
    test.args = list(
      radlfive ~ list(simulate.p.value = TRUE, B = 10000),
      riadlza ~ list(simulate.p.value = TRUE, B = 10000),
      rmbmicat ~ list(simulate.p.value = TRUE, B = 10000),
      rspsupport ~ list(simulate.p.value = TRUE, B = 10000)),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 1. Baseline Characteristics, diagnoses of other chronic diseases among male respondents**") %>%
  bold_labels() %>%
  italicize_levels()

#Female as respondents and male as spouses  
helsa_female_t1 <- helsa_female %>% mutate(across(where(haven::is.labelled), as.factor)) %>% mutate(rdrinkr=as.numeric(rdrinkr)) %>%
  select(rage, rabyear, rabplace, raracem, rmcurln, raeducl, rarelig_e2, rmbmin, rmbmicat, rpact, rdrinkr, rdrinke, rsmokev, roccup2_2, hincome, rkcnt, ramomeduage, radadeduage, rclstress, rshlt, radlfive, riadlza, rmobilsev, rchrondis, rspsupport, arthritis, hibpe, hibpe_dm, diabe, diabe_dm, cancre, cancre_dm, lunge, lunge_dm, hearte, stroke, psyche, psyche_dm, hchole, hchole_dm, asthmae, asthmae_dm, catracte, parkine, osteoe, osteoe_dm) %>%
  tbl_summary(
    by = arthritis,
    type=list(
      rdrinkr ~ "continuous",
      roccup2_2 ~ "categorical"
    ),
    statistic = list(
      all_continuous() ~ "{median} ({p25}, {p75})",
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_continuous() ~ 1,
                  all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      rage ~ "Age at interview", 
      rabyear ~ "Birth year",
      rabplace ~ "Birthplace",
      raracem ~ "Ethnicity",
      rarelig_e2 ~ "Religion",
      rmcurln ~ "Length of current marriage",
      raeducl ~ "Highest attained education level",
      roccup2_2 ~ "Occupation",
      hincome ~ "Household income",
      rpact ~ "Physcial activity",
      rdrinke ~ "Ever drinking",
      rdrinkr ~ "Number of drinks per day",
      rsmokev ~ "Ever smoking",
      rmbmin ~ "Measured BMI_cont",
      rmbmicat ~ "Measured BMI_cat",
      ramomeduage ~ "Maternal education",
      radadeduage ~ "Paternal education",
      rkcnt ~ "Weekly contact with children",
      rclstress ~ "Childhood/lifetime stressful events",
      rspsupport ~ "Spouse support 6-item score ",
      rshlt ~ "Self-reported health",
      radlfive ~ "ADL summary, five",
      riadlza ~ "IADL summary, five",
      rmobilsev ~ "Mobility summary, seven",
      rchrondis ~ "Any other chronic diseases",
      hibpe ~ "Doctor-diagnosed hypertension",
      hibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      diabe ~ "Doctor-diagnosed diabetes",
      diabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      cancre ~ "Doctor-diagnosed cancer",
      cancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
      lunge ~ "Doctor-diagnosed lung disease",
      lunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
      hearte ~ "Doctor-diagnosed heart disease",
      stroke ~ "Doctor-diagnosed stroke",
      psyche ~ "Doctor-diagnosed psychiatric problems",
      psyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
      hchole ~ "Doctor-diagnosed high cholesterol",
      hchole_dm ~ "Doctor-diagnosed/medication-indicated high cholesterol",
      asthmae ~ "Doctor-diagnosed asthmae",
      asthmae_dm ~ "Doctor-diagnosed/medication-indicated asthmae",
      parkine ~ "Doctor-diagnosed Parkinson's disease",
      osteoe ~ "Doctor-diagnosed osteoporosis",
      osteoe_dm ~ "Doctor-diagnosed/medication-indicated osteoporosis")
  ) %>%
  add_p(
    test = list(
      all_continuous() ~ "wilcox.test", 
      radlfive ~ "fisher.test",
      riadlza ~ "fisher.test",
      rmbmicat ~ "fisher.test",
      rspsupport ~ "fisher.test",
      rabplace ~ "chisq.test",
      raracem ~ "chisq.test",
      raeducl ~ "chisq.test",
      roccup2_2 ~ "chisq.test",
      rpact ~ "chisq.test",
      rdrinke ~ "chisq.test",
      rsmokev ~ "chisq.test",
      ramomeduage ~ "chisq.test",
      radadeduage ~ "chisq.test",
      rkcnt ~ "chisq.test",
      rclstress ~ "chisq.test",
      rshlt ~ "chisq.test",
      rmobilsev ~ "chisq.test",
      rchrondis ~ "chisq.test",
      hibpe ~ "chisq.test",
      hibpe_dm ~ "chisq.test",
      diabe ~ "chisq.test",
      diabe_dm ~ "chisq.test",
      cancre ~ "chisq.test",
      cancre_dm ~ "chisq.test",
      lunge ~ "chisq.test",
      lunge_dm ~ "chisq.test",
      hearte ~ "chisq.test",
      stroke ~ "chisq.test",
      psyche ~ "chisq.test",
      psyche_dm ~ "chisq.test",
      hchole ~ "chisq.test",
      hchole_dm ~ "chisq.test",
      asthmae ~ "chisq.test",
      asthmae_dm ~ "chisq.test",
      parkine ~ "chisq.test",
      osteoe ~ "chisq.test",
      osteoe_dm ~ "chisq.test"
    ),
    test.args = list(
      radlfive ~ list(simulate.p.value = TRUE, B = 10000),
      riadlza ~ list(simulate.p.value = TRUE, B = 10000),
      rmbmicat ~ list(simulate.p.value = TRUE, B = 10000),
      rspsupport ~ list(simulate.p.value = TRUE, B = 10000)),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 1. Baseline Characteristics, diagnoses of other chronic diseases among female respondents**") %>%
  bold_labels() %>%
  italicize_levels()

###################################################### 
#SHARE
###################################################### 
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/SHARE')
load("hshare_all_sp26.rda")

#Divide dataset by respondent gender and recode rarelig_e
hshare_male <- hshare_all_sp26 %>% mutate(
  rarelig_s2=case_when(
    rarelig_s==1 | rarelig_s==2 |rarelig_s==3 ~ 1, #Christian
    rarelig_s==4 | rarelig_s==5 |rarelig_s==6 ~ 2, #Other
    rarelig_s==7 ~ 8,
    TRUE ~ NA_real_)) %>% filter(ragender==1) 
hshare_female <- hshare_all_sp26 %>% mutate(
  rarelig_s2=case_when(
    rarelig_s==1 | rarelig_s==2 |rarelig_s==3 ~ 1, #Christian
    rarelig_s==4 | rarelig_s==5 |rarelig_s==6 ~ 2, #Other
    rarelig_s==7 ~ 8,
    TRUE ~ NA_real_)) %>% filter(ragender==2) 

#Male as respondents and female as spouses
hshare_male_t1 <- hshare_male %>% mutate(across(where(haven::is.labelled), as.factor)) %>%
  select(rage, rabyear, rabplace2, hrural2, rmcurln, raeducl, rarelig_s2, rmbmin, rmbmicat, rpact, rdrinkw, rdrinkb, rsmokev, roccup2_2, hincome_max, hincome_min, hkcnt2, ramomeducl, radadeducl, rclstress, rshlt, radlfive, riadlza, rmobilsev, rchrondis, arthritis, hibpe, hibpe_dm, diabe, diabe_dm, cancre, lunge, lunge_dm, hearte, hearte_dm, stroke, psyche, psyche_dm, hchole, hchole_dm, catracte, parkine, ulcere, ulcere_dm) %>%
  tbl_summary(
    by = arthritis,
    type=list(
      roccup2_2 ~ "categorical"
    ),
    statistic = list(
      all_continuous() ~ "{median} ({p25}, {p75})",
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_continuous() ~ 1,
                  all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      rage ~ "Age at interview", 
      rabplace2 ~ "Birthplace",
      rarelig_s2 ~ "Religion",
      hrural2 ~ "Household living area",
      rmcurln ~ "Length of current marriage",
      raeducl ~ "Highest attained education level",
      rmbmin ~ "Measured BMI_cont",
      rmbmicat ~ "Measured BMI_cat",
      rpact ~ "Physcial activity",
      rdrinkw ~ "Drinks alcohol weekly ",
      rdrinkb ~ "Ever binge drinks",
      rsmokev ~ "Ever smoking",
      roccup2_2 ~ "Occupation",
      hincome_max ~ "Household income (take maximum value for inconsisteny)",
      hincome_min ~ "Household income (take minimum value for inconsisteny)",
      hkcnt2 ~ "Weekly contact with children",
      ramomeducl ~ "Maternal education",
      radadeducl ~ "Paternal education",
      rclstress ~ "Childhood/lifetime stressful events (four vars)",
      rshlt ~ "Self-reported health",
      radlfive ~ "ADL summary, five",
      riadlza ~ "IADL summary, five",
      rmobilsev ~ "Mobility summary, seven",
      rchrondis ~ "Any other chronic diseases",
      hibpe ~ "Doctor-diagnosed hypertension",
      hibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      diabe ~ "Doctor-diagnosed diabetes",
      diabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      cancre ~ "Doctor-diagnosed cancer",
      lunge ~ "Doctor-diagnosed lung disease",
      lunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
      hearte ~ "Doctor-diagnosed heart disease",
      hearte_dm ~ "Doctor-diagnosed/medication-indicated heart disease",
      stroke ~ "Doctor-diagnosed stroke",
      psyche ~ "Doctor-diagnosed psychiatric problems",
      psyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
      hchole ~ "Doctor-diagnosed high cholesterol",
      hchole_dm ~ "Doctor-diagnosed/medication-indicated high cholesterol",
      catracte ~ "Doctor-diagnosed catracts",
      parkine ~ "Doctor-diagnosed Parkinson's disease",
      ulcere ~ "Doctor-diagnosed ulcer",
      ulcere_dm ~ "Doctor-diagnosed/medication-indicated ulcer")
  ) %>%
  add_p(
    test = list(
      all_continuous() ~ "wilcox.test", 
      rabplace2 ~ "fisher.test",
      rarelig_s2 ~ "chisq.test",
      raeducl ~ "chisq.test",
      rmbmicat ~ "chisq.test",
      rpact ~ "chisq.test",
      rdrinkw ~ "chisq.test",
      rdrinkb ~ "chisq.test",
      rsmokev ~ "chisq.test",
      roccup2_2 ~ "chisq.test",
      hkcnt2 ~ "chisq.test",
      ramomeducl ~ "chisq.test",
      radadeducl ~ "chisq.test",
      rclstress ~ "chisq.test",
      rshlt ~ "chisq.test",
      radlfive ~ "chisq.test",
      riadlza ~ "chisq.test",
      rmobilsev ~ "chisq.test",
      rchrondis ~ "chisq.test",
      hibpe ~ "chisq.test",
      hibpe_dm ~ "chisq.test",
      diabe ~ "chisq.test",
      diabe_dm ~ "chisq.test",
      cancre ~ "chisq.test",
      lunge ~ "chisq.test",
      lunge_dm ~ "chisq.test",
      hearte ~ "chisq.test",
      hearte_dm ~ "chisq.test",
      stroke ~ "chisq.test",
      psyche ~ "chisq.test",
      psyche_dm ~ "chisq.test",
      hchole ~ "chisq.test",
      hchole_dm ~ "chisq.test",
      catracte ~ "chisq.test",
      parkine ~ "chisq.test",
      ulcere ~ "chisq.test",
      ulcere_dm ~ "chisq.test"
    ),
    test.args = list(
      rabplace2 ~ list(simulate.p.value = TRUE, B = 10000)),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 1. Baseline Characteristics, diagnoses of other chronic diseases among male respondents**") %>%
  bold_labels() %>%
  italicize_levels()

#Female as respondents and male as spouses  
hshare_female_t1 <- hshare_female %>% mutate(across(where(haven::is.labelled), as.factor)) %>% 
  select(rage, rabyear, rabplace2, hrural2, rmcurln, raeducl, rarelig_s2, rmbmin, rmbmicat, rpact, rdrinkw, rdrinkb, rsmokev, roccup2_2, hincome_max, hincome_min, hkcnt2, ramomeducl, radadeducl, rclstress, rshlt, radlfive, riadlza, rmobilsev, rchrondis, arthritis, hibpe, hibpe_dm, diabe, diabe_dm, cancre, lunge, lunge_dm, hearte, hearte_dm, stroke, psyche, psyche_dm, hchole, hchole_dm, catracte, parkine, ulcere, ulcere_dm) %>%
  tbl_summary(
    by = arthritis,
    type=list(
      roccup2_2 ~ "categorical"
    ),
    statistic = list(
      all_continuous() ~ "{median} ({p25}, {p75})",
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_continuous() ~ 1,
                  all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      rage ~ "Age at interview", 
      rabplace2 ~ "Birthplace",
      rarelig_s2 ~ "Religion",
      hrural2 ~ "Household living area",
      rmcurln ~ "Length of current marriage",
      raeducl ~ "Highest attained education level",
      rmbmin ~ "Measured BMI_cont",
      rmbmicat ~ "Measured BMI_cat",
      rpact ~ "Physcial activity",
      rdrinkw ~ "Drinks alcohol weekly ",
      rdrinkb ~ "Ever binge drinks",
      rsmokev ~ "Ever smoking",
      roccup2_2 ~ "Occupation",
      hincome_max ~ "Household income (take maximum value for inconsisteny)",
      hincome_min ~ "Household income (take minimum value for inconsisteny)",
      hkcnt2 ~ "Weekly contact with children",
      ramomeducl ~ "Maternal education",
      radadeducl ~ "Paternal education",
      rclstress ~ "Childhood/lifetime stressful events (four vars)",
      rshlt ~ "Self-reported health",
      radlfive ~ "ADL summary, five",
      riadlza ~ "IADL summary, five",
      rmobilsev ~ "Mobility summary, seven",
      rchrondis ~ "Any other chronic diseases",
      hibpe ~ "Doctor-diagnosed hypertension",
      hibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      diabe ~ "Doctor-diagnosed diabetes",
      diabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      cancre ~ "Doctor-diagnosed cancer",
      lunge ~ "Doctor-diagnosed lung disease",
      lunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
      hearte ~ "Doctor-diagnosed heart disease",
      hearte_dm ~ "Doctor-diagnosed/medication-indicated heart disease",
      stroke ~ "Doctor-diagnosed stroke",
      psyche ~ "Doctor-diagnosed psychiatric problems",
      psyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
      hchole ~ "Doctor-diagnosed high cholesterol",
      hchole_dm ~ "Doctor-diagnosed/medication-indicated high cholesterol",
      catracte ~ "Doctor-diagnosed catracts",
      parkine ~ "Doctor-diagnosed Parkinson's disease",
      ulcere ~ "Doctor-diagnosed ulcer",
      ulcere_dm ~ "Doctor-diagnosed/medication-indicated ulcer")
  ) %>%
  add_p(
    test = list(
      all_continuous() ~ "wilcox.test", 
      rabplace2 ~ "fisher.test",
      rarelig_s2 ~ "chisq.test",
      raeducl ~ "chisq.test",
      rmbmicat ~ "chisq.test",
      rpact ~ "chisq.test",
      rdrinkw ~ "chisq.test",
      rdrinkb ~ "chisq.test",
      rsmokev ~ "chisq.test",
      roccup2_2 ~ "chisq.test",
      hkcnt2 ~ "chisq.test",
      ramomeducl ~ "chisq.test",
      radadeducl ~ "chisq.test",
      rclstress ~ "chisq.test",
      rshlt ~ "chisq.test",
      radlfive ~ "chisq.test",
      riadlza ~ "chisq.test",
      rmobilsev ~ "chisq.test",
      rchrondis ~ "chisq.test",
      hibpe ~ "chisq.test",
      hibpe_dm ~ "chisq.test",
      diabe ~ "chisq.test",
      diabe_dm ~ "chisq.test",
      cancre ~ "chisq.test",
      lunge ~ "chisq.test",
      lunge_dm ~ "chisq.test",
      hearte ~ "chisq.test",
      hearte_dm ~ "chisq.test",
      stroke ~ "chisq.test",
      psyche ~ "chisq.test",
      psyche_dm ~ "chisq.test",
      hchole ~ "chisq.test",
      hchole_dm ~ "chisq.test",
      catracte ~ "chisq.test",
      parkine ~ "chisq.test",
      ulcere ~ "chisq.test",
      ulcere_dm ~ "chisq.test"
    ),
    test.args = list(
      rabplace2 ~ list(simulate.p.value = TRUE, B = 10000)),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 1. Baseline Characteristics, diagnoses of other chronic diseases among female respondents**") %>%
  bold_labels() %>%
  italicize_levels()
###################################################### 
#MHAS
###################################################### 
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/MHAS')
load("hmhas_all_sp23.rda")

#Divide dataset by respondent gender
hmhas_male <- hmhas_all_sp23 %>% filter(ragender==1) 
hmhas_female <- hmhas_all_sp23 %>% filter(ragender==2) 

#Male as respondents and female as spouses
hmhas_male_t1 <- hmhas_male %>% mutate(across(where(haven::is.labelled), as.factor)) %>% mutate(rdrinkr=as.numeric(rdrinkr), rbinged=as.numeric(rbinged)) %>%
  select(rage, rabyear, hrural2, raeducl, rbmin, rbmicat, rpactvg, rdrinkr, rdrinkb, rbinged, rsmokev, roccup2_2, hitot, hkcnt, rameduc_m, rafeduc_m, rclstress, rshlt, radlfive, riadlfour, rmobilsev, rchrondis, arthritis, arthritis_dm, hibpe, hibpe_dm, diabe, diabe_dm, cancre, cancre_dm, respe, respe_dm, hrtatte, hrtatte_dm, stroke, stroke_dm) %>%
  tbl_summary(
    by = arthritis,
    type=list(
      rdrinkr ~ "continuous",
      rbinged ~ "continuous",
      roccup2_2 ~ "categorical"
    ),
    statistic = list(
      all_continuous() ~ "{median} ({p25}, {p75})",
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_continuous() ~ 1,
                  all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      rage ~ "Age at interview", 
      rabyear ~ "Birth year",
      hrural2 ~ "Household living area",
      raeducl ~ "Highest attained education level",
      rbmin ~ "Self-reported BMI_cont",
      rbmicat ~ "Self-reported BMI_cat",
      rpactvg ~ "Vigorous physcial activity",
      rdrinkr ~ "Number of drinks/day when drinks",
      rdrinkb ~ "Ever binge drinks",
      rbinged ~ "Number of days binge drinks",
      rsmokev ~ "Ever smoking",
      roccup2_2 ~ "Occupation",
      hitot ~ "Household income",
      hkcnt ~ "Weekly contact with children",
      rameduc_m ~ "Maternal education",
      rafeduc_m ~ "Paternal education",
      rclstress ~ "Childhood/lifetime stressful events (three vars)",
      rshlt ~ "Self-reported health",
      radlfive ~ "ADL summary, five",
      riadlfour ~ "IADL summary, four",
      rmobilsev ~ "Mobility summary, seven",
      rchrondis ~ "Any other chronic diseases",
      arthritis_dm ~ "Doctor-diagnosed/medication-indicated arthritis",
      hibpe ~ "Doctor-diagnosed hypertension",
      hibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      diabe ~ "Doctor-diagnosed diabetes",
      diabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      cancre ~ "Doctor-diagnosed cancer",
      cancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
      respe ~ "Doctor-diagnosed respiratory disease",
      respe_dm ~ "Doctor-diagnosed/medication-indicated respiratory disease",
      hrtatte ~ "Doctor-diagnosed heart attack",
      hrtatte_dm ~ "Doctor-diagnosed/medication-indicated heart attack",
      stroke ~ "Doctor-diagnosed stroke",
      stroke_dm ~ "Doctor-diagnosed/medication-indicated stroke")
  ) %>%
  add_p(
    test = list(
      all_continuous() ~ "wilcox.test", 
all_categorical() ~ "chisq.test"
    ),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 1. Baseline Characteristics, diagnoses of other chronic diseases among male respondents**") %>%
  bold_labels() %>%
  italicize_levels()

#Female as respondents and male as spouses  
hmhas_female_t1 <- hmhas_female %>% mutate(across(where(haven::is.labelled), as.factor)) %>% mutate(rdrinkr=as.numeric(rdrinkr), rbinged=as.numeric(rbinged)) %>%
  select(rage, rabyear, hrural2, raeducl, rbmin, rbmicat, rpactvg, rdrinkr, rdrinkb, rbinged, rsmokev, roccup2_2, hitot, hkcnt, rameduc_m, rafeduc_m, rclstress, rshlt, radlfive, riadlfour, rmobilsev, rchrondis, arthritis, arthritis_dm, hibpe, hibpe_dm, diabe, diabe_dm, cancre, cancre_dm, respe, respe_dm, hrtatte, hrtatte_dm, stroke, stroke_dm) %>%
  tbl_summary(
    by = arthritis,
    type=list(
      rdrinkr ~ "continuous",
      rbinged ~ "continuous",
      roccup2_2 ~ "categorical"
    ),
    statistic = list(
      all_continuous() ~ "{median} ({p25}, {p75})",
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_continuous() ~ 1,
                  all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      rage ~ "Age at interview", 
      rabyear ~ "Birth year",
      hrural2 ~ "Household living area",
      raeducl ~ "Highest attained education level",
      rbmin ~ "Self-reported BMI_cont",
      rbmicat ~ "Self-reported BMI_cat",
      rpactvg ~ "Vigorous physcial activity",
      rdrinkr ~ "Number of drinks/day when drinks",
      rdrinkb ~ "Ever binge drinks",
      rbinged ~ "Number of days binge drinks",
      rsmokev ~ "Ever smoking",
      roccup2_2 ~ "Occupation",
      hitot ~ "Household income",
      hkcnt ~ "Weekly contact with children",
      rameduc_m ~ "Maternal education",
      rafeduc_m ~ "Paternal education",
      rclstress ~ "Childhood/lifetime stressful events (three vars)",
      rshlt ~ "Self-reported health",
      radlfive ~ "ADL summary, five",
      riadlfour ~ "IADL summary, four",
      rmobilsev ~ "Mobility summary, seven",
      rchrondis ~ "Any other chronic diseases",
      arthritis_dm ~ "Doctor-diagnosed/medication-indicated arthritis",
      hibpe ~ "Doctor-diagnosed hypertension",
      hibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      diabe ~ "Doctor-diagnosed diabetes",
      diabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      cancre ~ "Doctor-diagnosed cancer",
      cancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
      respe ~ "Doctor-diagnosed respiratory disease",
      respe_dm ~ "Doctor-diagnosed/medication-indicated respiratory disease",
      hrtatte ~ "Doctor-diagnosed heart attack",
      hrtatte_dm ~ "Doctor-diagnosed/medication-indicated heart attack",
      stroke ~ "Doctor-diagnosed stroke",
      stroke_dm ~ "Doctor-diagnosed/medication-indicated stroke")
  ) %>%
  add_p(
    test = list(
      all_continuous() ~ "wilcox.test", 
      all_categorical() ~ "chisq.test"
    ),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 1. Baseline Characteristics, diagnoses of other chronic diseases among female respondents**") %>%
  bold_labels() %>%
  italicize_levels()
###################################################### 
#KLoSA
###################################################### 
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/KLoSA')
load("hklosa_all_sp22.rda")

#Divide dataset by respondent gender
hklosa_male <- hklosa_all_sp22 %>% filter(ragender==1) %>% mutate(rrelig2=case_when(
  rrelig==1 | rrelig==2 ~ 1, #Christian
  rrelig==3 | rrelig==4 ~ 2, #Buddhist
  rrelig==5 ~ 3, #Other
  rrelig==6 ~ 8, #None
  TRUE ~ rrelig
))

hklosa_female <- hklosa_all_sp22 %>% filter(ragender==2) %>% mutate(rrelig2=case_when(
  rrelig==1 | rrelig==2 ~ 1, #Christian
  rrelig==3 | rrelig==4 ~ 2, #Buddhist
  rrelig==5 ~ 3, #Other
  rrelig==6 ~ 8, #None
  TRUE ~ rrelig
))

hklosa_miss <- hklosa_all_sp22 %>% dplyr::select(pid, rage, rabyear, ragender, rrural, rrelig, ramomeducl, radadeducl, raeducl, rpactvg, rdrinkr, rsmokev, roccup, roccup2_2, roccup3_2, rheight,rweight,rbmin, hincome2, rkcnt, rsoc, arthre2, hibpe2, diabe2, cancre2, lunge2, hearte2, stroke2, psyche2, livere2, catrcte2, rshlt, radlfive, riadlza, arthritis,arthritis_dm, hibpe, hibpe_dm, diabe, diabe_dm, cancre, cancre_dm, lunge, lunge_dm, hearte, hearte_dm, stroke, stroke_dm, psyche, psyche_dm, livere, livere_dm, catracte_dm) %>% 
  
#Male as respondents and female as spouses
hklosa_male_t1 <- hklosa_male %>% mutate(across(where(haven::is.labelled), as.factor)) %>% mutate(rdrinkr=as.numeric(rdrinkr)) %>%
  select(rage, rabyear, rrural, rrelig2, raeducl, rbmin, rbmicat, rpactvg, rdrinkr, rsmokev, roccup2_2, roccup3_2, hincome2, rkcnt, rsoc, ramomeducl, radadeducl, rshlt, radlfive, riadlza, rchrondis, arthritis,arthritis_dm, hibpe, hibpe_dm, diabe, diabe_dm, cancre, cancre_dm, lunge, lunge_dm, hearte, hearte_dm, stroke, stroke_dm, psyche, psyche_dm, livere, livere_dm, catracte_dm) %>%
  tbl_summary(
    by = arthritis,
    type=list(
      rdrinkr ~ "continuous",
      roccup2_2 ~ "categorical",
      roccup3_2 ~ "categorical"
    ),
    statistic = list(
      all_continuous() ~ "{median} ({p25}, {p75})",
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_continuous() ~ 1,
                  all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      rabyear ~ "Birth year", 
      rage ~ "Age at interview", 
      rrural ~ "Living area",
      rrelig2 ~ "Religion",
      raeducl ~ "Highest attained education level",
      roccup2_2 ~ "Occupation (Occupation code)",
      roccup3_2 ~ "Occupation (Industry code)",
      hincome2 ~ "Household income",
      rkcnt ~ "Weekly contact with children",
      rsoc ~ "Weekly social activity",
      ramomeducl ~ "Maternal education",
      radadeducl ~ "Paternal education",
      rbmin ~ "Self-reported BMI_cont",
      rbmicat ~ "Self-reported BMI_cat",
      rpactvg ~ "Vigorous physcial activity",
      rdrinkr ~ "Number of drinks/day when drinks",
      rsmokev ~ "Ever smoking",
      rshlt ~ "Self-reported health",
      radlfive ~ "ADL summary, five",
      riadlza ~ "IADL summary, five",
      arthritis_dm ~ "Doctor-diagnosed/medication-indicated arthritis",
      hibpe ~ "Doctor-diagnosed hypertension",
      hibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      diabe ~ "Doctor-diagnosed diabetes",
      diabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      cancre ~ "Doctor-diagnosed cancer",
      cancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
      lunge ~ "Doctor-diagnosed lung disease",
      lunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
      hearte ~ "Doctor-diagnosed heart disease",
      hearte_dm ~ "Doctor-diagnosed/medication-indicated heart disease",
      stroke ~ "Doctor-diagnosed stroke",
      stroke_dm ~ "Doctor-diagnosed/medication-indicated stroke",
      psyche ~ "Doctor-diagnosed psychiatric problems",
      psyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
      livere ~ "Doctor-diagnosed liver disease",
      livere_dm ~ "Doctor-diagnosed/medication-indicated liver disease",
      catracte_dm ~ "Treatment-indicated cataract")
  ) %>%
  add_p(
    test = list(
      all_continuous() ~ "wilcox.test",
      roccup3_2 ~ "fisher.test",
      ramomeducl ~ "fisher.test",
      rbmicat ~ "fisher.test",
      radlfive ~ "fisher.test",
      riadlza ~ "fisher.test",
      rrelig2 ~ "fisher.test",
      rrural ~ "chisq.test",
      raeducl ~ "chisq.test",
      roccup2_2 ~ "chisq.test",
      rkcnt ~ "chisq.test",
      rsoc ~ "chisq.test",
      radadeducl ~ "chisq.test",
      rpactvg ~ "chisq.test",
      rsmokev ~ "chisq.test",
      rshlt ~ "chisq.test",
      arthritis_dm ~ "chisq.test",
      hibpe ~ "chisq.test",
      hibpe_dm ~ "chisq.test",
      diabe ~ "chisq.test",
      diabe_dm ~ "chisq.test",
      cancre ~ "chisq.test",
      cancre_dm ~ "chisq.test",
      lunge ~ "chisq.test",
      lunge_dm ~ "chisq.test",
      hearte ~ "chisq.test",
      hearte_dm ~ "chisq.test",
      stroke ~ "chisq.test",
      stroke_dm ~ "chisq.test",
      psyche ~ "chisq.test",
      psyche_dm ~ "chisq.test",
      livere ~ "chisq.test",
      livere_dm ~ "chisq.test",
      catracte_dm ~ "chisq.test"
      ),
    test.args = list(
      roccup3_2 ~ list(simulate.p.value = TRUE, B = 10000),
      ramomeducl ~ list(simulate.p.value = TRUE, B = 10000),
      rbmicat ~ list(simulate.p.value = TRUE, B = 10000),
      radlfive ~ list(simulate.p.value = TRUE, B = 10000),
      rrelig2 ~ list(simulate.p.value = TRUE, B = 10000),
      riadlza ~ list(simulate.p.value = TRUE, B = 10000)),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 1. Baseline Characteristics, diagnoses of other chronic diseases among male respondents**") %>%
  bold_labels() %>%
  italicize_levels()

#Female as respondents and male as spouses  
hklosa_female_t1 <- hklosa_female %>% mutate(across(where(haven::is.labelled), as.factor))  %>% mutate(rdrinkr=as.numeric(rdrinkr)) %>%
  select(rage, rabyear, rrural, rrelig2, raeducl, rbmin, rbmicat, rpactvg, rdrinkr, rsmokev, roccup2_2, roccup3_2, hincome2, rkcnt, rsoc, ramomeducl, radadeducl, rshlt, radlfive, riadlza, rchrondis, arthritis,arthritis_dm, hibpe, hibpe_dm, diabe, diabe_dm, cancre, cancre_dm, lunge, lunge_dm, hearte, hearte_dm, stroke, stroke_dm, psyche, psyche_dm, livere, livere_dm, catracte_dm) %>%
  tbl_summary(
    by = arthritis,
    type=list(
      rdrinkr ~ "continuous",
      roccup2_2 ~ "categorical",
      roccup3_2 ~ "categorical"
    ),
    statistic = list(
      all_continuous() ~ "{median} ({p25}, {p75})",
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_continuous() ~ 1,
                  all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      rabyear ~ "Birth year", 
      rage ~ "Age at interview", 
      rrural ~ "Living area",
      rrelig2 ~ "Religion",
      raeducl ~ "Highest attained education level",
      roccup2_2 ~ "Occupation (Occupation code)",
      roccup3_2 ~ "Occupation (Industry code)",
      hincome2 ~ "Household income",
      rkcnt ~ "Weekly contact with children",
      rsoc ~ "Weekly social activity",
      ramomeducl ~ "Maternal education",
      radadeducl ~ "Paternal education",
      rbmin ~ "Self-reported BMI_cont",
      rbmicat ~ "Self-reported BMI_cat",
      rpactvg ~ "Vigorous physcial activity",
      rdrinkr ~ "Number of drinks/day when drinks",
      rsmokev ~ "Ever smoking",
      rshlt ~ "Self-reported health",
      radlfive ~ "ADL summary, five",
      riadlza ~ "IADL summary, five",
      arthritis_dm ~ "Doctor-diagnosed/medication-indicated arthritis",
      hibpe ~ "Doctor-diagnosed hypertension",
      hibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      diabe ~ "Doctor-diagnosed diabetes",
      diabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      cancre ~ "Doctor-diagnosed cancer",
      cancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
      lunge ~ "Doctor-diagnosed lung disease",
      lunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
      hearte ~ "Doctor-diagnosed heart disease",
      hearte_dm ~ "Doctor-diagnosed/medication-indicated heart disease",
      stroke ~ "Doctor-diagnosed stroke",
      stroke_dm ~ "Doctor-diagnosed/medication-indicated stroke",
      psyche ~ "Doctor-diagnosed psychiatric problems",
      psyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
      livere ~ "Doctor-diagnosed liver disease",
      livere_dm ~ "Doctor-diagnosed/medication-indicated liver disease",
      catracte_dm ~ "Treatment-indicated cataract")
  ) %>%
  add_p(
    test = list(
      all_continuous() ~ "wilcox.test",
      roccup2_2 ~ "fisher.test",
      roccup3_2 ~ "fisher.test",
      ramomeducl ~ "fisher.test",
      rbmicat ~ "fisher.test",
      radlfive ~ "fisher.test",
      riadlza ~ "fisher.test",
      rrelig2 ~ "chisq.test",
      rrural ~ "chisq.test",
      raeducl ~ "chisq.test",
      roccup2_2 ~ "chisq.test",
      rkcnt ~ "chisq.test",
      rsoc ~ "chisq.test",
      radadeducl ~ "chisq.test",
      rpactvg ~ "chisq.test",
      rsmokev ~ "chisq.test",
      rshlt ~ "chisq.test",
      arthritis_dm ~ "chisq.test",
      hibpe ~ "chisq.test",
      hibpe_dm ~ "chisq.test",
      diabe ~ "chisq.test",
      diabe_dm ~ "chisq.test",
      cancre ~ "chisq.test",
      cancre_dm ~ "chisq.test",
      lunge ~ "chisq.test",
      lunge_dm ~ "chisq.test",
      hearte ~ "chisq.test",
      hearte_dm ~ "chisq.test",
      stroke ~ "chisq.test",
      stroke_dm ~ "chisq.test",
      psyche ~ "chisq.test",
      psyche_dm ~ "chisq.test",
      livere ~ "chisq.test",
      livere_dm ~ "chisq.test",
      catracte_dm ~ "chisq.test"
    ),
    test.args = list(
      roccup2_2 ~ list(simulate.p.value = TRUE, B = 10000),
      roccup3_2 ~ list(simulate.p.value = TRUE, B = 10000),
      ramomeducl ~ list(simulate.p.value = TRUE, B = 10000),
      rbmicat ~ list(simulate.p.value = TRUE, B = 10000),
      radlfive ~ list(simulate.p.value = TRUE, B = 10000),
      riadlza ~ list(simulate.p.value = TRUE, B = 10000)),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 1. Baseline Characteristics, diagnoses of other chronic diseases among female respondents**") %>%
  bold_labels() %>%
  italicize_levels()
###################################################### 
#Save tables as excel
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Output/Descriptive data')
write_xlsx(
  list(
    "hcharls_male" = as.data.frame(hcharls_male_t1$table_body),
    "hcharls_female" = as.data.frame(hcharls_female_t1$table_body),
    "helsa_male" = as.data.frame(helsa_male_t1$table_body),
    "helsa_female" = as.data.frame(helsa_female_t1$table_body),
    "hshare_male" = as.data.frame(hshare_male_t1$table_body),
    "hshare_female" = as.data.frame(hshare_female_t1$table_body),
    "hmhas_male" = as.data.frame(hmhas_male_t1$table_body),
    "hmhas_female" = as.data.frame(hmhas_female_t1$table_body),
    "hklosa_male" = as.data.frame(hklosa_male_t1$table_body),
    "hklosa_female" = as.data.frame(hklosa_female_t1$table_body)
  ),
  path = "Table_baseline_diagnoses_respondent_all_datasets_251128.xlsx"
)
###################################################### 
#2. Spousal arthritis/rheumatism and other chronic conditions by respondent gender and presence of arthritis in respondents
###################################################### 
#CHARLS
###################################################### 
#Load data
setwd("/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/CHARLS")
load("hcharls_all_sp11.rda")

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

#Male as respondents and female as spouses
hcharls_male_t2 <- hcharls_male %>% mutate(across(where(haven::is.labelled), as.factor)) %>% 
  select(arthritis, sarthritis, sarthritis_dm, shibpe, shibpe_dm, sdiabe, sdiabe_dm, scancre, scancre_dm, slunge, slunge_dm, shearte, shearte_dm, sstroke, sstroke_dm, spsyche, spsyche_dm, sdyslipe, sdyslipe_dm, slivere, slivere_dm, skidneye, skidneye_dm, sdigeste, sdigeste_dm, sasthmae) %>%
  tbl_summary(
    by = arthritis,
    statistic = list(
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      sarthritis ~ "Doctor-diagnosed arthritis/rheumatism",
      sarthritis_dm ~ "Doctor-diagnosed/medication-indicated arthritis/rheumatism",
      shibpe ~ "Doctor-diagnosed hypertension",
      shibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      sdiabe ~ "Doctor-diagnosed diabetes",
      sdiabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      scancre ~ "Doctor-diagnosed cancer",
      scancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
      slunge ~ "Doctor-diagnosed lung disease",
      slunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
      shearte ~ "Doctor-diagnosed heart disease",
      shearte_dm ~ "Doctor-diagnosed/medication-indicated heart disease",
      sstroke ~ "Doctor-diagnosed stroke",
      sstroke_dm ~ "Doctor-diagnosed/medication-indicated stroke",
      spsyche ~ "Doctor-diagnosed psychiatric problems",
      spsyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
      sdyslipe ~ "Doctor-diagnosed dyslipidemia",
      sdyslipe_dm ~ "Doctor-diagnosed/medication-indicated dyslipidemia",
      slivere ~ "Doctor-diagnosed liver disease",
      slivere_dm ~ "Doctor-diagnosed/medication-indicated liver disease",
      skidneye ~ "Doctor-diagnosed kidney disease",
      skidneye_dm ~ "Doctor-diagnosed/medication-indicated kidney disease",
      sdigeste ~ "Doctor-diagnosed digestive disease",
      sdigeste_dm ~ "Doctor-diagnosed/medication-indicated digestive disease",
      sasthmae ~ "Doctor-diagnosed asthmae")
  ) %>%
  add_p(
    test = list(
      all_categorical() ~ "chisq.test"),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 2. Wives' arthritis/rheumatism and other chronic diseases among male respondents**") %>%
  bold_labels() %>%
  italicize_levels()

#Female as respondents and males as spouses
hcharls_female_t2 <- hcharls_female %>% mutate(across(where(haven::is.labelled), as.factor)) %>% 
  select(arthritis, sarthritis, sarthritis_dm, shibpe, shibpe_dm, sdiabe, sdiabe_dm, scancre, scancre_dm, slunge, slunge_dm, shearte, shearte_dm, sstroke, sstroke_dm, spsyche, spsyche_dm, sdyslipe, sdyslipe_dm, slivere, slivere_dm, skidneye, skidneye_dm, sdigeste, sdigeste_dm, sasthmae) %>%
  tbl_summary(
    by = arthritis,
    statistic = list(
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      sarthritis ~ "Doctor-diagnosed arthritis/rheumatism",
      sarthritis_dm ~ "Doctor-diagnosed/medication-indicated arthritis/rheumatism",
      shibpe ~ "Doctor-diagnosed hypertension",
      shibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      sdiabe ~ "Doctor-diagnosed diabetes",
      sdiabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      scancre ~ "Doctor-diagnosed cancer",
      scancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
      slunge ~ "Doctor-diagnosed lung disease",
      slunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
      shearte ~ "Doctor-diagnosed heart disease",
      shearte_dm ~ "Doctor-diagnosed/medication-indicated heart disease",
      sstroke ~ "Doctor-diagnosed stroke",
      sstroke_dm ~ "Doctor-diagnosed/medication-indicated stroke",
      spsyche ~ "Doctor-diagnosed psychiatric problems",
      spsyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
      sdyslipe ~ "Doctor-diagnosed dyslipidemia",
      sdyslipe_dm ~ "Doctor-diagnosed/medication-indicated dyslipidemia",
      slivere ~ "Doctor-diagnosed liver disease",
      slivere_dm ~ "Doctor-diagnosed/medication-indicated liver disease",
      skidneye ~ "Doctor-diagnosed kidney disease",
      skidneye_dm ~ "Doctor-diagnosed/medication-indicated kidney disease",
      sdigeste ~ "Doctor-diagnosed digestive disease",
      sdigeste_dm ~ "Doctor-diagnosed/medication-indicated digestive disease",
      sasthmae ~ "Doctor-diagnosed asthmae")
  ) %>%
  add_p(
    test = list(
      all_categorical() ~ "chisq.test"),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 2. Husbands' arthritis/rheumatism and other chronic diseases among female respondents**") %>%
  bold_labels() %>%
  italicize_levels()
###################################################### 
#ELSA
###################################################### 
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/ELSA')
load("helsa_all_sp28.rda")

#Divide dataset by respondent gender and recode rarelig_e
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

#Male as respondents and female as spouses
helsa_male_t2 <- helsa_male %>% mutate(across(where(haven::is.labelled), as.factor)) %>% 
  select(arthritis, sarthritis, shibpe, shibpe_dm, sdiabe, sdiabe_dm, scancre, scancre_dm, slunge, slunge_dm, shearte, sstroke, spsyche, spsyche_dm, shchole, shchole_dm, sasthmae, sasthmae_dm, scatracte, sparkine, sosteoe, sosteoe_dm) %>%
  tbl_summary(
    by = arthritis,
    statistic = list(
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      sarthritis ~ "Doctor-diagnosed arthritis/rheumatism",
      shibpe ~ "Doctor-diagnosed hypertension",
      shibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      sdiabe ~ "Doctor-diagnosed diabetes",
      sdiabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      scancre ~ "Doctor-diagnosed cancer",
      scancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
      slunge ~ "Doctor-diagnosed lung disease",
      slunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
      shearte ~ "Doctor-diagnosed heart disease",
      sstroke ~ "Doctor-diagnosed stroke",
      spsyche ~ "Doctor-diagnosed psychiatric problems",
      spsyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
      shchole ~ "Doctor-diagnosed high cholesterol",
      shchole_dm ~ "Doctor-diagnosed/medication-indicated high cholesterol",
      sasthmae ~ "Doctor-diagnosed asthmae",
      sasthmae_dm ~ "Doctor-diagnosed/medication-indicated asthmae",
      sparkine ~ "Doctor-diagnosed Parkinson's disease",
      scatracte ~ "Doctor-diagnosed cataract",
      sosteoe ~ "Doctor-diagnosed osteoporosis",
      sosteoe_dm ~ "Doctor-diagnosed/medication-indicated osteoporosis")
  ) %>%
  add_p(
    test = list(
      all_categorical() ~ "chisq.test"),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 2. Wives' arthritis/rheumatism and other chronic diseases among male respondents**") %>%
  bold_labels() %>%
  italicize_levels()

#Female as respondents and male as spouses
helsa_female_t2 <- helsa_female %>% mutate(across(where(haven::is.labelled), as.factor)) %>% 
  select(arthritis, sarthritis, shibpe, shibpe_dm, sdiabe, sdiabe_dm, scancre, scancre_dm, slunge, slunge_dm, shearte, sstroke, spsyche, spsyche_dm, shchole, shchole_dm, sasthmae, sasthmae_dm, scatracte, sparkine, sosteoe, sosteoe_dm) %>%
  tbl_summary(
    by = arthritis,
    statistic = list(
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      sarthritis ~ "Doctor-diagnosed arthritis/rheumatism",
      shibpe ~ "Doctor-diagnosed hypertension",
      shibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      sdiabe ~ "Doctor-diagnosed diabetes",
      sdiabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      scancre ~ "Doctor-diagnosed cancer",
      scancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
      slunge ~ "Doctor-diagnosed lung disease",
      slunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
      shearte ~ "Doctor-diagnosed heart disease",
      sstroke ~ "Doctor-diagnosed stroke",
      spsyche ~ "Doctor-diagnosed psychiatric problems",
      spsyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
      shchole ~ "Doctor-diagnosed high cholesterol",
      shchole_dm ~ "Doctor-diagnosed/medication-indicated high cholesterol",
      sasthmae ~ "Doctor-diagnosed asthmae",
      sasthmae_dm ~ "Doctor-diagnosed/medication-indicated asthmae",
      sparkine ~ "Doctor-diagnosed Parkinson's disease",
      scatracte ~ "Doctor-diagnosed cataract",
      sosteoe ~ "Doctor-diagnosed osteoporosis",
      sosteoe_dm ~ "Doctor-diagnosed/medication-indicated osteoporosis")
  ) %>%
  add_p(
    test = list(
      all_categorical() ~ "chisq.test"),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 2. Husbands' arthritis/rheumatism and other chronic diseases among female respondents**") %>%
  bold_labels() %>%
  italicize_levels()
###################################################### 
#SHARE
###################################################### 
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/SHARE')
load("hshare_all_sp26.rda")

#Divide dataset by respondent gender and recode rarelig_e
hshare_male <- hshare_all_sp26 %>% filter(ragender==1) 
hshare_female <- hshare_all_sp26 %>% filter(ragender==2) 

#Male as respondents and female as spouses
hshare_male_t2 <- hshare_male %>% mutate(across(where(haven::is.labelled), as.factor)) %>%
  select(arthritis, sarthritis, shibpe, shibpe_dm, sdiabe, sdiabe_dm, scancre, slunge, slunge_dm, shearte, shearte_dm, sstroke, spsyche, spsyche_dm, shchole, shchole_dm, scatracte, sparkine, sulcere, sulcere_dm) %>%
  tbl_summary(
    by = arthritis,
    statistic = list(
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      sarthritis ~ "Doctor-diagnosed arthritis/rheumatism",
      shibpe ~ "Doctor-diagnosed hypertension",
      shibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      sdiabe ~ "Doctor-diagnosed diabetes",
      sdiabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      scancre ~ "Doctor-diagnosed cancer",
      slunge ~ "Doctor-diagnosed lung disease",
      slunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
      shearte ~ "Doctor-diagnosed heart disease",
      shearte_dm ~ "Doctor-diagnosed/medication-indicated heart disease",
      sstroke ~ "Doctor-diagnosed stroke",
      spsyche ~ "Doctor-diagnosed psychiatric problems",
      spsyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
      shchole ~ "Doctor-diagnosed high cholesterol",
      shchole_dm ~ "Doctor-diagnosed/medication-indicated high cholesterol",
      scatracte ~ "Doctor-diagnosed catracts",
      sparkine ~ "Doctor-diagnosed Parkinson's disease",
      sulcere ~ "Doctor-diagnosed ulcer",
      sulcere_dm ~ "Doctor-diagnosed/medication-indicated ulcer")
  ) %>%
  add_p(
    test = list(
      all_categorical() ~ "chisq.test"),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 2. Wives' arthritis/rheumatism and other chronic diseases among male respondents**") %>%
  bold_labels() %>%
  italicize_levels()

#Female as respondents and male as spouses
hshare_female_t2 <- hshare_female %>% mutate(across(where(haven::is.labelled), as.factor)) %>%
  select(arthritis, sarthritis, shibpe, shibpe_dm, sdiabe, sdiabe_dm, scancre, slunge, slunge_dm, shearte, shearte_dm, sstroke, spsyche, spsyche_dm, shchole, shchole_dm, scatracte, sparkine, sulcere, sulcere_dm) %>%
  tbl_summary(
    by = arthritis,
    statistic = list(
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      sarthritis ~ "Doctor-diagnosed arthritis/rheumatism",
      shibpe ~ "Doctor-diagnosed hypertension",
      shibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      sdiabe ~ "Doctor-diagnosed diabetes",
      sdiabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      scancre ~ "Doctor-diagnosed cancer",
      slunge ~ "Doctor-diagnosed lung disease",
      slunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
      shearte ~ "Doctor-diagnosed heart disease",
      shearte_dm ~ "Doctor-diagnosed/medication-indicated heart disease",
      sstroke ~ "Doctor-diagnosed stroke",
      spsyche ~ "Doctor-diagnosed psychiatric problems",
      spsyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
      shchole ~ "Doctor-diagnosed high cholesterol",
      shchole_dm ~ "Doctor-diagnosed/medication-indicated high cholesterol",
      scatracte ~ "Doctor-diagnosed catracts",
      sparkine ~ "Doctor-diagnosed Parkinson's disease",
      sulcere ~ "Doctor-diagnosed ulcer",
      sulcere_dm ~ "Doctor-diagnosed/medication-indicated ulcer")
  ) %>%
  add_p(
    test = list(
      all_categorical() ~ "chisq.test"),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 2. Husbands' arthritis/rheumatism and other chronic diseases among female respondents**") %>%
  bold_labels() %>%
  italicize_levels()
###################################################### 
#MHAS
###################################################### 
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/MHAS')
load("hmhas_all_sp23.rda")

#Divide dataset by respondent gender
hmhas_male <- hmhas_all_sp23 %>% filter(ragender==1) 
hmhas_female <- hmhas_all_sp23 %>% filter(ragender==2) 

#Male as respondents and female as spouses
hmhas_male_t2 <- hmhas_male %>% mutate(across(where(haven::is.labelled), as.factor)) %>% 
  select(arthritis, sarthritis, sarthritis_dm, shibpe, shibpe_dm, sdiabe, sdiabe_dm, scancre, scancre_dm, srespe, srespe_dm, shrtatte, shrtatte_dm, sstroke, sstroke_dm) %>%
  tbl_summary(
    by = arthritis,
    statistic = list(
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      sarthritis ~ "Doctor-diagnosed arthritis/rheumatism",
      sarthritis_dm ~ "Doctor-diagnosed/medication-indicated arthritis/rheumatism",
      shibpe ~ "Doctor-diagnosed hypertension",
      shibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      sdiabe ~ "Doctor-diagnosed diabetes",
      sdiabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      scancre ~ "Doctor-diagnosed cancer",
      scancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
      srespe ~ "Doctor-diagnosed respiratory disease",
      srespe_dm ~ "Doctor-diagnosed/medication-indicated respiratory disease",
      shrtatte ~ "Doctor-diagnosed heart attack",
      shrtatte_dm ~ "Doctor-diagnosed/medication-indicated heart attack",
      sstroke ~ "Doctor-diagnosed stroke",
      sstroke_dm ~ "Doctor-diagnosed/medication-indicated stroke")
  ) %>%
  add_p(
    test = list(all_categorical() ~ "chisq.test"),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 2. Wives' arthritis/rheumatism and other chronic diseases among male respondents**") %>%
  bold_labels() %>%
  italicize_levels()

#Female as respondents and male as spouses
hmhas_female_t2 <- hmhas_female %>% mutate(across(where(haven::is.labelled), as.factor)) %>% 
  select(arthritis, sarthritis, sarthritis_dm, shibpe, shibpe_dm, sdiabe, sdiabe_dm, scancre, scancre_dm, srespe, srespe_dm, shrtatte, shrtatte_dm, sstroke, sstroke_dm) %>%
  tbl_summary(
    by = arthritis,
    statistic = list(
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      sarthritis ~ "Doctor-diagnosed arthritis/rheumatism",
      sarthritis_dm ~ "Doctor-diagnosed/medication-indicated arthritis/rheumatism",
      shibpe ~ "Doctor-diagnosed hypertension",
      shibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      sdiabe ~ "Doctor-diagnosed diabetes",
      sdiabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      scancre ~ "Doctor-diagnosed cancer",
      scancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
      srespe ~ "Doctor-diagnosed respiratory disease",
      srespe_dm ~ "Doctor-diagnosed/medication-indicated respiratory disease",
      shrtatte ~ "Doctor-diagnosed heart attack",
      shrtatte_dm ~ "Doctor-diagnosed/medication-indicated heart attack",
      sstroke ~ "Doctor-diagnosed stroke",
      sstroke_dm ~ "Doctor-diagnosed/medication-indicated stroke")
  ) %>%
  add_p(
    test = list(all_categorical() ~ "chisq.test"),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 2. Husbands' arthritis/rheumatism and other chronic diseases among female respondents**") %>%
  bold_labels() %>%
  italicize_levels()
###################################################### 
#KLoSA
###################################################### 
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/KLoSA')
load("hklosa_all_sp22.rda")

#Divide dataset by respondent gender
hklosa_male <- hklosa_all_sp22 %>% filter(ragender==1) 
hklosa_female <- hklosa_all_sp22 %>% filter(ragender==2) 

#Male as respondents and female as spouses
hklosa_male_t2 <- hklosa_male %>% mutate(across(where(haven::is.labelled), as.factor)) %>% 
  select(arthritis,sarthritis, sarthritis_dm, shibpe, shibpe_dm, sdiabe, sdiabe_dm, scancre, scancre_dm, slunge, slunge_dm, shearte, shearte_dm, sstroke, sstroke_dm, spsyche, spsyche_dm, slivere, slivere_dm, scatracte_dm) %>%
  tbl_summary(
    by = arthritis,
    statistic = list(
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      sarthritis ~ "Doctor-diagnosed arthritis/rheumatism",
      sarthritis_dm ~ "Doctor-diagnosed/medication-indicated arthritis/rheumatism",
      shibpe ~ "Doctor-diagnosed hypertension",
      shibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      sdiabe ~ "Doctor-diagnosed diabetes",
      sdiabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      scancre ~ "Doctor-diagnosed cancer",
      scancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
      slunge ~ "Doctor-diagnosed lung disease",
      slunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
      shearte ~ "Doctor-diagnosed heart disease",
      shearte_dm ~ "Doctor-diagnosed/medication-indicated heart disease",
      sstroke ~ "Doctor-diagnosed stroke",
      sstroke_dm ~ "Doctor-diagnosed/medication-indicated stroke",
      spsyche ~ "Doctor-diagnosed psychiatric problems",
      spsyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
      slivere ~ "Doctor-diagnosed liver disease",
      slivere_dm ~ "Doctor-diagnosed/medication-indicated liver disease",
      scatracte_dm ~ "Treatment-indicated cataract")
  ) %>%
  add_p(
    test = list(
      all_categorical() ~ "chisq.test"),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 2. Wives' arthritis/rheumatism and other chronic diseases among male respondents**") %>%
  bold_labels() %>%
  italicize_levels()

#Female as respondents and male as spouses
hklosa_female_t2 <- hklosa_female %>% mutate(across(where(haven::is.labelled), as.factor)) %>% 
  select(arthritis,sarthritis, sarthritis_dm, shibpe, shibpe_dm, sdiabe, sdiabe_dm, scancre, scancre_dm, slunge, slunge_dm, shearte, shearte_dm, sstroke, sstroke_dm, spsyche, spsyche_dm, slivere, slivere_dm, scatracte_dm) %>%
  tbl_summary(
    by = arthritis,
    statistic = list(
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = list(all_categorical() ~ 1),
    missing = "ifany",
    missing_text = "Missing values",
    label = list(
      sarthritis ~ "Doctor-diagnosed arthritis/rheumatism",
      sarthritis_dm ~ "Doctor-diagnosed/medication-indicated arthritis/rheumatism",
      shibpe ~ "Doctor-diagnosed hypertension",
      shibpe_dm ~ "Doctor-diagnosed/medication-indicated hypertension",
      sdiabe ~ "Doctor-diagnosed diabetes",
      sdiabe_dm ~ "Doctor-diagnosed/medication-indicated diabetes",
      scancre ~ "Doctor-diagnosed cancer",
      scancre_dm ~ "Doctor-diagnosed/medication-indicated cancer",
      slunge ~ "Doctor-diagnosed lung disease",
      slunge_dm ~ "Doctor-diagnosed/medication-indicated lung disease",
      shearte ~ "Doctor-diagnosed heart disease",
      shearte_dm ~ "Doctor-diagnosed/medication-indicated heart disease",
      sstroke ~ "Doctor-diagnosed stroke",
      sstroke_dm ~ "Doctor-diagnosed/medication-indicated stroke",
      spsyche ~ "Doctor-diagnosed psychiatric problems",
      spsyche_dm ~ "Doctor-diagnosed/medication-indicated psychiatric problems",
      slivere ~ "Doctor-diagnosed liver disease",
      slivere_dm ~ "Doctor-diagnosed/medication-indicated liver disease",
      scatracte_dm ~ "Treatment-indicated cataract")
  ) %>%
  add_p(
    test = list(
      all_categorical() ~ "chisq.test"),
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  add_overall() %>%
  modify_caption("**Table 2. Husbands' arthritis/rheumatism and other chronic diseases among female respondents**") %>%
  bold_labels() %>%
  italicize_levels()
###################################################### 
#Save tables as excel
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Output/Descriptive data')
write_xlsx(
  list(
    "hcharls_male" = as.data.frame(hcharls_male_t2$table_body),
    "hcharls_female" = as.data.frame(hcharls_female_t2$table_body),
    "helsa_male" = as.data.frame(helsa_male_t2$table_body),
    "helsa_female" = as.data.frame(helsa_female_t2$table_body),
    "hshare_male" = as.data.frame(hshare_male_t2$table_body),
    "hshare_female" = as.data.frame(hshare_female_t2$table_body),
    "hmhas_male" = as.data.frame(hmhas_male_t2$table_body),
    "hmhas_female" = as.data.frame(hmhas_female_t2$table_body),
    "hklosa_male" = as.data.frame(hklosa_male_t2$table_body),
    "hklosa_female" = as.data.frame(hklosa_female_t2$table_body)
  ),
  path = "Table_spousal_diagnoses_respondent_all_datasets_251128.xlsx"
)
###################################################### 
#STATISTICAL ANALYSES
#1. Spousal aggregation of arthritis/rheumatism: Crude models
#2. Complete case_Spousal aggregation of arthritis/rheumatism: Adjusted models
#3. Spousal coaggregation of other chronic diseases in individuals with arthritis/rheumatism: Crude models
#4. Complete case_Spousal coaggregation of other chronic diseases in individuals with arthritis/rheumatism: Adjusted models (No causal effects)
#5. Complete case_Spousal coaggregation of other chronic diseases in individuals with arthritis/rheumatism: Adjusted models (Causal direction from other chronic disease to arthritis)
#6. Complete case_Spousal coaggregation of other chronic diseases in individuals with arthritis/rheumatism: Adjusted models (Causal direction from arthritis to other chronic disease)
###################################################### 
#1. Spousal aggregation of arthritis/rheumatism: Crude models
###################################################### 
#CHARLS
######################################################
#Load data
setwd("/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/CHARLS")
load("hcharls_all_sp11.rda")

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

##Crude logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
#Male respondents
hcharls_crude_arthre_male_t1 <- hcharls_male %>% select(arthritis, sarthritis) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      sarthritis ~ "Spousal arthritis/rheumatism"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 1. Familial aggregation of arthritis/rheumatism among male respondents**")

#Female respondents
hcharls_crude_arthre_female_t1 <- hcharls_female %>% select(arthritis, sarthritis) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      sarthritis ~ "Spousal arthritis/rheumatism"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 1. Familial aggregation of arthritis/rheumatism among female respondents**")
###################################################### 
#ELSA
######################################################
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/ELSA')
load("helsa_all_sp28.rda")

#Divide dataset by respondent gender
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

##Crude logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
#Male respondents
helsa_crude_arthre_male_t1 <- helsa_male %>% select(arthritis, sarthritis) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      sarthritis ~ "Spousal arthritis/rheumatism"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 1. Familial aggregation of arthritis/rheumatism among male respondents**")

#Female respondents
helsa_crude_arthre_female_t1 <- helsa_female %>% select(arthritis, sarthritis) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      sarthritis ~ "Spousal arthritis/rheumatism"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 1. Familial aggregation of arthritis/rheumatism among female respondents**")
###################################################### 
#SHARE
######################################################
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/SHARE')
load("hshare_all_sp26.rda")

#Divide dataset by respondent gender
hshare_male <- hshare_all_sp26 %>% filter(ragender==1)
hshare_female <- hshare_all_sp26 %>% filter(ragender==2)

##Crude logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
#Male respondents
hshare_crude_arthre_male_t1 <- hshare_male %>% select(arthritis, sarthritis) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      sarthritis ~ "Spousal arthritis/rheumatism"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 1. Familial aggregation of arthritis/rheumatism among male respondents**")

#Female respondents
hshare_crude_arthre_female_t1 <- hshare_female %>% select(arthritis, sarthritis) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      sarthritis ~ "Spousal arthritis/rheumatism"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 1. Familial aggregation of arthritis/rheumatism among female respondents**")
######################################################  
#MHAS 
######################################################
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/MHAS')
load("hmhas_all_sp23.rda")

#Divide dataset by respondent gender
hmhas_male <- hmhas_all_sp23 %>% filter(ragender==1)
hmhas_female <- hmhas_all_sp23 %>% filter(ragender==2)

##Crude logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
#Male respondents
hmhas_crude_arthre_male_t1 <- hmhas_male %>% select(arthritis, sarthritis) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      sarthritis ~ "Spousal arthritis/rheumatism"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 1. Familial aggregation of arthritis/rheumatism among male respondents**")

#Female respondents
hmhas_crude_arthre_female_t1 <- hmhas_female %>% select(arthritis, sarthritis) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      sarthritis ~ "Spousal arthritis/rheumatism"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 1. Familial aggregation of arthritis/rheumatism among female respondents**")
######################################################
#KLoSA
######################################################
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/KLoSA')
load("hklosa_all_sp22.rda")

#Divide dataset by respondent gender
hklosa_male <- hklosa_all_sp22 %>% filter(ragender==1)
hklosa_female <- hklosa_all_sp22 %>% filter(ragender==2)

##Crude logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
#Male respondents
hklosa_crude_arthre_male_t1 <- hklosa_male %>% select(arthritis, sarthritis) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      sarthritis ~ "Spousal arthritis/rheumatism"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 1. Familial aggregation of arthritis/rheumatism among male respondents**")

#Female respondents
hklosa_crude_arthre_female_t1 <- hklosa_female %>% select(arthritis, sarthritis) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      sarthritis ~ "Spousal arthritis/rheumatism"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 1. Familial aggregation of arthritis/rheumatism among female respondents**")
###################################################### 
#Save tables as excel
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Output/Statistical data')
write_xlsx(
  list(
    "hcharls_male" = as.data.frame(hcharls_crude_arthre_male_t1$table_body),
    "hcharls_female" = as.data.frame(hcharls_crude_arthre_female_t1$table_body),
    "helsa_male" = as.data.frame(helsa_crude_arthre_male_t1$table_body),
    "helsa_female" = as.data.frame(helsa_crude_arthre_female_t1$table_body),
    "hshare_male" = as.data.frame(hshare_crude_arthre_male_t1$table_body),
    "hshare_female" = as.data.frame(hshare_crude_arthre_female_t1$table_body),
    "hmhas_male" = as.data.frame(hmhas_crude_arthre_male_t1$table_body),
    "hmhas_female" = as.data.frame(hmhas_crude_arthre_female_t1$table_body),
    "hklosa_male" = as.data.frame(hklosa_crude_arthre_male_t1$table_body),
    "hklosa_female" = as.data.frame(hklosa_crude_arthre_female_t1$table_body)
  ),
  path = "Table_familial_aggregation_crude_arthre_all_datasets_251128.xlsx"
)
###################################################### 
#2. Complete case_Spousal aggregation of arthritis/rheumatism: Adjusted models
###################################################### 
#CHARLS
######################################################
#Load data
setwd("/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/CHARLS")
load("hcharls_all_sp11.rda")

#Define variables' classes
hcharls_all_sp11 <- hcharls_all_sp11 %>% mutate(
  raeducl=factor(raeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  seducl=factor(seducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  ramomeducl=factor(ramomeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  radadeducl=factor(radadeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  smomeducl=factor(smomeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  sdadeducl=factor(sdadeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  rmbmicat=factor(rmbmicat, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Overweight","Obesity")),
  smbmicat=factor(smbmicat, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Overweight","Obesity")))

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1 <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_male, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis + ramomeducl + radadeducl + rclstress2, data=hcharls_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis + schrondis + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sarthritis + rmbmicat + raeducl + as.factor(roccup3), data=hcharls_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sarthritis + rmbmicat + raeducl + as.factor(roccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_arthre_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1_f <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_female, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis + ramomeducl + radadeducl + rclstress2, data=hcharls_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis + schrondis + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sarthritis + rmbmicat + raeducl + as.factor(roccup3), data=hcharls_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sarthritis + rmbmicat + raeducl + as.factor(roccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_arthre_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 
######################################################
#ELSA
######################################################
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/ELSA')
load("helsa_all_sp28.rda")

#Recode missing values
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(rabplace=case_when(
  rabplace==-13 | rabplace==-4 ~ NA,
  TRUE ~ rabplace),
  sbplace=case_when(
    sbplace==-13 | sbplace==-4 ~ NA,
    TRUE ~ sbplace),
  raeducl=case_when(
    raeducl==-4 | raeducl==-13| raeducl==-15 | raeducl==-18 ~ NA,
    TRUE ~ raeducl),
  seducl=case_when(
    seducl==-4 | seducl==-13| seducl==-15 | seducl==-18 ~ NA,
    TRUE ~ seducl),
  rdrinke=case_when(
    rdrinke==-3 | rdrinke==-4 | rdrinke==-13 | rdrinke==-16 ~ NA,
    TRUE ~ rdrinke),
  sdrinke=case_when(
    sdrinke==-3 | sdrinke==-4 | sdrinke==-13 | sdrinke==-16 ~ NA,
    TRUE ~ sdrinke),
  rsmokev=case_when(
    rsmokev==-4 | rsmokev==-13 | rsmokev==-16 | rsmokev==-18 ~ NA,
    TRUE ~ rsmokev),
  ssmokev=case_when(
    ssmokev==-4 | ssmokev==-13 | ssmokev==-16 | ssmokev==-18 ~ NA,
    TRUE ~ ssmokev),
  rarelig_e=case_when(
    rarelig_e==-9 | rarelig_e==-13 | rarelig_e==-16 | rarelig_e==-18 | rarelig_e==-23 ~ NA,
    TRUE ~ rarelig_e),
  srelig=case_when(
    srelig==-9 | srelig==-13 | srelig==-16 | srelig==-18 | srelig==-23 ~ NA,
    TRUE ~ rarelig_e),
  rmbmicat=case_when(
    rmbmicat==-9 | rmbmicat==-14 | rmbmicat==-16 | rmbmicat==-19 | rmbmicat==-24 ~ NA,
    TRUE ~ rmbmicat),
  smbmicat=case_when(
    smbmicat==-9 | smbmicat==-14 | smbmicat==-16 | smbmicat==-19 | smbmicat==-24 ~ NA,
    TRUE ~ smbmicat),
  ramomeduage=case_when(
    ramomeduage==-1 | ramomeduage==-4 | ramomeduage==-18 ~ NA,
    TRUE ~ ramomeduage),
  radadeduage=case_when(
    radadeduage==-1 | radadeduage==-4 | radadeduage==-18 ~ NA,
    TRUE ~ radadeduage),
  smomeducl=case_when(
    smomeducl==-1 | smomeducl==-4 | smomeducl==-18 ~ NA,
    TRUE ~ smomeducl),
  sdadeducl=case_when(
    sdadeducl==-1 | sdadeducl==-4 | sdadeducl==-18 ~ NA,
    TRUE ~ sdadeducl),
  rarelig_e2=case_when(
    rarelig_e==1 ~ rarelig_e ,
    rarelig_e==8 ~ rarelig_e,
    is.na(rarelig_e) ~ rarelig_e,
      TRUE ~ 2),
  srelig2=case_when(
    srelig==1 ~ srelig ,
    srelig==8 ~ srelig,
    is.na(srelig) ~ srelig,
    TRUE ~ 2))

#Recode BMI and parental education
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rmbmicat2=case_when(
  as.numeric(rmbmicat) %in% c(1, 2, 3) ~ as.numeric(rmbmicat), 
  as.numeric(rmbmicat) %in% c(4, 5, 6) ~ 4, 
  TRUE ~ as.numeric(rmbmicat)),
  smbmicat2=case_when(
  as.numeric(smbmicat) %in% c(1, 2, 3) ~ as.numeric(smbmicat), 
  as.numeric(smbmicat) %in% c(4, 5, 6) ~ 4, 
  TRUE ~ as.numeric(smbmicat)),
  ramomeduage2=case_when(
    as.numeric(ramomeduage) %in% c(1, 2) ~ as.numeric(ramomeduage), 
    as.numeric(ramomeduage) %in% c(3, 4, 5, 6) ~ 3, 
    TRUE ~ as.numeric(ramomeduage)),
  radadeduage2=case_when(
    as.numeric(radadeduage) %in% c(1, 2) ~ as.numeric(radadeduage), 
    as.numeric(radadeduage) %in% c(3, 4, 5, 6) ~ 3, 
    TRUE ~ as.numeric(radadeduage)),
  smomeducl2=case_when(
    as.numeric(smomeducl) %in% c(1, 2) ~ as.numeric(smomeducl), 
    as.numeric(smomeducl) %in% c(3, 4, 5, 6) ~ 3, 
    TRUE ~ as.numeric(smomeducl)),
  sdadeducl2=case_when(
    as.numeric(sdadeducl) %in% c(1, 2) ~ as.numeric(sdadeducl), 
    as.numeric(sdadeducl) %in% c(3, 4, 5, 6) ~ 3, 
    TRUE ~ as.numeric(sdadeducl)))

#Define variables' classes
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rabplace=factor(rabplace, levels=c(1, 11), labels=c("UK","Outside UK")),
  sbplace=factor(sbplace, levels=c(1, 11), labels=c("UK","Outside UK")),
  raracem=factor(raracem, levels=c(1, 4), labels=c("White","Non-white")),
  srace=factor(srace, levels=c(1, 4), labels=c("White","Non-white")),
  raeducl=factor(raeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  seducl=factor(seducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  ramomeduage2=factor(ramomeduage2, levels=c(1, 2, 3), labels=c("Never went to school","Age 14 or under","At age 15 or over"), ordered = TRUE),
  radadeduage2=factor(radadeduage2, levels=c(1, 2, 3), labels=c("Never went to school","Age 14 or under","At age 15 or over"), ordered = TRUE),
  smomeducl2=factor(smomeducl2, levels=c(1, 2, 3), labels=c("Never went to school","Age 14 or under","At age 15 or over"), ordered = TRUE),
  sdadeducl2=factor(sdadeducl2, levels=c(1, 2, 3), labels=c("Never went to school","Age 14 or under","At age 15 or over"), ordered = TRUE),
  rmbmicat2=factor(rmbmicat2, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Pre-obesity","Obesity")),
  smbmicat2=factor(smbmicat2, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Pre-obesity","Obesity")),
  rarelig_e2=factor(rarelig_e2, levels = c(8, 1, 2), labels = c("None","Christian","Other")),
  srelig2=factor(srelig2, levels = c(8, 1, 2), labels = c("None","Christian","Other")))

#Divide dataset by respondent gender
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig2 as it is highly correlated with rarelig_e2, no estimate was computed for the variable
m1 <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis + schrondis + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sarthritis + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sarthritis + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_male, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_arthre_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                    `as.factor(spact)` ~ "Spousal physical activity",
                    `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                    ssmokev ~ "Spousal ever smoking",
                    schrondis ~ "Spousal any other chronic diseases",
                    sclstress ~ "Spousal childhood/lifetime stressful events",
                    skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig as it is highly correlated with rarelig_e, no estimate was computed for the variable
m1_f <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis + schrondis + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sarthritis + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sarthritis + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_female, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_arthre_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#SHARE
######################################################
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/SHARE')
load("hshare_all_sp26.rda")

#Recode rarelig_s, country of birth, and BMI
hshare_all_sp26 <- hshare_all_sp26 %>% mutate(
  rarelig_s2=case_when(
    rarelig_s==1 | rarelig_s==2 |rarelig_s==3 ~ 1, #Christian
    rarelig_s==4 | rarelig_s==5 |rarelig_s==6 ~ 2, #Other
    rarelig_s==7 ~ 8,
    TRUE ~ NA_real_),
  srelig2=case_when(
    srelig==1 | srelig==2 |srelig==3 ~ 1, #Christian
    srelig==4 | srelig==5 |srelig==6 ~ 2, #Other
    srelig==7 ~ 8,
    TRUE ~ NA_real_),
  rabplace3=case_when(
    rabplace2=="Europe" ~ rabplace2, 
    rabplace2=="Africa" | rabplace2=="Asia" |rabplace2=="North America" | rabplace2=="South America" | rabplace2=="Oceania" ~ "Outside Europe", 
    TRUE ~ rabplace2),
  sbplace2=case_when(
    sbplace=="Europe" ~ sbplace, 
    sbplace=="Africa" | sbplace=="Asia" |sbplace=="North America" | sbplace=="South America" | sbplace=="Oceania" ~ "Outside Europe", 
    TRUE ~ sbplace),
  rmbmicat2=case_when(
      as.numeric(rmbmicat) %in% c(1, 2, 3) ~ as.numeric(rmbmicat), 
      as.numeric(rmbmicat) %in% c(4, 5, 6) ~ 4, 
      TRUE ~ as.numeric(rmbmicat)),
  smbmicat2=case_when(
    as.numeric(smbmicat) %in% c(1, 2, 3) ~ as.numeric(smbmicat), 
    as.numeric(smbmicat) %in% c(4, 5, 6) ~ 4, 
    TRUE ~ as.numeric(smbmicat)))

#Define variables' classes
hshare_all_sp26 <- hshare_all_sp26 %>% mutate(
  raeducl=factor(raeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  seducl=factor(seducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  ramomeducl=factor(ramomeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  radadeducl=factor(radadeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  smomeducl=factor(smomeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  sdadeducl=factor(sdadeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  rmbmicat2=factor(rmbmicat2, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Pre-obesity","Obesity")),
  smbmicat2=factor(smbmicat2, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Pre-obesity","Obesity")),
  rarelig_s2=factor(rarelig_s2, levels = c(8, 1, 2), labels = c("None","Christian","Other")),
  srelig2=factor(srelig2, levels = c(8, 1, 2), labels = c("None","Christian","Other")))

#Divide dataset by respondent gender
hshare_male <- hshare_all_sp26 %>% filter(ragender==1)
hshare_female <- hshare_all_sp26 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1 <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis + ramomeducl + radadeducl + rclstress, data=hshare_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis + schrondis + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sarthritis + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sarthritis + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_arthre_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis + ramomeducl + radadeducl + rclstress, data=hshare_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sarthritis + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis + schrondis + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sarthritis + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sarthritis + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_arthre_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#MHAS
######################################################
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/MHAS')
load("hmhas_all_sp23.rda")

#Recode BMI
hmhas_all_sp23 <- hmhas_all_sp23 %>% mutate(
  rbmicat2=case_when(
    rbmicat==1 | rbmicat==2 | rbmicat==3 ~ rbmicat, #Christian
    rbmicat==4 | rbmicat==5 | rbmicat==6 ~ 4, #Buddhist
    TRUE ~ rbmicat),
  sbmicat2=case_when(
    sbmicat==1 | sbmicat==2 | sbmicat==3 ~ sbmicat, #Christian
    sbmicat==4 | sbmicat==5 | sbmicat==6 ~ 4, #Buddhist
    TRUE ~ sbmicat))

#Define variables' classes
hmhas_all_sp23 <- hmhas_all_sp23 %>% mutate(
  raeducl=factor(raeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  seducl=factor(seducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  rameduc_m=factor(rameduc_m, levels=c(1, 2, 3, 4), labels=c("No education","Some primary","Primary", "More than primary"), ordered = TRUE),
  rafeduc_m=factor(rafeduc_m, levels=c(1, 2, 3, 4), labels=c("No education","Some primary","Primary", "More than primary"), ordered = TRUE),
  smomeducl=factor(smomeducl, levels=c(1, 2, 3, 4), labels=c("No education","Some primary","Primary", "More than primary"), ordered = TRUE),
  sdadeducl=factor(sdadeducl, levels=c(1, 2, 3, 4), labels=c("No education","Some primary","Primary", "More than primary"), ordered = TRUE),
  rbmicat2=factor(rbmicat2, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Pre-obesity","Obesity")),
  sbmicat2=factor(sbmicat2, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Pre-obesity","Obesity")))

#Divide dataset by respondent gender
hmhas_male <- hmhas_all_sp23 %>% filter(ragender==1) 
hmhas_female <- hmhas_all_sp23 %>% filter(ragender==2) 

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation to account for assortative mating
m1 <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2), data=hmhas_male, family=binomial)
#Model 2: additionally adjusting for household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + rdrinkr + rsmokev + rchrondis + rameduc_m + rafeduc_m + rclstress, data=hmhas_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis + schrondis + rameduc_m + rafeduc_m + smomeducl + sdadeducl+ rclstress + sclstress, data=hmhas_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sarthritis + rbmicat2 + raeducl + as.factor(roccup2_2), data=hmhas_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sarthritis + rbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_male, family=binomial)

#Combine all models into one table
hmhas_adjusted_cc_arthre_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2), data=hmhas_female, family=binomial)
#Model 2: additionally adjusting for household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + rdrinkr + rsmokev + rchrondis + rameduc_m + rafeduc_m + rclstress, data=hmhas_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis + schrondis + rameduc_m + rafeduc_m + smomeducl + sdadeducl+ rclstress + sclstress, data=hmhas_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sarthritis + rbmicat2 + raeducl + as.factor(roccup2_2), data=hmhas_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sarthritis + rbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_female, family=binomial)

#Combine all models into one table
hmhas_adjusted_cc_arthre_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#KLoSA
######################################################
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/KLoSA')
load("hklosa_all_sp22.rda")

#Recode religion and BMI
hklosa_all_sp22 <- hklosa_all_sp22 %>% mutate(
  rrelig2=case_when(
  rrelig==1 | rrelig==2 ~ 1, #Christian
  rrelig==3 | rrelig==4 ~ 2, #Buddhist
  rrelig==5 ~ 3, #Other
  rrelig==6 ~ 8, #None
  TRUE ~ rrelig),
  srelig2=case_when(
    srelig==1 | srelig==2 ~ 1, #Christian
    srelig==3 | srelig==4 ~ 2, #Buddhist
    srelig==5 ~ 3, #Other
    srelig==6 ~ 8, #None
    TRUE ~ srelig),
  rbmicat2=case_when(
    rbmicat==1 | rbmicat==2 | rbmicat==3 ~ rbmicat, #Christian
    rbmicat==4 | rbmicat==5 | rbmicat==6 ~ 4, #Buddhist
    TRUE ~ rbmicat),
  sbmicat2=case_when(
    sbmicat==1 | sbmicat==2 | sbmicat==3 ~ sbmicat, #Christian
    sbmicat==4 | sbmicat==5 | sbmicat==6 ~ 4, #Buddhist
    TRUE ~ sbmicat))

select(pid, rage, rabyear, ragender, rrural, rrelig, ramomeducl, radadeducl, raeducl, rpactvg, rdrinkr, rsmokev, roccup, roccup2_2, roccup3_2, rheight,rweight,rbmin, hincome2, rkcnt, rsoc, arthre2, hibpe2, diabe2, cancre2, lunge2, hearte2, stroke2, psyche2, livere2, catrcte2, rshlt, radlfive, riadlza, arthritis,arthritis_dm, hibpe, hibpe_dm, diabe, diabe_dm, cancre, cancre_dm, lunge, lunge_dm, hearte, hearte_dm, stroke, stroke_dm, psyche, psyche_dm, livere, livere_dm, catracte_dm) %>% 
  
#Define variables' classes
hklosa_all_sp22 <- hklosa_all_sp22 %>% mutate(
    raeducl=factor(raeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary training","Tertiary"), ordered = TRUE),
    seducl=factor(seducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary training","Tertiary"), ordered = TRUE),
    ramomeducl=factor(ramomeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary training","Tertiary"), ordered = TRUE),
    radadeducl=factor(radadeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary training","Tertiary"), ordered = TRUE),
    smomeducl=factor(smomeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary training","Tertiary"), ordered = TRUE),
    sdadeducl=factor(sdadeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary training","Tertiary"), ordered = TRUE),
    rbmicat2=factor(rbmicat2, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Pre-obesity","Obesity")),
    sbmicat2=factor(sbmicat2, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Pre-obesity","Obesity")))

#Divide dataset by respondent gender
hklosa_male <- hklosa_all_sp22 %>% filter(ragender==1)
hklosa_female <- hklosa_all_sp22 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, and religion to account for assortative mating
m1 <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rrelig2) + as.factor(srelig2), data=hklosa_male, family=binomial)
#Model 2: additionally adjusting for household income, to account for measured spousal factors;
m2 <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rrelig2) + as.factor(srelig2) + hincome2 + rrural, data=hklosa_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rrelig2) + as.factor(srelig2) + hincome2 + rrural + rpactvg + rdrinkr + rsmokev + rchrondis + ramomeducl + radadeducl + rkcnt + rsoc, data=hklosa_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rrelig2) + as.factor(srelig2) + hincome2 + rrural + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis + schrondis + ramomeducl + smomeducl + radadeducl + sdadeducl + rkcnt + skcnt + rsoc + ssoc, data=hklosa_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sarthritis + rbmicat2 + raeducl + as.factor(roccup2_2), data=hklosa_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sarthritis + rbmicat2 + raeducl + as.factor(roccup2_2) + hincome2 + rrural, data=hklosa_male, family=binomial)

#Combine all models into one table
hklosa_adjusted_cc_arthre_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rrelig2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Spousal religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rrelig2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Spousal religion",
                     rrural ~ "Household living area",
                     hincome2 ~ "Household income (maximum)")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rrelig2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Spousal religion",
                     rrural ~ "Household living area",
                     hincome2 ~ "Household income (maximum)",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rkcnt ~ "Respondent's weekly contact with children",
                     rsoc ~ "Respondent's any weekly social activities")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rrelig2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Spousal religion",
                     rrural ~ "Household living area",
                     hincome2 ~ "Household income (maximum)",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rkcnt ~ "Respondent's weekly contact with children",
                     rsoc ~ "Respondent's any weekly social activities",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis ~ "Spousal any other chronic diseases",
                     skcnt ~ "Spousal weekly contact with children",
                     ssoc ~ "Spousal any weekly social activities")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     rrural ~ "Household living area",
                     hincome2 ~ "Household income (maximum)")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rrelig2) + as.factor(srelig2), data=hklosa_female, family=binomial)
#Model 2: additionally adjusting for household income, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rrelig2) + as.factor(srelig2) + hincome2 + rrural, data=hklosa_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rrelig2) + as.factor(srelig2) + hincome2 + rrural + rpactvg + rdrinkr + rsmokev + rchrondis + ramomeducl + radadeducl + rkcnt + rsoc, data=hklosa_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sarthritis + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rrelig2) + as.factor(srelig2) + hincome2 + rrural + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis + schrondis + ramomeducl + smomeducl + radadeducl + sdadeducl + rkcnt + skcnt + rsoc + ssoc, data=hklosa_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sarthritis + rbmicat2 + raeducl + as.factor(roccup2_2), data=hklosa_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sarthritis + rbmicat2 + raeducl + as.factor(roccup2_2) + hincome2 + rrural, data=hklosa_female, family=binomial)

#Combine all models into one table
hklosa_adjusted_cc_arthre_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rrelig2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Spousal religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rrelig2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Spousal religion",
                     rrural ~ "Household living area",
                     hincome2 ~ "Household income (maximum)")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rrelig2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Spousal religion",
                     rrural ~ "Household living area",
                     hincome2 ~ "Household income (maximum)",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rkcnt ~ "Respondent's weekly contact with children",
                     rsoc ~ "Respondent's any weekly social activities")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rrelig2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Spousal religion",
                     rrural ~ "Household living area",
                     hincome2 ~ "Household income (maximum)",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis ~ "Respondent's any other chronic diseases",
                     rkcnt ~ "Respondent's weekly contact with children",
                     rsoc ~ "Respondent's any weekly social activities",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis ~ "Spousal any other chronic diseases",
                     skcnt ~ "Spousal weekly contact with children",
                     ssoc ~ "Spousal any weekly social activities")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sarthritis ~ "Spousal arthritis/rheumatism",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     rrural ~ "Household living area",
                     hincome2 ~ "Household income (maximum)")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Save tables as excel
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Output/Statistical data')
write_xlsx(
  list(
    "hcharls_male" = as.data.frame(hcharls_adjusted_cc_arthre_male$table_body),
    "hcharls_female" = as.data.frame(hcharls_adjusted_cc_arthre_female$table_body),
    "helsa_male" = as.data.frame(helsa_adjusted_cc_arthre_male$table_body),
    "helsa_female" = as.data.frame(helsa_adjusted_cc_arthre_female$table_body),
    "hshare_male" = as.data.frame(hshare_adjusted_cc_arthre_male$table_body),
    "hshare_female" = as.data.frame(hshare_adjusted_cc_arthre_female$table_body),
    "hmhas_male" = as.data.frame(hmhas_adjusted_cc_arthre_male$table_body),
    "hmhas_female" = as.data.frame(hmhas_adjusted_cc_arthre_female$table_body),
    "hklosa_male" = as.data.frame(hklosa_adjusted_cc_arthre_male$table_body),
    "hklosa_female" = as.data.frame(hklosa_adjusted_cc_arthre_female$table_body)
  ),
  path = "Table_familial_aggregation_arthre_adjusted_cc_all_datasets_251202.xlsx"
)
###################################################### 
#3. Spousal coaggregation of other chronic diseases in individuals with arthritis/rheumatism: Crude models
###################################################### 
#CHARLS
######################################################
#Load data
setwd("/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/CHARLS")
load("hcharls_all_sp11.rda")

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

##Crude logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
#Male respondents
hcharls_crude_other_chron_male <- hcharls_male %>% select(arthritis, shibpe, sdiabe, scancre, slunge, shearte, sstroke, spsyche, sdyslipe, slivere,skidneye, sdigeste, sasthmae) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      shibpe ~ "Spousal hypertension",
      sdiabe ~ "Spousal diabetes",
      scancre ~ "Spousal cancer",
      slunge ~ "Spousal lung disease",
      shearte ~ "Spousal heart disease",
      sstroke ~ "Spousal stroke",
      spsyche ~ "Spousal psychiatric problems",
      sdyslipe ~ "Spousal dyslipidemia",
      slivere ~ "Spousal liver disease",
      skidneye ~ "Spousal kidney disease",
      sdigeste ~ "Spousal digestive disease",
      sasthmae ~ "Spousal asthmae"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 2. Familial coaggregation of other chronic diseases among male respondents**")

#Female respondents
hcharls_crude_other_chron_female <- hcharls_female %>% select(arthritis, shibpe, sdiabe, scancre, slunge, shearte, sstroke, spsyche, sdyslipe, slivere,skidneye, sdigeste, sasthmae) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      shibpe ~ "Spousal hypertension",
      sdiabe ~ "Spousal diabetes",
      scancre ~ "Spousal cancer",
      slunge ~ "Spousal lung disease",
      shearte ~ "Spousal heart disease",
      sstroke ~ "Spousal stroke",
      spsyche ~ "Spousal psychiatric problems",
      sdyslipe ~ "Spousal dyslipidemia",
      slivere ~ "Spousal liver disease",
      skidneye ~ "Spousal kidney disease",
      sdigeste ~ "Spousal digestive disease",
      sasthmae ~ "Spousal asthmae"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 2. Familial coaggregation of other chronic diseases among female respondents**")
###################################################### 
#ELSA
######################################################
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/ELSA')
load("helsa_all_sp28.rda")

#Divide dataset by respondent gender
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

##Crude logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
#Male respondents
helsa_crude_other_chron_male <- helsa_male %>% select(arthritis, shibpe, sdiabe, scancre, slunge, shearte, sstroke, spsyche, shchole, sasthmae, scatracte, sparkine, sosteoe) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      shibpe ~ "Spousal hypertension",
      sdiabe ~ "Spousal diabetes",
      scancre ~ "Spousal cancer",
      slunge ~ "Spousal lung disease",
      shearte ~ "Spousal heart disease",
      sstroke ~ "Spousal stroke",
      spsyche ~ "Spousal psychiatric problems",
      shchole ~ "Spousal high cholesterol",
      sasthmae ~ "Spousal asthmae",
      scatracte ~ "Spousal cataract",
      sparkine ~ "Spousal Parkinson's disease",
      sosteoe ~ "Spousal osteoporosis"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 2. Familial coaggregation of other chronic diseases among male respondents**")

#Female respondents
helsa_crude_other_chron_female <- helsa_female %>% select(arthritis, shibpe, sdiabe, scancre, slunge, shearte, sstroke, spsyche, shchole, sasthmae, scatracte, sparkine, sosteoe) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      shibpe ~ "Spousal hypertension",
      sdiabe ~ "Spousal diabetes",
      scancre ~ "Spousal cancer",
      slunge ~ "Spousal lung disease",
      shearte ~ "Spousal heart disease",
      sstroke ~ "Spousal stroke",
      spsyche ~ "Spousal psychiatric problems",
      shchole ~ "Spousal high cholesterol",
      sasthmae ~ "Spousal asthmae",
      scatracte ~ "Spousal cataract",
      sparkine ~ "Spousal Parkinson's disease",
      sosteoe ~ "Spousal osteoporosis"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 2. Familial coaggregation of other chronic diseases among female respondents**")
######################################################
#SHARE
######################################################
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/SHARE')
load("hshare_all_sp26.rda")

#Divide dataset by respondent gender
hshare_male <- hshare_all_sp26 %>% filter(ragender==1)
hshare_female <- hshare_all_sp26 %>% filter(ragender==2)

##Crude logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
#Male respondents
hshare_crude_other_chron_male <- hshare_male %>% select(arthritis, shibpe, sdiabe, scancre, slunge, shearte, sstroke, spsyche, shchole, scatracte, sparkine, sulcere) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      shibpe ~ "Spousal hypertension",
      sdiabe ~ "Spousal diabetes",
      scancre ~ "Spousal cancer",
      slunge ~ "Spousal lung disease",
      shearte ~ "Spousal heart disease",
      sstroke ~ "Spousal stroke",
      spsyche ~ "Spousal psychiatric problems",
      shchole ~ "Spousal high cholesterol",
      scatracte ~ "Spousal cataract",
      sparkine ~ "Spousal Parkinson's disease",
      sulcere ~ "Spousal ulcer"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 2. Familial coaggregation of other chronic diseases among male respondents**")

#Female respondents
hshare_crude_other_chron_female <- hshare_female %>% select(arthritis, shibpe, sdiabe, scancre, slunge, shearte, sstroke, spsyche, shchole, scatracte, sparkine, sulcere) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      shibpe ~ "Spousal hypertension",
      sdiabe ~ "Spousal diabetes",
      scancre ~ "Spousal cancer",
      slunge ~ "Spousal lung disease",
      shearte ~ "Spousal heart disease",
      sstroke ~ "Spousal stroke",
      spsyche ~ "Spousal psychiatric problems",
      shchole ~ "Spousal high cholesterol",
      scatracte ~ "Spousal cataract",
      sparkine ~ "Spousal Parkinson's disease",
      sulcere ~ "Spousal ulcer"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 2. Familial coaggregation of other chronic diseases among female respondents**")

######################################################
#MHAS
######################################################
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/MHAS')
load("hmhas_all_sp23.rda")

#Divide dataset by respondent gender
hmhas_male <- hmhas_all_sp23 %>% filter(ragender==1)
hmhas_female <- hmhas_all_sp23 %>% filter(ragender==2)

##Crude logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
#Male respondents
hmhas_crude_other_chron_male <- hmhas_male %>% select(arthritis, shibpe, sdiabe, scancre, srespe, shrtatte, sstroke) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      shibpe ~ "Spousal hypertension",
      sdiabe ~ "Spousal diabetes",
      scancre ~ "Spousal cancer",
      srespe ~ "Spousal respiratory disease",
      shrtatte ~ "Spousal heart attack",
      sstroke ~ "Spousal stroke"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 2. Familial coaggregation of other chronic diseases among male respondents**")

#Female respondents
hmhas_crude_other_chron_female <- hmhas_female %>% select(arthritis, shibpe, sdiabe, scancre, srespe, shrtatte, sstroke) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      shibpe ~ "Spousal hypertension",
      sdiabe ~ "Spousal diabetes",
      scancre ~ "Spousal cancer",
      srespe ~ "Spousal respiratory disease",
      shrtatte ~ "Spousal heart attack",
      sstroke ~ "Spousal stroke"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 2. Familial coaggregation of other chronic diseases among female respondents**")

######################################################
#KLOSA
######################################################
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/KLoSA')
load("hklosa_all_sp22.rda")

#Divide dataset by respondent gender
hklosa_male <- hklosa_all_sp22 %>% filter(ragender==1)
hklosa_female <- hklosa_all_sp22 %>% filter(ragender==2)

##Crude logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
#Male respondents
hklosa_crude_other_chron_male <- hklosa_male %>% select(arthritis, shibpe, sdiabe, scancre, slunge, shearte, sstroke, spsyche, slivere, scatracte_dm) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      shibpe ~ "Spousal hypertension",
      sdiabe ~ "Spousal diabetes",
      scancre ~ "Spousal cancer",
      slunge ~ "Spousal lung disease",
      shearte ~ "Spousal heart disease",
      sstroke ~ "Spousal stroke",
      spsyche ~ "Spousal psychiatric problems",
      slivere ~ "Spousal liver disease",
      scatracte_dm ~ "Spousal cataract"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 2. Familial coaggregation of other chronic diseases among male respondents**")

#Female respondents
hklosa_crude_other_chron_female <- hklosa_female %>% select(arthritis, shibpe, sdiabe, scancre, slunge, shearte, sstroke, spsyche, slivere, scatracte_dm) %>%
  tbl_uvregression(
    method = glm,
    method.args = list(family = binomial),
    y = arthritis,
    exponentiate = TRUE,
    label = list(
      shibpe ~ "Spousal hypertension",
      sdiabe ~ "Spousal diabetes",
      scancre ~ "Spousal cancer",
      slunge ~ "Spousal lung disease",
      shearte ~ "Spousal heart disease",
      sstroke ~ "Spousal stroke",
      spsyche ~ "Spousal psychiatric problems",
      slivere ~ "Spousal liver disease",
      scatracte_dm ~ "Spousal cataract"
    ),
    hide_n = TRUE
  ) %>%
  add_global_p() %>%
  modify_header(
    label ~ "**Predictor**",
    estimate ~ "**Crude OR**",
    p.value ~ "**P-value**"
  ) %>%
  modify_column_merge(
    pattern = "{estimate} ({conf.low}, {conf.high})"
  ) %>%
  modify_header(estimate = "**OR (95% CI)**") %>%
  modify_footnote(
    estimate ~ "Crude Odds Ratio with 95% Confidence Interval",
    p.value ~ "Wald test p-value"
  ) %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  modify_caption("**Table 2. Familial coaggregation of other chronic diseases among female respondents**")
######################################################
#Save tables as excel
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Output/Statistical data')
write_xlsx(
  list(
    "hcharls_male" = as.data.frame(hcharls_crude_other_chron_male$table_body),
    "hcharls_female" = as.data.frame(hcharls_crude_other_chron_female$table_body),
    "helsa_male" = as.data.frame(helsa_crude_other_chron_male$table_body),
    "helsa_female" = as.data.frame(helsa_crude_other_chron_female$table_body),
    "hshare_male" = as.data.frame(hshare_crude_other_chron_male$table_body),
    "hshare_female" = as.data.frame(hshare_crude_other_chron_female$table_body),
    "hmhas_male" = as.data.frame(hmhas_crude_other_chron_male$table_body),
    "hmhas_female" = as.data.frame(hmhas_crude_other_chron_female$table_body),
    "hklosa_male" = as.data.frame(hklosa_crude_other_chron_male$table_body),
    "hklosa_female" = as.data.frame(hklosa_crude_other_chron_female$table_body)
  ),
  path = "Table_familial_coaggregation_crude_other_chron_all_datasets_251128.xlsx"
)
###################################################### 
#4. Complete case_Spousal coaggregation of other chronic diseases in individuals with arthritis/rheumatism: Adjusted models (No causal effects)
###################################################### 
##CHARLS
######################################################
#Load data
setwd("/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/CHARLS")
load("hcharls_all_sp11.rda")

#Define variables' classes
hcharls_all_sp11 <- hcharls_all_sp11 %>% mutate(
  raeducl=factor(raeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  seducl=factor(seducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  ramomeducl=factor(ramomeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  radadeducl=factor(radadeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  smomeducl=factor(smomeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  sdadeducl=factor(sdadeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  rmbmicat=factor(rmbmicat, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Overweight","Obesity")),
  smbmicat=factor(smbmicat, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Overweight","Obesity")))
######################################################
#CHARLS_Hypertension
######################################################
#Recode rchrondis excluding hypertension
hcharls_all_sp11 <- hcharls_all_sp11 %>% mutate(
  rchrondis_exhibpe = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1dyslipe, r1livere, r1kidneye, r1digeste, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1dyslipe, r1livere, r1kidneye, r1digeste, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2dyslipe, r2livere, r2kidneye, r2digeste, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2dyslipe, r2livere, r2kidneye, r2digeste, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3dyslipe, r3livere, r3kidneye, r3digeste, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3dyslipe, r3livere, r3kidneye, r3digeste, r3asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
hcharls_all_sp11 <- hcharls_all_sp11 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exhibpe = ifelse(person_num == 1, rchrondis_exhibpe[2], rchrondis_exhibpe[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1 <- glm(arthritis ~ shibpe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_male, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ shibpe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ shibpe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exhibpe + ramomeducl + radadeducl + rclstress2, data=hcharls_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ shibpe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exhibpe + schrondis_exhibpe + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ shibpe + rmbmicat + raeducl, data=hcharls_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ shibpe + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_hibpe_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhibpe ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1_f <- glm(arthritis ~ shibpe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_female, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ shibpe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ shibpe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exhibpe + ramomeducl + radadeducl + rclstress2, data=hcharls_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ shibpe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exhibpe + schrondis_exhibpe + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ shibpe + rmbmicat + raeducl, data=hcharls_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ shibpe + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_hibpe_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhibpe ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 
###################################################### 
#CHARLS_Diabetes
######################################################
#Recode rchrondis excluding diabetes
hcharls_all_sp11 <- hcharls_all_sp11 %>% mutate(
  rchrondis_exdiabe = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1dyslipe, r1livere, r1kidneye, r1digeste, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1dyslipe, r1livere, r1kidneye, r1digeste, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2dyslipe, r2livere, r2kidneye, r2digeste, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2dyslipe, r2livere, r2kidneye, r2digeste, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3dyslipe, r3livere, r3kidneye, r3digeste, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3dyslipe, r3livere, r3kidneye, r3digeste, r3asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
hcharls_all_sp11 <- hcharls_all_sp11 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exdiabe = ifelse(person_num == 1, rchrondis_exdiabe[2], rchrondis_exdiabe[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1 <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_male, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exdiabe + ramomeducl + radadeducl + rclstress2, data=hcharls_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exdiabe + schrondis_exdiabe + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sdiabe + rmbmicat + raeducl, data=hcharls_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sdiabe + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_diabe_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exdiabe~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1_f <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_female, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exdiabe + ramomeducl + radadeducl + rclstress2, data=hcharls_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exdiabe + schrondis_exdiabe + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sdiabe + rmbmicat + raeducl, data=hcharls_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sdiabe + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_diabe_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exdiabe~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 
######################################################
#CHARLS_Cancer
######################################################
#Recode rchrondis excluding cancer
hcharls_all_sp11 <- hcharls_all_sp11 %>% mutate(
  rchrondis_excancre = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1lunge, r1hearte, r1stroke, r1psyche, r1dyslipe, r1livere, r1kidneye, r1digeste, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1lunge, r1hearte, r1stroke, r1psyche, r1dyslipe, r1livere, r1kidneye, r1digeste, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2lunge, r2hearte, r2stroke, r2psyche, r2dyslipe, r2livere, r2kidneye, r2digeste, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2lunge, r2hearte, r2stroke, r2psyche, r2dyslipe, r2livere, r2kidneye, r2digeste, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3lunge, r3hearte, r3stroke, r3psyche, r3dyslipe, r3livere, r3kidneye, r3digeste, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3lunge, r3hearte, r3stroke, r3psyche, r3dyslipe, r3livere, r3kidneye, r3digeste, r3asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
hcharls_all_sp11 <- hcharls_all_sp11 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_excancre = ifelse(person_num == 1, rchrondis_excancre[2], rchrondis_excancre[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1 <- glm(arthritis ~ scancre + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_male, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ scancre + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ scancre + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_excancre + ramomeducl + radadeducl + rclstress2, data=hcharls_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ scancre + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_excancre + schrondis_excancre + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ scancre + rmbmicat + raeducl, data=hcharls_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ scancre + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_cancre_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_excancre~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1_f <- glm(arthritis ~ scancre + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_female, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ scancre + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ scancre + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_excancre + ramomeducl + radadeducl + rclstress2, data=hcharls_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ scancre + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_excancre + schrondis_excancre + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ scancre + rmbmicat + raeducl, data=hcharls_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ scancre + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_cancre_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_excancre~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 
######################################################
#CHARLS_Lung disease
######################################################
#Recode rchrondis excluding lung disease
hcharls_all_sp11 <- hcharls_all_sp11 %>% mutate(
  rchrondis_exlunge = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1hearte, r1stroke, r1psyche, r1dyslipe, r1livere, r1kidneye, r1digeste, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1hearte, r1stroke, r1psyche, r1dyslipe, r1livere, r1kidneye, r1digeste, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2hearte, r2stroke, r2psyche, r2dyslipe, r2livere, r2kidneye, r2digeste, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2hearte, r2stroke, r2psyche, r2dyslipe, r2livere, r2kidneye, r2digeste, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3hearte, r3stroke, r3psyche, r3dyslipe, r3livere, r3kidneye, r3digeste, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3hearte, r3stroke, r3psyche, r3dyslipe, r3livere, r3kidneye, r3digeste, r3asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
hcharls_all_sp11 <- hcharls_all_sp11 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exlunge = ifelse(person_num == 1, rchrondis_exlunge[2], rchrondis_exlunge[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1 <- glm(arthritis ~ slunge + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_male, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ slunge + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ slunge + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exlunge + ramomeducl + radadeducl + rclstress2, data=hcharls_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ slunge + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exlunge + schrondis_exlunge + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ slunge + rmbmicat + raeducl, data=hcharls_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ slunge + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_lunge_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlunge ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlunge ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exlunge~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1_f <- glm(arthritis ~ slunge + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_female, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ slunge + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ slunge + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exlunge + ramomeducl + radadeducl + rclstress2, data=hcharls_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ slunge + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exlunge + schrondis_exlunge + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ slunge + rmbmicat + raeducl, data=hcharls_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ slunge + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_lunge_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlunge ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlunge ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exlunge~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 
######################################################
#CHARLS_Heart disease
######################################################
#Recode rchrondis excluding heart disease
hcharls_all_sp11 <- hcharls_all_sp11 %>% mutate(
  rchrondis_exhearte = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1stroke, r1psyche, r1dyslipe, r1livere, r1kidneye, r1digeste, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1stroke, r1psyche, r1dyslipe, r1livere, r1kidneye, r1digeste, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2stroke, r2psyche, r2dyslipe, r2livere, r2kidneye, r2digeste, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2stroke, r2psyche, r2dyslipe, r2livere, r2kidneye, r2digeste, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3stroke, r3psyche, r3dyslipe, r3livere, r3kidneye, r3digeste, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3stroke, r3psyche, r3dyslipe, r3livere, r3kidneye, r3digeste, r3asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
hcharls_all_sp11 <- hcharls_all_sp11 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exhearte = ifelse(person_num == 1, rchrondis_exhearte[2], rchrondis_exhearte[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1 <- glm(arthritis ~ shearte + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_male, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ shearte + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ shearte + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exhearte + ramomeducl + radadeducl + rclstress2, data=hcharls_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ shearte + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exhearte + schrondis_exhearte + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ shearte + rmbmicat + raeducl, data=hcharls_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ shearte + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_hearte_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhearte ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhearte ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhearte~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1_f <- glm(arthritis ~ shearte + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_female, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ shearte + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ shearte + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exhearte + ramomeducl + radadeducl + rclstress2, data=hcharls_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ shearte + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exhearte + schrondis_exhearte + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ shearte + rmbmicat + raeducl, data=hcharls_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ shearte + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_hearte_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhearte ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhearte ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhearte~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 
######################################################
#CHARLS_Stroke
######################################################
#Recode rchrondis excluding stroke
hcharls_all_sp11 <- hcharls_all_sp11 %>% mutate(
  rchrondis_exstroke = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1psyche, r1dyslipe, r1livere, r1kidneye, r1digeste, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1psyche, r1dyslipe, r1livere, r1kidneye, r1digeste, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2psyche, r2dyslipe, r2livere, r2kidneye, r2digeste, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2psyche, r2dyslipe, r2livere, r2kidneye, r2digeste, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3psyche, r3dyslipe, r3livere, r3kidneye, r3digeste, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3psyche, r3dyslipe, r3livere, r3kidneye, r3digeste, r3asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
hcharls_all_sp11 <- hcharls_all_sp11 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exstroke = ifelse(person_num == 1, rchrondis_exstroke[2], rchrondis_exstroke[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1 <- glm(arthritis ~ sstroke + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_male, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sstroke + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sstroke + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exstroke + ramomeducl + radadeducl + rclstress2, data=hcharls_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sstroke + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exstroke + schrondis_exstroke + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sstroke + rmbmicat + raeducl, data=hcharls_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sstroke + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_stroke_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exstroke ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1_f <- glm(arthritis ~ sstroke + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_female, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sstroke + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sstroke + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exstroke + ramomeducl + radadeducl + rclstress2, data=hcharls_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sstroke + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exstroke + schrondis_exstroke + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sstroke + rmbmicat + raeducl, data=hcharls_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sstroke + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_stroke_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exstroke ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 
######################################################
#CHARLS_Psychiatric problems
######################################################
#Recode rchrondis excluding psychiatric problems
hcharls_all_sp11 <- hcharls_all_sp11 %>% mutate(
  rchrondis_expsyche = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1dyslipe, r1livere, r1kidneye, r1digeste, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1dyslipe, r1livere, r1kidneye, r1digeste, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2dyslipe, r2livere, r2kidneye, r2digeste, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2dyslipe, r2livere, r2kidneye, r2digeste, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3dyslipe, r3livere, r3kidneye, r3digeste, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3dyslipe, r3livere, r3kidneye, r3digeste, r3asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
hcharls_all_sp11 <- hcharls_all_sp11 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_expsyche = ifelse(person_num == 1, rchrondis_expsyche[2], rchrondis_expsyche[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1 <- glm(arthritis ~ spsyche + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_male, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ spsyche + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ spsyche + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_expsyche + ramomeducl + radadeducl + rclstress2, data=hcharls_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ spsyche + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_expsyche + schrondis_expsyche + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ spsyche + rmbmicat + raeducl, data=hcharls_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ spsyche + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_psyche_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_expsyche ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_expsyche ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_expsyche ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1_f <- glm(arthritis ~ spsyche + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_female, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ spsyche + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ spsyche + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_expsyche + ramomeducl + radadeducl + rclstress2, data=hcharls_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ spsyche + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_expsyche + schrondis_expsyche + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ spsyche + rmbmicat + raeducl, data=hcharls_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ spsyche + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_psyche_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_expsyche ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_expsyche ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_expsyche ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 
######################################################
#CHARLS_Dyslipidemia
######################################################
#Recode rchrondis excluding dyslipidemia
hcharls_all_sp11 <- hcharls_all_sp11 %>% mutate(
  rchrondis_exdyslipe = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1livere, r1kidneye, r1digeste, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1livere, r1kidneye, r1digeste, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2livere, r2kidneye, r2digeste, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2livere, r2kidneye, r2digeste, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3livere, r3kidneye, r3digeste, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3livere, r3kidneye, r3digeste, r3asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
hcharls_all_sp11 <- hcharls_all_sp11 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exdyslipe = ifelse(person_num == 1, rchrondis_exdyslipe[2], rchrondis_exdyslipe[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1 <- glm(arthritis ~ sdyslipe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_male, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sdyslipe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sdyslipe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exdyslipe + ramomeducl + radadeducl + rclstress2, data=hcharls_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sdyslipe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exdyslipe + schrondis_exdyslipe + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sdyslipe + rmbmicat + raeducl, data=hcharls_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sdyslipe + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_dyslipe_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sdyslipe ~ "Spousal dyslipidemia",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sdyslipe ~ "Spousal dyslipidemia",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sdyslipe ~ "Spousal dyslipidemia",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdyslipe ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sdyslipe ~ "Spousal dyslipidemia",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdyslipe ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exdyslipe ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sdyslipe ~ "Spousal dyslipidemia",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sdyslipe ~ "Spousal dyslipidemia",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1_f <- glm(arthritis ~ sdyslipe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_female, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sdyslipe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sdyslipe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exdyslipe + ramomeducl + radadeducl + rclstress2, data=hcharls_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sdyslipe + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exdyslipe + schrondis_exdyslipe + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sdyslipe + rmbmicat + raeducl, data=hcharls_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sdyslipe + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_dyslipe_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sdyslipe ~ "Spousal dyslipidemia",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sdyslipe ~ "Spousal dyslipidemia",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sdyslipe ~ "Spousal dyslipidemia",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdyslipe ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sdyslipe ~ "Spousal dyslipidemia",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdyslipe ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exdyslipe ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sdyslipe ~ "Spousal dyslipidemia",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sdyslipe ~ "Spousal dyslipidemia",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 
######################################################
#CHARLS_Liver disease
######################################################
#Recode rchrondis excluding dyslipidemia
hcharls_all_sp11 <- hcharls_all_sp11 %>% mutate(
  rchrondis_exlivere = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1dyslipe, r1kidneye, r1digeste, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1dyslipe, r1kidneye, r1digeste, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2dyslipe, r2kidneye, r2digeste, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2dyslipe, r2kidneye, r2digeste, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3dyslipe, r3kidneye, r3digeste, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3dyslipe, r3kidneye, r3digeste, r3asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
hcharls_all_sp11 <- hcharls_all_sp11 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exlivere = ifelse(person_num == 1, rchrondis_exlivere[2], rchrondis_exlivere[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1 <- glm(arthritis ~ slivere + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_male, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ slivere + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ slivere + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exlivere + ramomeducl + radadeducl + rclstress2, data=hcharls_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ slivere + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exlivere + schrondis_exlivere + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ slivere + rmbmicat + raeducl, data=hcharls_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ slivere + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_livere_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     slivere ~ "Spousal liver disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     slivere ~ "Spousal liver disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     slivere ~ "Spousal liver disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlivere ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     slivere ~ "Spousal liver disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlivere ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exlivere ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     slivere ~ "Spousal liver disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     slivere ~ "Spousal liver disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1_f <- glm(arthritis ~ slivere + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_female, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ slivere + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ slivere + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exlivere + ramomeducl + radadeducl + rclstress2, data=hcharls_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ slivere + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exlivere + schrondis_exlivere + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ slivere + rmbmicat + raeducl, data=hcharls_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ slivere + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_livere_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     slivere ~ "Spousal liver disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     slivere ~ "Spousal liver disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     slivere ~ "Spousal liver disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlivere ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     slivere ~ "Spousal liver disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlivere ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exlivere ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     slivere ~ "Spousal liver disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     slivere ~ "Spousal liver disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 
######################################################
#CHARLS_Kidney disease
######################################################
#Recode rchrondis excluding kidney disease
hcharls_all_sp11 <- hcharls_all_sp11 %>% mutate(
  rchrondis_exkidneye = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1dyslipe, r1livere, r1digeste, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1dyslipe, r1livere, r1digeste, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2dyslipe, r2livere, r2digeste, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2dyslipe, r2livere, r2digeste, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3dyslipe, r3livere, r3digeste, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3dyslipe, r3livere, r3digeste, r3asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
hcharls_all_sp11 <- hcharls_all_sp11 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exkidneye = ifelse(person_num == 1, rchrondis_exkidneye[2], rchrondis_exkidneye[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1 <- glm(arthritis ~ skidneye + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_male, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ skidneye + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ skidneye + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exkidneye + ramomeducl + radadeducl + rclstress2, data=hcharls_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ skidneye + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exkidneye + schrondis_exkidneye + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ skidneye + rmbmicat + raeducl, data=hcharls_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ skidneye + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_kidneye_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     skidneye ~ "Spousal kidney disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     skidneye ~ "Spousal kidney disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     skidneye ~ "Spousal kidney disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exkidneye ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     skidneye ~ "Spousal kidney disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exkidneye ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exkidneye ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     skidneye ~ "Spousal kidney disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     skidneye ~ "Spousal kidney disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1_f <- glm(arthritis ~ skidneye + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_female, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ skidneye + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ skidneye + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exkidneye + ramomeducl + radadeducl + rclstress2, data=hcharls_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ skidneye + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exkidneye + schrondis_exkidneye + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ skidneye + rmbmicat + raeducl, data=hcharls_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ skidneye + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_kidneye_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     skidneye ~ "Spousal kidney disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     skidneye ~ "Spousal kidney disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     skidneye ~ "Spousal kidney disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exkidneye ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     skidneye ~ "Spousal kidney disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exkidneye ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exkidneye ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     skidneye ~ "Spousal kidney disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     skidneye ~ "Spousal kidney disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 
######################################################
#CHARLS_Digestive disease
######################################################
#Recode rchrondis excluding digestive disease
hcharls_all_sp11 <- hcharls_all_sp11 %>% mutate(
  rchrondis_exdigeste = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1dyslipe, r1livere, r1kidneye, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1dyslipe, r1livere, r1kidneye, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2dyslipe, r2livere, r2kidneye, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2dyslipe, r2livere, r2kidneye, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3dyslipe, r3livere, r3kidneye, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3dyslipe, r3livere, r3kidneye, r3asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
hcharls_all_sp11 <- hcharls_all_sp11 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exdigeste = ifelse(person_num == 1, rchrondis_exdigeste[2], rchrondis_exdigeste[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1 <- glm(arthritis ~ sdigeste + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_male, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sdigeste + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sdigeste + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exdigeste + ramomeducl + radadeducl + rclstress2, data=hcharls_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sdigeste + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exdigeste + schrondis_exdigeste + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sdigeste + rmbmicat + raeducl, data=hcharls_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sdigeste + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_digeste_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sdigeste ~ "Spousal digestive disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sdigeste ~ "Spousal digestive disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sdigeste ~ "Spousal digestive disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdigeste ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sdigeste ~ "Spousal digestive disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdigeste ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exdigeste ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sdigeste ~ "Spousal digestive disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sdigeste ~ "Spousal digestive disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1_f <- glm(arthritis ~ sdigeste + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_female, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sdigeste + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sdigeste + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exdigeste + ramomeducl + radadeducl + rclstress2, data=hcharls_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sdigeste + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exdigeste + schrondis_exdigeste + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sdigeste + rmbmicat + raeducl, data=hcharls_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sdigeste + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_digeste_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sdigeste ~ "Spousal digestive disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sdigeste ~ "Spousal digestive disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sdigeste ~ "Spousal digestive disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdigeste ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sdigeste ~ "Spousal digestive disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdigeste ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exdigeste ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sdigeste ~ "Spousal digestive disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sdigeste ~ "Spousal digestive disease",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 
######################################################
#CHARLS_Asthmae
######################################################
#Recode rchrondis excluding asthmae
hcharls_all_sp11 <- hcharls_all_sp11 %>% mutate(
  rchrondis_exasthmae = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1dyslipe, r1livere, r1kidneye, r1digeste), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1dyslipe, r1livere, r1kidneye, r1digeste),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2dyslipe, r2livere, r2kidneye, r2digeste), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2dyslipe, r2livere, r2kidneye, r2digeste),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3dyslipe, r3livere, r3kidneye, r3digeste), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3dyslipe, r3livere, r3kidneye, r3digeste),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
hcharls_all_sp11 <- hcharls_all_sp11 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exasthmae = ifelse(person_num == 1, rchrondis_exasthmae[2], rchrondis_exasthmae[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hcharls_male <- hcharls_all_sp11 %>% filter(ragender==1)
hcharls_female <- hcharls_all_sp11 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1 <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_male, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exasthmae + ramomeducl + radadeducl + rclstress2, data=hcharls_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exasthmae + schrondis_exasthmae + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sasthmae + rmbmicat + raeducl, data=hcharls_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sasthmae + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_male, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_asthmae_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exasthmae ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exasthmae ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exasthmae ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, and occupation to account for assortative mating
m1_f <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3), data=hcharls_female, family=binomial)
#Model 2: additionally adjusting for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exasthmae + ramomeducl + radadeducl + rclstress2, data=hcharls_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat + smbmicat + raeducl + seducl + as.factor(roccup3) + as.factor(soccup3) + hrural + rmcurln + hincome + hkcnt + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exasthmae + schrondis_exasthmae + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress2 + sclstress2, data=hcharls_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sasthmae + rmbmicat + raeducl, data=hcharls_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sasthmae + rmbmicat + raeducl + hrural + rmcurln + hincome + hkcnt, data=hcharls_female, family=binomial)

#Combine all models into one table
hcharls_adjusted_cc_nocausal_asthmae_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exasthmae ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat ~ "Respondent's measured BMI",
                     smbmicat ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup3)` ~ "Respondent's occupation",
                     `as.factor(soccup3)` ~ "Spousal occupation",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exasthmae ~ "Respondent's any other chronic diseases",
                     rclstress2 ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exasthmae ~ "Spousal any other chronic diseases",
                     sclstress2 ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rmbmicat ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     hrural ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**" )) 
######################################################
#ELSA
#m4 with issue of prefect separation on ramomeduage among female respondents
######################################################
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/ELSA')
load("helsa_all_sp28.rda")

#Recode missing values
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(rabplace=case_when(
  rabplace==-13 | rabplace==-4 ~ NA,
  TRUE ~ rabplace),
  sbplace=case_when(
    sbplace==-13 | sbplace==-4 ~ NA,
    TRUE ~ sbplace),
  raeducl=case_when(
    raeducl==-4 | raeducl==-13| raeducl==-15 | raeducl==-18 ~ NA,
    TRUE ~ raeducl),
  seducl=case_when(
    seducl==-4 | seducl==-13| seducl==-15 | seducl==-18 ~ NA,
    TRUE ~ seducl),
  rdrinke=case_when(
    rdrinke==-3 | rdrinke==-4 | rdrinke==-13 | rdrinke==-16 ~ NA,
    TRUE ~ rdrinke),
  sdrinke=case_when(
    sdrinke==-3 | sdrinke==-4 | sdrinke==-13 | sdrinke==-16 ~ NA,
    TRUE ~ sdrinke),
  rsmokev=case_when(
    rsmokev==-4 | rsmokev==-13 | rsmokev==-16 | rsmokev==-18 ~ NA,
    TRUE ~ rsmokev),
  ssmokev=case_when(
    ssmokev==-4 | ssmokev==-13 | ssmokev==-16 | ssmokev==-18 ~ NA,
    TRUE ~ ssmokev),
  rarelig_e=case_when(
    rarelig_e==-9 | rarelig_e==-13 | rarelig_e==-16 | rarelig_e==-18 | rarelig_e==-23 ~ NA,
    TRUE ~ rarelig_e),
  srelig=case_when(
    srelig==-9 | srelig==-13 | srelig==-16 | srelig==-18 | srelig==-23 ~ NA,
    TRUE ~ rarelig_e),
  rmbmicat=case_when(
    rmbmicat==-9 | rmbmicat==-14 | rmbmicat==-16 | rmbmicat==-19 | rmbmicat==-24 ~ NA,
    TRUE ~ rmbmicat),
  smbmicat=case_when(
    smbmicat==-9 | smbmicat==-14 | smbmicat==-16 | smbmicat==-19 | smbmicat==-24 ~ NA,
    TRUE ~ smbmicat),
  ramomeduage=case_when(
    ramomeduage==-1 | ramomeduage==-4 | ramomeduage==-18 ~ NA,
    TRUE ~ ramomeduage),
  radadeduage=case_when(
    radadeduage==-1 | radadeduage==-4 | radadeduage==-18 ~ NA,
    TRUE ~ radadeduage),
  smomeducl=case_when(
    smomeducl==-1 | smomeducl==-4 | smomeducl==-18 ~ NA,
    TRUE ~ smomeducl),
  sdadeducl=case_when(
    sdadeducl==-1 | sdadeducl==-4 | sdadeducl==-18 ~ NA,
    TRUE ~ sdadeducl),
  rarelig_e2=case_when(
    rarelig_e==1 ~ rarelig_e ,
    rarelig_e==8 ~ rarelig_e,
    is.na(rarelig_e) ~ rarelig_e,
    TRUE ~ 2),
  srelig2=case_when(
    srelig==1 ~ srelig ,
    srelig==8 ~ srelig,
    is.na(srelig) ~ srelig,
    TRUE ~ 2))

#Recode BMI and parental education
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rmbmicat2=case_when(
    as.numeric(rmbmicat) %in% c(1, 2, 3) ~ as.numeric(rmbmicat), 
    as.numeric(rmbmicat) %in% c(4, 5, 6) ~ 4, 
    TRUE ~ as.numeric(rmbmicat)),
  smbmicat2=case_when(
    as.numeric(smbmicat) %in% c(1, 2, 3) ~ as.numeric(smbmicat), 
    as.numeric(smbmicat) %in% c(4, 5, 6) ~ 4, 
    TRUE ~ as.numeric(smbmicat)),
  ramomeduage2=case_when(
    as.numeric(ramomeduage) %in% c(1, 2) ~ as.numeric(ramomeduage), 
    as.numeric(ramomeduage) %in% c(3, 4, 5, 6) ~ 3, 
    TRUE ~ as.numeric(ramomeduage)),
  radadeduage2=case_when(
    as.numeric(radadeduage) %in% c(1, 2) ~ as.numeric(radadeduage), 
    as.numeric(radadeduage) %in% c(3, 4, 5, 6) ~ 3, 
    TRUE ~ as.numeric(radadeduage)),
  smomeducl2=case_when(
    as.numeric(smomeducl) %in% c(1, 2) ~ as.numeric(smomeducl), 
    as.numeric(smomeducl) %in% c(3, 4, 5, 6) ~ 3, 
    TRUE ~ as.numeric(smomeducl)),
  sdadeducl2=case_when(
    as.numeric(sdadeducl) %in% c(1, 2) ~ as.numeric(sdadeducl), 
    as.numeric(sdadeducl) %in% c(3, 4, 5, 6) ~ 3, 
    TRUE ~ as.numeric(sdadeducl)))

#Define variables' classes
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rabplace=factor(rabplace, levels=c(1, 11), labels=c("UK","Outside UK")),
  sbplace=factor(sbplace, levels=c(1, 11), labels=c("UK","Outside UK")),
  raracem=factor(raracem, levels=c(1, 4), labels=c("White","Non-white")),
  srace=factor(srace, levels=c(1, 4), labels=c("White","Non-white")),
  raeducl=factor(raeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  seducl=factor(seducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  ramomeduage2=factor(ramomeduage2, levels=c(1, 2, 3), labels=c("Never went to school","Age 14 or under","At age 15 or over"), ordered = TRUE),
  radadeduage2=factor(radadeduage2, levels=c(1, 2, 3), labels=c("Never went to school","Age 14 or under","At age 15 or over"), ordered = TRUE),
  smomeducl2=factor(smomeducl2, levels=c(1, 2, 3), labels=c("Never went to school","Age 14 or under","At age 15 or over"), ordered = TRUE),
  sdadeducl2=factor(sdadeducl2, levels=c(1, 2, 3), labels=c("Never went to school","Age 14 or under","At age 15 or over"), ordered = TRUE),
  rmbmicat2=factor(rmbmicat2, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Pre-obesity","Obesity")),
  smbmicat2=factor(smbmicat2, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Pre-obesity","Obesity")),
  rarelig_e2=factor(rarelig_e2, levels = c(8, 1, 2), labels = c("None","Christian","Other")),
  srelig2=factor(srelig2, levels = c(8, 1, 2), labels = c("None","Christian","Other")))
######################################################
#Hypertension
######################################################
#Recode rchrondis excluding hypertension
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rchrondis_exhibpe = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r2hchole, r1parkine, r1osteoe, r1catracte, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r2hchole, r1parkine, r1osteoe, r1catracte, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2osteoe, r2catracte, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2osteoe, r2catracte, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3hchole, r3parkine, r3osteoe, r3catracte, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3hchole, r3parkine, r3osteoe, r3catracte, r3asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4osteoe, r4catracte, r4asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4osteoe, r4catracte, r4asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5osteoe, r5catracte, r5asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5osteoe, r5catracte, r5asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6osteoe, r6catracte, r6asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6osteoe, r6catracte, r6asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7osteoe, r7catracte, r7asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7osteoe, r7catracte, r7asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8osteoe, r8catracte, r8asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8osteoe, r8catracte, r8asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
helsa_all_sp28 <- helsa_all_sp28 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exhibpe = ifelse(person_num == 1, rchrondis_exhibpe[2], rchrondis_exhibpe[1])) %>%
  ungroup()

#Divide dataset by respondent gender
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig2 as it is highly correlated with rarelig_e2, no estimate was computed for the variable
m1 <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exhibpe + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exhibpe + schrondis_exhibpe + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ shibpe + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ shibpe + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_male, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_hibpe_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhibpe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig as it is highly correlated with rarelig_e, no estimate was computed for the variable
m1_f <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exhibpe + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exhibpe + schrondis_exhibpe + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ shibpe + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ shibpe + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_female, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_hibpe_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhibpe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Diabetes
######################################################
#Recode rchrondis excluding diabetes
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rchrondis_exdiabe = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r2hchole, r1parkine, r1osteoe, r1catracte, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r2hchole, r1parkine, r1osteoe, r1catracte, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2osteoe, r2catracte, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2osteoe, r2catracte, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3hchole, r3parkine, r3osteoe, r3catracte, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3hchole, r3parkine, r3osteoe, r3catracte, r3asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4osteoe, r4catracte, r4asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4osteoe, r4catracte, r4asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5osteoe, r5catracte, r5asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5osteoe, r5catracte, r5asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6osteoe, r6catracte, r6asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6osteoe, r6catracte, r6asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7osteoe, r7catracte, r7asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7osteoe, r7catracte, r7asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8osteoe, r8catracte, r8asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8osteoe, r8catracte, r8asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
helsa_all_sp28 <- helsa_all_sp28 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exdiabe = ifelse(person_num == 1, rchrondis_exdiabe[2], rchrondis_exdiabe[1])) %>%
  ungroup()

#Divide dataset by respondent gender
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig2 as it is highly correlated with rarelig_e2, no estimate was computed for the variable
m1 <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exdiabe + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exdiabe + schrondis_exdiabe + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sdiabe + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sdiabe + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_male, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_diabe_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exdiabe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig as it is highly correlated with rarelig_e, no estimate was computed for the variable
m1_f <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exdiabe + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exdiabe + schrondis_exdiabe + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sdiabe + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sdiabe + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_female, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_diabe_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exdiabe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Cancer
######################################################
#Recode rchrondis excluding cancer
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rchrondis_excancre = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1lunge, r1hearte, r1stroke, r1psyche, r2hchole, r1parkine, r1osteoe, r1catracte, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1lunge, r1hearte, r1stroke, r1psyche, r2hchole, r1parkine, r1osteoe, r1catracte, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2lunge, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2osteoe, r2catracte, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2lunge, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2osteoe, r2catracte, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3lunge, r3hearte, r3stroke, r3psyche, r3hchole, r3parkine, r3osteoe, r3catracte, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3lunge, r3hearte, r3stroke, r3psyche, r3hchole, r3parkine, r3osteoe, r3catracte, r3asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4diabe, r4lunge, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4osteoe, r4catracte, r4asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4diabe, r4lunge, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4osteoe, r4catracte, r4asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5diabe, r5lunge, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5osteoe, r5catracte, r5asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5diabe, r5lunge, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5osteoe, r5catracte, r5asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6diabe, r6lunge, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6osteoe, r6catracte, r6asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6diabe, r6lunge, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6osteoe, r6catracte, r6asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7diabe, r7lunge, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7osteoe, r7catracte, r7asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7diabe, r7lunge, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7osteoe, r7catracte, r7asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8diabe, r8lunge, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8osteoe, r8catracte, r8asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8diabe, r8lunge, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8osteoe, r8catracte, r8asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
helsa_all_sp28 <- helsa_all_sp28 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_excancre = ifelse(person_num == 1, rchrondis_excancre[2], rchrondis_excancre[1])) %>%
  ungroup()

#Divide dataset by respondent gender
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig2 as it is highly correlated with rarelig_e2, no estimate was computed for the variable
m1 <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_excancre + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_excancre + schrondis_excancre + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ scancre + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ scancre + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_male, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_cancre_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_excancre ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig as it is highly correlated with rarelig_e, no estimate was computed for the variable
m1_f <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_excancre + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_excancre + schrondis_excancre + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ scancre + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ scancre + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_female, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_cancre_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_excancre ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Lung disease
######################################################
#Recode rchrondis excluding lung disease
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rchrondis_exlunge = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1hearte, r1stroke, r1psyche, r2hchole, r1parkine, r1osteoe, r1catracte, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1hearte, r1stroke, r1psyche, r2hchole, r1parkine, r1osteoe, r1catracte, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2osteoe, r2catracte, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2osteoe, r2catracte, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3hearte, r3stroke, r3psyche, r3hchole, r3parkine, r3osteoe, r3catracte, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3hearte, r3stroke, r3psyche, r3hchole, r3parkine, r3osteoe, r3catracte, r3asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4diabe, r4cancre, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4osteoe, r4catracte, r4asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4diabe, r4cancre, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4osteoe, r4catracte, r4asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5diabe, r5cancre, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5osteoe, r5catracte, r5asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5diabe, r5cancre, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5osteoe, r5catracte, r5asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6diabe, r6cancre, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6osteoe, r6catracte, r6asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6diabe, r6cancre, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6osteoe, r6catracte, r6asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7diabe, r7cancre, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7osteoe, r7catracte, r7asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7diabe, r7cancre, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7osteoe, r7catracte, r7asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8diabe, r8cancre, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8osteoe, r8catracte, r8asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8diabe, r8cancre, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8osteoe, r8catracte, r8asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
helsa_all_sp28 <- helsa_all_sp28 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exlunge = ifelse(person_num == 1, rchrondis_exlunge[2], rchrondis_exlunge[1])) %>%
  ungroup()

#Divide dataset by respondent gender
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig2 as it is highly correlated with rarelig_e2, no estimate was computed for the variable
m1 <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exlunge + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exlunge + schrondis_exlunge + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ slunge + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ slunge + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_male, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_lunge_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlunge ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlunge ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exlunge ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig as it is highly correlated with rarelig_e, no estimate was computed for the variable
m1_f <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exlunge + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exlunge + schrondis_exlunge + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ slunge + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ slunge + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_female, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_lunge_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlunge ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlunge ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exlunge ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Heart disease
######################################################
#Recode rchrondis excluding heart disease
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rchrondis_exhearte = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1stroke, r1psyche, r2hchole, r1parkine, r1osteoe, r1catracte, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1stroke, r1psyche, r2hchole, r1parkine, r1osteoe, r1catracte, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2stroke, r2psyche, r2hchole, r2parkine, r2osteoe, r2catracte, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2stroke, r2psyche, r2hchole, r2parkine, r2osteoe, r2catracte, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3stroke, r3psyche, r3hchole, r3parkine, r3osteoe, r3catracte, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3stroke, r3psyche, r3hchole, r3parkine, r3osteoe, r3catracte, r3asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4stroke, r4psyche, r4hchole, r4parkine, r4osteoe, r4catracte, r4asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4stroke, r4psyche, r4hchole, r4parkine, r4osteoe, r4catracte, r4asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5stroke, r5psyche, r5hchole, r5parkine, r5osteoe, r5catracte, r5asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5stroke, r5psyche, r5hchole, r5parkine, r5osteoe, r5catracte, r5asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6stroke, r6psyche, r6hchole, r6parkine, r6osteoe, r6catracte, r6asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6stroke, r6psyche, r6hchole, r6parkine, r6osteoe, r6catracte, r6asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7stroke, r7psyche, r7hchole, r7parkine, r7osteoe, r7catracte, r7asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7stroke, r7psyche, r7hchole, r7parkine, r7osteoe, r7catracte, r7asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8stroke, r8psyche, r8hchole, r8parkine, r8osteoe, r8catracte, r8asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8stroke, r8psyche, r8hchole, r8parkine, r8osteoe, r8catracte, r8asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
helsa_all_sp28 <- helsa_all_sp28 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exhearte = ifelse(person_num == 1, rchrondis_exhearte[2], rchrondis_exhearte[1])) %>%
  ungroup()

#Divide dataset by respondent gender
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig2 as it is highly correlated with rarelig_e2, no estimate was computed for the variable
m1 <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exhearte + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exhearte + schrondis_exhearte + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ shearte + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ shearte + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_male, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_hearte_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhearte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhearte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhearte ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig as it is highly correlated with rarelig_e, no estimate was computed for the variable
m1_f <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exhearte + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exhearte + schrondis_exhearte + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ shearte + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ shearte + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_female, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_hearte_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhearte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhearte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhearte ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Stroke
######################################################
#Recode rchrondis excluding stroke
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rchrondis_exstroke = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1psyche, r2hchole, r1parkine, r1osteoe, r1catracte, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1psyche, r2hchole, r1parkine, r1osteoe, r1catracte, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2psyche, r2hchole, r2parkine, r2osteoe, r2catracte, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2psyche, r2hchole, r2parkine, r2osteoe, r2catracte, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3psyche, r3hchole, r3parkine, r3osteoe, r3catracte, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3psyche, r3hchole, r3parkine, r3osteoe, r3catracte, r3asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4hearte, r4psyche, r4hchole, r4parkine, r4osteoe, r4catracte, r4asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4hearte, r4psyche, r4hchole, r4parkine, r4osteoe, r4catracte, r4asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5hearte, r5psyche, r5hchole, r5parkine, r5osteoe, r5catracte, r5asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5hearte, r5psyche, r5hchole, r5parkine, r5osteoe, r5catracte, r5asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6hearte, r6psyche, r6hchole, r6parkine, r6osteoe, r6catracte, r6asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6hearte, r6psyche, r6hchole, r6parkine, r6osteoe, r6catracte, r6asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7hearte, r7psyche, r7hchole, r7parkine, r7osteoe, r7catracte, r7asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7hearte, r7psyche, r7hchole, r7parkine, r7osteoe, r7catracte, r7asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8hearte, r8psyche, r8hchole, r8parkine, r8osteoe, r8catracte, r8asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8hearte, r8psyche, r8hchole, r8parkine, r8osteoe, r8catracte, r8asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
helsa_all_sp28 <- helsa_all_sp28 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exstroke = ifelse(person_num == 1, rchrondis_exstroke[2], rchrondis_exstroke[1])) %>%
  ungroup()

#Divide dataset by respondent gender
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig2 as it is highly correlated with rarelig_e2, no estimate was computed for the variable
m1 <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exstroke + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exstroke + schrondis_exstroke + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sstroke + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sstroke + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_male, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_stroke_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exstroke ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig as it is highly correlated with rarelig_e, no estimate was computed for the variable
m1_f <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exstroke + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exstroke + schrondis_exstroke + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sstroke + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sstroke + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_female, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_stroke_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exstroke ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Psychiatric problems
######################################################
#Recode rchrondis excluding psychiatric problems
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rchrondis_expsyche = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r2hchole, r1parkine, r1osteoe, r1catracte, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r2hchole, r1parkine, r1osteoe, r1catracte, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2hchole, r2parkine, r2osteoe, r2catracte, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2hchole, r2parkine, r2osteoe, r2catracte, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3hchole, r3parkine, r3osteoe, r3catracte, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3hchole, r3parkine, r3osteoe, r3catracte, r3asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4hchole, r4parkine, r4osteoe, r4catracte, r4asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4hchole, r4parkine, r4osteoe, r4catracte, r4asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5hchole, r5parkine, r5osteoe, r5catracte, r5asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5hchole, r5parkine, r5osteoe, r5catracte, r5asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6hchole, r6parkine, r6osteoe, r6catracte, r6asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6hchole, r6parkine, r6osteoe, r6catracte, r6asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7hchole, r7parkine, r7osteoe, r7catracte, r7asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7hchole, r7parkine, r7osteoe, r7catracte, r7asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8hchole, r8parkine, r8osteoe, r8catracte, r8asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8hchole, r8parkine, r8osteoe, r8catracte, r8asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
helsa_all_sp28 <- helsa_all_sp28 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_expsyche = ifelse(person_num == 1, rchrondis_expsyche[2], rchrondis_expsyche[1])) %>%
  ungroup()

#Divide dataset by respondent gender
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig2 as it is highly correlated with rarelig_e2, no estimate was computed for the variable
m1 <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_expsyche + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_expsyche + schrondis_expsyche + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ spsyche + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ spsyche + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_male, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_psyche_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_expsyche ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_expsyche ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_expsyche ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig as it is highly correlated with rarelig_e, no estimate was computed for the variable
m1_f <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_expsyche + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_expsyche + schrondis_expsyche + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ spsyche + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ spsyche + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_female, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_psyche_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_expsyche ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_expsyche ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_expsyche ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#High cholesterol
######################################################
#Recode rchrondis excluding high cholesterol
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rchrondis_exhchole = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1parkine, r1osteoe, r1catracte, r1asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1parkine, r1osteoe, r1catracte, r1asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2parkine, r2osteoe, r2catracte, r2asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2parkine, r2osteoe, r2catracte, r2asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3parkine, r3osteoe, r3catracte, r3asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3parkine, r3osteoe, r3catracte, r3asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4parkine, r4osteoe, r4catracte, r4asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4parkine, r4osteoe, r4catracte, r4asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5parkine, r5osteoe, r5catracte, r5asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5parkine, r5osteoe, r5catracte, r5asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6parkine, r6osteoe, r6catracte, r6asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6parkine, r6osteoe, r6catracte, r6asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7parkine, r7osteoe, r7catracte, r7asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7parkine, r7osteoe, r7catracte, r7asthmae),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8parkine, r8osteoe, r8catracte, r8asthmae), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8parkine, r8osteoe, r8catracte, r8asthmae),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
helsa_all_sp28 <- helsa_all_sp28 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exhchole = ifelse(person_num == 1, rchrondis_exhchole[2], rchrondis_exhchole[1])) %>%
  ungroup()

#Divide dataset by respondent gender
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig2 as it is highly correlated with rarelig_e2, no estimate was computed for the variable
m1 <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exhchole + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exhchole + schrondis_exhchole + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ shchole + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ shchole + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_male, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_hchole_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhchole ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhchole ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhchole ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig as it is highly correlated with rarelig_e, no estimate was computed for the variable
m1_f <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exhchole + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exhchole + schrondis_exhchole + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ shchole + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ shchole + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_female, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_hchole_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhchole ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhchole ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhchole ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Asthmae
######################################################
#Recode rchrondis excluding asthmae
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rchrondis_exasthmae = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1parkine, r1osteoe, r1catracte, r2hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1parkine, r1osteoe, r1catracte, r2hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2parkine, r2osteoe, r2catracte, r2hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2parkine, r2osteoe, r2catracte, r2hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3parkine, r3osteoe, r3catracte, r3hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3parkine, r3osteoe, r3catracte, r3hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4parkine, r4osteoe, r4catracte, r4hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4parkine, r4osteoe, r4catracte, r4hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5parkine, r5osteoe, r5catracte, r5hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5parkine, r5osteoe, r5catracte, r5hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6parkine, r6osteoe, r6catracte, r6hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6parkine, r6osteoe, r6catracte, r6hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7parkine, r7osteoe, r7catracte, r7hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7parkine, r7osteoe, r7catracte, r7hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8parkine, r8osteoe, r8catracte, r8hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8parkine, r8osteoe, r8catracte, r8hchole),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
helsa_all_sp28 <- helsa_all_sp28 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exasthmae = ifelse(person_num == 1, rchrondis_exasthmae[2], rchrondis_exasthmae[1])) %>%
  ungroup()

#Divide dataset by respondent gender
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig2 as it is highly correlated with rarelig_e2, no estimate was computed for the variable
m1 <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exasthmae + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exasthmae + schrondis_exasthmae + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sasthmae + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sasthmae + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_male, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_asthmae_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exasthmae ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exasthmae ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exasthmae ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig as it is highly correlated with rarelig_e, no estimate was computed for the variable
m1_f <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exasthmae + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sasthmae + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exasthmae + schrondis_exasthmae + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sasthmae + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sasthmae + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_female, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_asthmae_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exasthmae ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exasthmae ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exasthmae ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sasthmae ~ "Spousal asthmae",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Cataract
######################################################
#Recode rchrondis excluding cataract
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rchrondis_excatracte = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1parkine, r1osteoe, r1asthmae, r2hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1parkine, r1osteoe, r1asthmae, r2hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2parkine, r2osteoe, r2asthmae, r2hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2parkine, r2osteoe, r2asthmae, r2hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3parkine, r3osteoe, r3asthmae, r3hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3parkine, r3osteoe, r3asthmae, r3hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4parkine, r4osteoe, r4asthmae, r4hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4parkine, r4osteoe, r4asthmae, r4hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5parkine, r5osteoe, r5asthmae, r5hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5parkine, r5osteoe, r5asthmae, r5hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6parkine, r6osteoe, r6asthmae, r6hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6parkine, r6osteoe, r6asthmae, r6hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7parkine, r7osteoe, r7asthmae, r7hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7parkine, r7osteoe, r7asthmae, r7hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8parkine, r8osteoe, r8asthmae, r8hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8parkine, r8osteoe, r8asthmae, r8hchole),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
helsa_all_sp28 <- helsa_all_sp28 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_excatracte = ifelse(person_num == 1, rchrondis_excatracte[2], rchrondis_excatracte[1])) %>%
  ungroup()

#Divide dataset by respondent gender
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig2 as it is highly correlated with rarelig_e2, no estimate was computed for the variable
m1 <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_excatracte + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_excatracte + schrondis_excatracte + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ scatracte + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ scatracte + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_male, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_catracte_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excatracte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excatracte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_excatracte ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig as it is highly correlated with rarelig_e, no estimate was computed for the variable
m1_f <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_excatracte + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_excatracte + schrondis_excatracte + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ scatracte + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ scatracte + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_female, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_catracte_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excatracte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excatracte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_excatracte ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Parkinson's disease
######################################################
#Recode rchrondis excluding parkinson's disease
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rchrondis_exparkine = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1catracte, r1osteoe, r1asthmae, r2hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1catracte, r1osteoe, r1asthmae, r2hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2catracte, r2osteoe, r2asthmae, r2hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2catracte, r2osteoe, r2asthmae, r2hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3catracte, r3osteoe, r3asthmae, r3hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3catracte, r3osteoe, r3asthmae, r3hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4catracte, r4osteoe, r4asthmae, r4hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4catracte, r4osteoe, r4asthmae, r4hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5catracte, r5osteoe, r5asthmae, r5hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5catracte, r5osteoe, r5asthmae, r5hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6catracte, r6osteoe, r6asthmae, r6hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6catracte, r6osteoe, r6asthmae, r6hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7catracte, r7osteoe, r7asthmae, r7hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7catracte, r7osteoe, r7asthmae, r7hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8catracte, r8osteoe, r8asthmae, r8hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8catracte, r8osteoe, r8asthmae, r8hchole),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
helsa_all_sp28 <- helsa_all_sp28 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exparkine = ifelse(person_num == 1, rchrondis_exparkine[2], rchrondis_exparkine[1])) %>%
  ungroup()

#Divide dataset by respondent gender
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig2 as it is highly correlated with rarelig_e2, no estimate was computed for the variable
m1 <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exparkine + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exparkine + schrondis_exparkine + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sparkine + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sparkine + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_male, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_parkine_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sparkine ~ "Spousal Parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sparkine ~ "Spousal Parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sparkine ~ "Spousal Parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exparkine ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sparkine ~ "Spousal Parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exparkine ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exparkine ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sparkine ~ "Spousal Parkinson's disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sparkine ~ "Spousal Parkinson's disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig as it is highly correlated with rarelig_e, no estimate was computed for the variable
m1_f <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exparkine + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exparkine + schrondis_exparkine + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sparkine + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sparkine + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_female, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_parkine_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sparkine ~ "Spousal Parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sparkine ~ "Spousal Parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sparkine ~ "Spousal Parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exparkine ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sparkine ~ "Spousal Parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exparkine ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exparkine ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sparkine ~ "Spousal Parkinson's disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sparkine ~ "Spousal Parkinson's disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Osteoporosis 
######################################################
#Recode rchrondis excluding osteoporosis
helsa_all_sp28 <- helsa_all_sp28 %>% mutate(
  rchrondis_exosteoe = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1catracte, r1parkine, r1asthmae, r2hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r1psyche, r1catracte, r1parkine, r1asthmae, r2hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2catracte, r2parkine, r2asthmae, r2hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2catracte, r2parkine, r2asthmae, r2hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3catracte, r3parkine, r3asthmae, r3hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3lunge, r3hearte, r3stroke, r3psyche, r3catracte, r3parkine, r3asthmae, r3hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4catracte, r4parkine, r4asthmae, r4hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4catracte, r4parkine, r4asthmae, r4hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5catracte, r5parkine, r5asthmae, r5hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5catracte, r5parkine, r5asthmae, r5hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6catracte, r6parkine, r6asthmae, r6hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6catracte, r6parkine, r6asthmae, r6hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7catracte, r7parkine, r7asthmae, r7hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7catracte, r7parkine, r7asthmae, r7hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8catracte, r8parkine, r8asthmae, r8hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8catracte, r8parkine, r8asthmae, r8hchole),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define rchrondis_exhibpe for paired spouses
helsa_all_sp28 <- helsa_all_sp28 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exosteoe = ifelse(person_num == 1, rchrondis_exosteoe[2], rchrondis_exosteoe[1])) %>%
  ungroup()

#Divide dataset by respondent gender
helsa_male <- helsa_all_sp28 %>% filter(ragender==1)
helsa_female <- helsa_all_sp28 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal other chronic disease as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig2 as it is highly correlated with rarelig_e2, no estimate was computed for the variable
m1 <- glm(arthritis ~ sosteoe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sosteoe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sosteoe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exosteoe + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sosteoe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exosteoe + schrondis_exosteoe + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sosteoe + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sosteoe + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_male, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_osteoe_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sosteoe ~ "Spousal osteoporosis",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sosteoe ~ "Spousal osteoporosis",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sosteoe ~ "Spousal osteoporosis",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exosteoe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sosteoe ~ "Spousal osteoporosis",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exosteoe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exosteoe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sosteoe ~ "Spousal osteoporosis",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sosteoe ~ "Spousal osteoporosis",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
#Drop srelig as it is highly correlated with rarelig_e, no estimate was computed for the variable
m1_f <- glm(arthritis ~ sosteoe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2), data=helsa_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sosteoe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome, data=helsa_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sosteoe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.numeric(rdrinkr) + rsmokev + rchrondis_exosteoe + ramomeduage2 + radadeduage2 + rclstress + rkcnt, data=helsa_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sosteoe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + raracem + srace + as.factor(rarelig_e2) + rmcurln + hincome + as.factor(rpact) + as.factor(spact) + as.numeric(rdrinkr) + as.numeric(sdrinkr) + rsmokev + ssmokev + rchrondis_exosteoe + schrondis_exosteoe + ramomeduage2 + radadeduage2 + smomeducl2 + sdadeducl2 + rclstress + sclstress + rkcnt +skcnt, data=helsa_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sosteoe + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem, data=helsa_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sosteoe + rmbmicat2 + raeducl + as.factor(roccup2_2) + raracem + rmcurln + hincome, data=helsa_female, family=binomial)

#Combine all models into one table
helsa_adjusted_cc_nocausal_osteoe_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sosteoe ~ "Spousal osteoporosis",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sosteoe ~ "Spousal osteoporosis",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sosteoe ~ "Spousal osteoporosis",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exosteoe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sosteoe ~ "Spousal osteoporosis",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     raracem ~ "Respondent's race",
                     srace ~ "Spousal race",
                     `as.factor(rarelig_e2)` ~ "Respondent's religion",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     `as.numeric(rdrinkr)` ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exosteoe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     rkcnt ~ "Respondent's weekly contact with children",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     `as.numeric(sdrinkr)` ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exosteoe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events",
                     skcnt ~ "Spousal weekly contact with children")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sosteoe ~ "Spousal osteoporosis",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sosteoe ~ "Spousal osteoporosis",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     raracem ~ "Respondent's race",
                     rmcurln ~ "Length of marriage",
                     hincome ~ "Household income")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#SHARE
######################################################
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/SHARE')
load("hshare_all_sp26.rda")

#Recode rarelig_s, country of birth, and BMI
hshare_all_sp26 <- hshare_all_sp26 %>% mutate(
  rarelig_s2=case_when(
    rarelig_s==1 | rarelig_s==2 |rarelig_s==3 ~ 1, #Christian
    rarelig_s==4 | rarelig_s==5 |rarelig_s==6 ~ 2, #Other
    rarelig_s==7 ~ 8,
    TRUE ~ NA_real_),
  srelig2=case_when(
    srelig==1 | srelig==2 |srelig==3 ~ 1, #Christian
    srelig==4 | srelig==5 |srelig==6 ~ 2, #Other
    srelig==7 ~ 8,
    TRUE ~ NA_real_),
  rabplace3=case_when(
    rabplace2=="Europe" ~ rabplace2, 
    rabplace2=="Africa" | rabplace2=="Asia" |rabplace2=="North America" | rabplace2=="South America" | rabplace2=="Oceania" ~ "Outside Europe", 
    TRUE ~ rabplace2),
  sbplace2=case_when(
    sbplace=="Europe" ~ sbplace, 
    sbplace=="Africa" | sbplace=="Asia" |sbplace=="North America" | sbplace=="South America" | sbplace=="Oceania" ~ "Outside Europe", 
    TRUE ~ sbplace),
  rmbmicat2=case_when(
    as.numeric(rmbmicat) %in% c(1, 2, 3) ~ as.numeric(rmbmicat), 
    as.numeric(rmbmicat) %in% c(4, 5, 6) ~ 4, 
    TRUE ~ as.numeric(rmbmicat)),
  smbmicat2=case_when(
    as.numeric(smbmicat) %in% c(1, 2, 3) ~ as.numeric(smbmicat), 
    as.numeric(smbmicat) %in% c(4, 5, 6) ~ 4, 
    TRUE ~ as.numeric(smbmicat)))

#Define variables' classes
hshare_all_sp26 <- hshare_all_sp26 %>% mutate(
  raeducl=factor(raeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  seducl=factor(seducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  ramomeducl=factor(ramomeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  radadeducl=factor(radadeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  smomeducl=factor(smomeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  sdadeducl=factor(sdadeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  rmbmicat2=factor(rmbmicat2, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Pre-obesity","Obesity")),
  smbmicat2=factor(smbmicat2, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Pre-obesity","Obesity")),
  rarelig_s2=factor(rarelig_s2, levels = c(8, 1, 2), labels = c("None","Christian","Other")),
  srelig2=factor(srelig2, levels = c(8, 1, 2), labels = c("None","Christian","Other")))
######################################################
#Hypertension
######################################################
#Create variable of any chronic conditions 
hshare_all_sp26 <- hshare_all_sp26 %>% mutate(
  rchrondis_exhibpe = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r2psyche, r1hchole, r1parkine, r1ulcere, r1catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1diabe, r1cancre, r1lunge, r1hearte, r1stroke, r2psyche, r1hchole, r1parkine, r1ulcere, r1catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2ulcere, r2catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2diabe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2ulcere, r2catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4ulcere, r4catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4diabe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4ulcere, r4catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5ulcere, r5catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5diabe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5ulcere, r5catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6ulcere, r6catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6diabe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6ulcere, r6catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7ulcere, r7catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7diabe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7ulcere, r7catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8ulcere, r8catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8diabe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8ulcere, r8catracte),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other disease variable for paired spouses
hshare_all_sp26 <- hshare_all_sp26 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exhibpe = if_else(person_num == 1, rchrondis_exhibpe[2], rchrondis_exhibpe[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hshare_male <- hshare_all_sp26 %>% filter(ragender==1)
hshare_female <- hshare_all_sp26 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1 <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exhibpe + ramomeducl + radadeducl + rclstress, data=hshare_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exhibpe + schrondis_exhibpe + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ shibpe + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ shibpe + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_hibpe_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhibpe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exhibpe + ramomeducl + radadeducl + rclstress, data=hshare_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ shibpe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exhibpe + schrondis_exhibpe + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ shibpe + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ shibpe + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_hibpe_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhibpe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Diabetes
######################################################
#Create variable of any chronic conditions 
hshare_all_sp26 <- hshare_all_sp26 %>% mutate(
  rchrondis_exdiabe = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1cancre, r1lunge, r1hearte, r1stroke, r2psyche, r1hchole, r1parkine, r1ulcere, r1catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1cancre, r1lunge, r1hearte, r1stroke, r2psyche, r1hchole, r1parkine, r1ulcere, r1catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2ulcere, r2catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2cancre, r2lunge, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2ulcere, r2catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4ulcere, r4catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4cancre, r4lunge, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4ulcere, r4catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5ulcere, r5catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5cancre, r5lunge, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5ulcere, r5catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6ulcere, r6catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6cancre, r6lunge, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6ulcere, r6catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7ulcere, r7catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7cancre, r7lunge, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7ulcere, r7catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8ulcere, r8catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8cancre, r8lunge, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8ulcere, r8catracte),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other disease variable for paired spouses
hshare_all_sp26 <- hshare_all_sp26 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exdiabe = if_else(person_num == 1, rchrondis_exdiabe[2], rchrondis_exdiabe[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hshare_male <- hshare_all_sp26 %>% filter(ragender==1)
hshare_female <- hshare_all_sp26 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1 <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exdiabe + ramomeducl + radadeducl + rclstress, data=hshare_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exdiabe + schrondis_exdiabe + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sdiabe + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sdiabe + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_diabe_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exdiabe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exdiabe + ramomeducl + radadeducl + rclstress, data=hshare_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sdiabe + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exdiabe + schrondis_exdiabe + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sdiabe + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sdiabe + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_diabe_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exdiabe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Lung disease
######################################################
#Create variable of any chronic conditions 
hshare_all_sp26 <- hshare_all_sp26 %>% mutate(
  rchrondis_exlunge = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1cancre, r1diabe, r1hearte, r1stroke, r2psyche, r1hchole, r1parkine, r1ulcere, r1catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1cancre, r1diabe, r1hearte, r1stroke, r2psyche, r1hchole, r1parkine, r1ulcere, r1catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2cancre, r2diabe, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2ulcere, r2catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2cancre, r2diabe, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2ulcere, r2catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4cancre, r4diabe, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4ulcere, r4catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4cancre, r4diabe, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4ulcere, r4catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5cancre, r5diabe, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5ulcere, r5catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5cancre, r5diabe, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5ulcere, r5catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6cancre, r6diabe, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6ulcere, r6catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6cancre, r6diabe, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6ulcere, r6catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7cancre, r7diabe, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7ulcere, r7catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7cancre, r7diabe, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7ulcere, r7catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8cancre, r8diabe, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8ulcere, r8catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8cancre, r8diabe, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8ulcere, r8catracte),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other disease variable for paired spouses
hshare_all_sp26 <- hshare_all_sp26 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exlunge = if_else(person_num == 1, rchrondis_exlunge[2], rchrondis_exlunge[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hshare_male <- hshare_all_sp26 %>% filter(ragender==1)
hshare_female <- hshare_all_sp26 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1 <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exlunge + ramomeducl + radadeducl + rclstress, data=hshare_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exlunge + schrondis_exlunge + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ slunge + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ slunge + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_lunge_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlunge ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlunge ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exlunge ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exlunge + ramomeducl + radadeducl + rclstress, data=hshare_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ slunge + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exlunge + schrondis_exlunge + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ slunge + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ slunge + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_lunge_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlunge ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exlunge ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exlunge ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     slunge ~ "Spousal lung disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Cancer
######################################################
#Create variable of any chronic conditions 
hshare_all_sp26 <- hshare_all_sp26 %>% mutate(
  rchrondis_excancre = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1lunge, r1diabe, r1hearte, r1stroke, r2psyche, r1hchole, r1parkine, r1ulcere, r1catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1lunge, r1diabe, r1hearte, r1stroke, r2psyche, r1hchole, r1parkine, r1ulcere, r1catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2lunge, r2diabe, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2ulcere, r2catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2lunge, r2diabe, r2hearte, r2stroke, r2psyche, r2hchole, r2parkine, r2ulcere, r2catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4lunge, r4diabe, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4ulcere, r4catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4lunge, r4diabe, r4hearte, r4stroke, r4psyche, r4hchole, r4parkine, r4ulcere, r4catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5lunge, r5diabe, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5ulcere, r5catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5lunge, r5diabe, r5hearte, r5stroke, r5psyche, r5hchole, r5parkine, r5ulcere, r5catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6lunge, r6diabe, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6ulcere, r6catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6lunge, r6diabe, r6hearte, r6stroke, r6psyche, r6hchole, r6parkine, r6ulcere, r6catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7lunge, r7diabe, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7ulcere, r7catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7lunge, r7diabe, r7hearte, r7stroke, r7psyche, r7hchole, r7parkine, r7ulcere, r7catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8lunge, r8diabe, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8ulcere, r8catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8lunge, r8diabe, r8hearte, r8stroke, r8psyche, r8hchole, r8parkine, r8ulcere, r8catracte),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other disease variable for paired spouses
hshare_all_sp26 <- hshare_all_sp26 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_excancre = if_else(person_num == 1, rchrondis_excancre[2], rchrondis_excancre[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hshare_male <- hshare_all_sp26 %>% filter(ragender==1)
hshare_female <- hshare_all_sp26 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1 <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_excancre + ramomeducl + radadeducl + rclstress, data=hshare_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_excancre + schrondis_excancre + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ scancre + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ scancre + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_cancre_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_excancre ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_excancre + ramomeducl + radadeducl + rclstress, data=hshare_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ scancre + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_excancre + schrondis_excancre + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ scancre + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ scancre + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_cancre_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_excancre ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Heart disease
######################################################
#Create variable of any chronic conditions 
hshare_all_sp26 <- hshare_all_sp26 %>% mutate(
  rchrondis_exhearte = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1lunge, r1diabe, r1cancre, r1stroke, r2psyche, r1hchole, r1parkine, r1ulcere, r1catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1lunge, r1diabe, r1cancre, r1stroke, r2psyche, r1hchole, r1parkine, r1ulcere, r1catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2lunge, r2diabe, r2cancre, r2stroke, r2psyche, r2hchole, r2parkine, r2ulcere, r2catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2lunge, r2diabe, r2cancre, r2stroke, r2psyche, r2hchole, r2parkine, r2ulcere, r2catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4lunge, r4diabe, r4cancre, r4stroke, r4psyche, r4hchole, r4parkine, r4ulcere, r4catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4lunge, r4diabe, r4cancre, r4stroke, r4psyche, r4hchole, r4parkine, r4ulcere, r4catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5lunge, r5diabe, r5cancre, r5stroke, r5psyche, r5hchole, r5parkine, r5ulcere, r5catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5lunge, r5diabe, r5cancre, r5stroke, r5psyche, r5hchole, r5parkine, r5ulcere, r5catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6lunge, r6diabe, r6cancre, r6stroke, r6psyche, r6hchole, r6parkine, r6ulcere, r6catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6lunge, r6diabe, r6cancre, r6stroke, r6psyche, r6hchole, r6parkine, r6ulcere, r6catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7lunge, r7diabe, r7cancre, r7stroke, r7psyche, r7hchole, r7parkine, r7ulcere, r7catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7lunge, r7diabe, r7cancre, r7stroke, r7psyche, r7hchole, r7parkine, r7ulcere, r7catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8lunge, r8diabe, r8cancre, r8stroke, r8psyche, r8hchole, r8parkine, r8ulcere, r8catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8lunge, r8diabe, r8cancre, r8stroke, r8psyche, r8hchole, r8parkine, r8ulcere, r8catracte),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other disease variable for paired spouses
hshare_all_sp26 <- hshare_all_sp26 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exhearte = if_else(person_num == 1, rchrondis_exhearte[2], rchrondis_exhearte[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hshare_male <- hshare_all_sp26 %>% filter(ragender==1)
hshare_female <- hshare_all_sp26 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1 <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exhearte + ramomeducl + radadeducl + rclstress, data=hshare_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exhearte + schrondis_exhearte + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ shearte + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ shearte + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_hearte_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhearte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhearte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhearte ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exhearte + ramomeducl + radadeducl + rclstress, data=hshare_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ shearte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exhearte + schrondis_exhearte + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ shearte + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ shearte + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_hearte_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhearte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhearte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhearte ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     shearte ~ "Spousal heart disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Stroke
######################################################
#Create variable of any chronic conditions 
hshare_all_sp26 <- hshare_all_sp26 %>% mutate(
  rchrondis_exstroke = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1lunge, r1diabe, r1cancre, r1hearte, r2psyche, r1hchole, r1parkine, r1ulcere, r1catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1lunge, r1diabe, r1cancre, r1hearte, r2psyche, r1hchole, r1parkine, r1ulcere, r1catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2lunge, r2diabe, r2cancre, r2hearte, r2psyche, r2hchole, r2parkine, r2ulcere, r2catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2lunge, r2diabe, r2cancre, r2hearte, r2psyche, r2hchole, r2parkine, r2ulcere, r2catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4lunge, r4diabe, r4cancre, r4hearte, r4psyche, r4hchole, r4parkine, r4ulcere, r4catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4lunge, r4diabe, r4cancre, r4hearte, r4psyche, r4hchole, r4parkine, r4ulcere, r4catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5lunge, r5diabe, r5cancre, r5hearte, r5psyche, r5hchole, r5parkine, r5ulcere, r5catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5lunge, r5diabe, r5cancre, r5hearte, r5psyche, r5hchole, r5parkine, r5ulcere, r5catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6lunge, r6diabe, r6cancre, r6hearte, r6psyche, r6hchole, r6parkine, r6ulcere, r6catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6lunge, r6diabe, r6cancre, r6hearte, r6psyche, r6hchole, r6parkine, r6ulcere, r6catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7lunge, r7diabe, r7cancre, r7hearte, r7psyche, r7hchole, r7parkine, r7ulcere, r7catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7lunge, r7diabe, r7cancre, r7hearte, r7psyche, r7hchole, r7parkine, r7ulcere, r7catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8lunge, r8diabe, r8cancre, r8hearte, r8psyche, r8hchole, r8parkine, r8ulcere, r8catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8lunge, r8diabe, r8cancre, r8hearte, r8psyche, r8hchole, r8parkine, r8ulcere, r8catracte),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other disease variable for paired spouses
hshare_all_sp26 <- hshare_all_sp26 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exstroke = if_else(person_num == 1, rchrondis_exstroke[2], rchrondis_exstroke[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hshare_male <- hshare_all_sp26 %>% filter(ragender==1)
hshare_female <- hshare_all_sp26 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1 <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exstroke + ramomeducl + radadeducl + rclstress, data=hshare_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exstroke + schrondis_exstroke + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sstroke + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sstroke + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_stroke_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exstroke ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exstroke + ramomeducl + radadeducl + rclstress, data=hshare_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sstroke + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exstroke + schrondis_exstroke + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sstroke + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sstroke + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_stroke_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exstroke ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Pyschiatric problems
######################################################
#Create variable of any chronic conditions 
hshare_all_sp26 <- hshare_all_sp26 %>% mutate(
  rchrondis_expsyche = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1lunge, r1diabe, r1cancre, r1hearte, r1stroke, r1hchole, r1parkine, r1ulcere, r1catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1lunge, r1diabe, r1cancre, r1hearte, r1stroke, r1hchole, r1parkine, r1ulcere, r1catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2lunge, r2diabe, r2cancre, r2hearte, r2stroke, r2hchole, r2parkine, r2ulcere, r2catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2lunge, r2diabe, r2cancre, r2hearte, r2stroke, r2hchole, r2parkine, r2ulcere, r2catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4lunge, r4diabe, r4cancre, r4hearte, r4stroke, r4hchole, r4parkine, r4ulcere, r4catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4lunge, r4diabe, r4cancre, r4hearte, r4stroke, r4hchole, r4parkine, r4ulcere, r4catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5lunge, r5diabe, r5cancre, r5hearte, r5stroke, r5hchole, r5parkine, r5ulcere, r5catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5lunge, r5diabe, r5cancre, r5hearte, r5stroke, r5hchole, r5parkine, r5ulcere, r5catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6lunge, r6diabe, r6cancre, r6hearte, r6stroke, r6hchole, r6parkine, r6ulcere, r6catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6lunge, r6diabe, r6cancre, r6hearte, r6stroke, r6hchole, r6parkine, r6ulcere, r6catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7lunge, r7diabe, r7cancre, r7hearte, r7stroke, r7hchole, r7parkine, r7ulcere, r7catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7lunge, r7diabe, r7cancre, r7hearte, r7stroke, r7hchole, r7parkine, r7ulcere, r7catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8lunge, r8diabe, r8cancre, r8hearte, r8stroke, r8hchole, r8parkine, r8ulcere, r8catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8lunge, r8diabe, r8cancre, r8hearte, r8stroke, r8hchole, r8parkine, r8ulcere, r8catracte),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other disease variable for paired spouses
hshare_all_sp26 <- hshare_all_sp26 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_expsyche = if_else(person_num == 1, rchrondis_expsyche[2], rchrondis_expsyche[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hshare_male <- hshare_all_sp26 %>% filter(ragender==1)
hshare_female <- hshare_all_sp26 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1 <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_expsyche + ramomeducl + radadeducl + rclstress, data=hshare_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_expsyche + schrondis_expsyche + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ spsyche + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ spsyche + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_psyche_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_expsyche ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_expsyche ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_expsyche ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_expsyche + ramomeducl + radadeducl + rclstress, data=hshare_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ spsyche + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_expsyche + schrondis_expsyche + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ spsyche + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ spsyche + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_psyche_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_expsyche ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_expsyche ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_expsyche ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     spsyche ~ "Spousal psychiatric problems",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#High cholesterol
######################################################
#Create variable of any chronic conditions 
hshare_all_sp26 <- hshare_all_sp26 %>% mutate(
  rchrondis_exhchole = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1lunge, r1diabe, r1cancre, r1hearte, r1stroke, r2psyche, r1parkine, r1ulcere, r1catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1lunge, r1diabe, r1cancre, r1hearte, r1stroke, r2psyche, r1parkine, r1ulcere, r1catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2lunge, r2diabe, r2cancre, r2hearte, r2stroke, r2psyche, r2parkine, r2ulcere, r2catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2lunge, r2diabe, r2cancre, r2hearte, r2stroke, r2psyche, r2parkine, r2ulcere, r2catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4lunge, r4diabe, r4cancre, r4hearte, r4stroke, r4psyche, r4parkine, r4ulcere, r4catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4lunge, r4diabe, r4cancre, r4hearte, r4stroke, r4psyche, r4parkine, r4ulcere, r4catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5lunge, r5diabe, r5cancre, r5hearte, r5stroke, r5psyche, r5parkine, r5ulcere, r5catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5lunge, r5diabe, r5cancre, r5hearte, r5stroke, r5psyche, r5parkine, r5ulcere, r5catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6lunge, r6diabe, r6cancre, r6hearte, r6stroke, r6psyche, r6parkine, r6ulcere, r6catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6lunge, r6diabe, r6cancre, r6hearte, r6stroke, r6psyche, r6parkine, r6ulcere, r6catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7lunge, r7diabe, r7cancre, r7hearte, r7stroke, r7psyche, r7parkine, r7ulcere, r7catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7lunge, r7diabe, r7cancre, r7hearte, r7stroke, r7psyche, r7parkine, r7ulcere, r7catracte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8lunge, r8diabe, r8cancre, r8hearte, r8stroke, r8psyche, r8parkine, r8ulcere, r8catracte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8lunge, r8diabe, r8cancre, r8hearte, r8stroke, r8psyche, r8parkine, r8ulcere, r8catracte),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other disease variable for paired spouses
hshare_all_sp26 <- hshare_all_sp26 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exhchole = if_else(person_num == 1, rchrondis_exhchole[2], rchrondis_exhchole[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hshare_male <- hshare_all_sp26 %>% filter(ragender==1)
hshare_female <- hshare_all_sp26 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1 <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exhchole + ramomeducl + radadeducl + rclstress, data=hshare_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exhchole + schrondis_exhchole + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ shchole + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ shchole + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_hchole_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhchole ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhchole ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhchole ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exhchole + ramomeducl + radadeducl + rclstress, data=hshare_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ shchole + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exhchole + schrondis_exhchole + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ shchole + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ shchole + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_hchole_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhchole ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhchole ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhchole ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     shchole ~ "Spousal high cholesterol",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Cataract
######################################################
#Create variable of any chronic conditions 
hshare_all_sp26 <- hshare_all_sp26 %>% mutate(
  rchrondis_excatracte = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1lunge, r1diabe, r1cancre, r1hearte, r1stroke, r2psyche, r1parkine, r1ulcere, r1hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1lunge, r1diabe, r1cancre, r1hearte, r1stroke, r2psyche, r1parkine, r1ulcere, r1hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2lunge, r2diabe, r2cancre, r2hearte, r2stroke, r2psyche, r2parkine, r2ulcere, r2hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2lunge, r2diabe, r2cancre, r2hearte, r2stroke, r2psyche, r2parkine, r2ulcere, r2hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4lunge, r4diabe, r4cancre, r4hearte, r4stroke, r4psyche, r4parkine, r4ulcere, r4hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4lunge, r4diabe, r4cancre, r4hearte, r4stroke, r4psyche, r4parkine, r4ulcere, r4hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5lunge, r5diabe, r5cancre, r5hearte, r5stroke, r5psyche, r5parkine, r5ulcere, r5hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5lunge, r5diabe, r5cancre, r5hearte, r5stroke, r5psyche, r5parkine, r5ulcere, r5hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6lunge, r6diabe, r6cancre, r6hearte, r6stroke, r6psyche, r6parkine, r6ulcere, r6hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6lunge, r6diabe, r6cancre, r6hearte, r6stroke, r6psyche, r6parkine, r6ulcere, r6hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7lunge, r7diabe, r7cancre, r7hearte, r7stroke, r7psyche, r7parkine, r7ulcere, r7hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7lunge, r7diabe, r7cancre, r7hearte, r7stroke, r7psyche, r7parkine, r7ulcere, r7hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8lunge, r8diabe, r8cancre, r8hearte, r8stroke, r8psyche, r8parkine, r8ulcere, r8hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8lunge, r8diabe, r8cancre, r8hearte, r8stroke, r8psyche, r8parkine, r8ulcere, r8hchole),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other disease variable for paired spouses
hshare_all_sp26 <- hshare_all_sp26 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_excatracte = if_else(person_num == 1, rchrondis_excatracte[2], rchrondis_excatracte[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hshare_male <- hshare_all_sp26 %>% filter(ragender==1)
hshare_female <- hshare_all_sp26 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1 <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_excatracte + ramomeducl + radadeducl + rclstress, data=hshare_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_excatracte + schrondis_excatracte + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ scatracte + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ scatracte + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_catracte_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excatracte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excatracte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_excatracte ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_excatracte + ramomeducl + radadeducl + rclstress, data=hshare_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ scatracte + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_excatracte + schrondis_excatracte + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ scatracte + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ scatracte + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_catracte_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excatracte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excatracte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_excatracte ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     scatracte ~ "Spousal cataract",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Parkinson's disease
######################################################
#Create variable of any chronic conditions 
hshare_all_sp26 <- hshare_all_sp26 %>% mutate(
  rchrondis_exparkine = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1lunge, r1diabe, r1cancre, r1hearte, r1stroke, r2psyche, r1catracte, r1ulcere, r1hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1lunge, r1diabe, r1cancre, r1hearte, r1stroke, r2psyche, r1catracte, r1ulcere, r1hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2lunge, r2diabe, r2cancre, r2hearte, r2stroke, r2psyche, r2catracte, r2ulcere, r2hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2lunge, r2diabe, r2cancre, r2hearte, r2stroke, r2psyche, r2catracte, r2ulcere, r2hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4lunge, r4diabe, r4cancre, r4hearte, r4stroke, r4psyche, r4catracte, r4ulcere, r4hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4lunge, r4diabe, r4cancre, r4hearte, r4stroke, r4psyche, r4catracte, r4ulcere, r4hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5lunge, r5diabe, r5cancre, r5hearte, r5stroke, r5psyche, r5catracte, r5ulcere, r5hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5lunge, r5diabe, r5cancre, r5hearte, r5stroke, r5psyche, r5catracte, r5ulcere, r5hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6lunge, r6diabe, r6cancre, r6hearte, r6stroke, r6psyche, r6catracte, r6ulcere, r6hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6lunge, r6diabe, r6cancre, r6hearte, r6stroke, r6psyche, r6catracte, r6ulcere, r6hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7lunge, r7diabe, r7cancre, r7hearte, r7stroke, r7psyche, r7catracte, r7ulcere, r7hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7lunge, r7diabe, r7cancre, r7hearte, r7stroke, r7psyche, r7catracte, r7ulcere, r7hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8lunge, r8diabe, r8cancre, r8hearte, r8stroke, r8psyche, r8catracte, r8ulcere, r8hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8lunge, r8diabe, r8cancre, r8hearte, r8stroke, r8psyche, r8catracte, r8ulcere, r8hchole),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other disease variable for paired spouses
hshare_all_sp26 <- hshare_all_sp26 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exparkine = if_else(person_num == 1, rchrondis_exparkine[2], rchrondis_exparkine[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hshare_male <- hshare_all_sp26 %>% filter(ragender==1)
hshare_female <- hshare_all_sp26 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1 <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exparkine + ramomeducl + radadeducl + rclstress, data=hshare_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exparkine + schrondis_exparkine + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sparkine + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sparkine + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_parkine_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sparkine ~ "Spousal parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sparkine ~ "Spousal parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sparkine ~ "Spousal parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exparkine ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sparkine ~ "Spousal parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exparkine ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exparkine ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sparkine ~ "Spousal parkinson's disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sparkine ~ "Spousal parkinson's disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exparkine + ramomeducl + radadeducl + rclstress, data=hshare_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sparkine + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exparkine + schrondis_exparkine + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sparkine + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sparkine + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_parkine_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sparkine ~ "Spousal parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sparkine ~ "Spousal parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sparkine ~ "Spousal parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exparkine ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sparkine ~ "Spousal parkinson's disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exparkine ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exparkine ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sparkine ~ "Spousal parkinson's disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sparkine ~ "Spousal parkinson's disease",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Ulcer
######################################################
#Create variable of any chronic conditions 
hshare_all_sp26 <- hshare_all_sp26 %>% mutate(
  rchrondis_exulcere = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1lunge, r1diabe, r1cancre, r1hearte, r1stroke, r2psyche, r1catracte, r1parkine, r1hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1lunge, r1diabe, r1cancre, r1hearte, r1stroke, r2psyche, r1catracte, r1parkine, r1hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2lunge, r2diabe, r2cancre, r2hearte, r2stroke, r2psyche, r2catracte, r2parkine, r2hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2lunge, r2diabe, r2cancre, r2hearte, r2stroke, r2psyche, r2catracte, r2parkine, r2hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4lunge, r4diabe, r4cancre, r4hearte, r4stroke, r4psyche, r4catracte, r4parkine, r4hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4lunge, r4diabe, r4cancre, r4hearte, r4stroke, r4psyche, r4catracte, r4parkine, r4hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5lunge, r5diabe, r5cancre, r5hearte, r5stroke, r5psyche, r5catracte, r5parkine, r5hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5lunge, r5diabe, r5cancre, r5hearte, r5stroke, r5psyche, r5catracte, r5parkine, r5hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 6" & if_any(c(r6hibpe, r6lunge, r6diabe, r6cancre, r6hearte, r6stroke, r6psyche, r6catracte, r6parkine, r6hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 6" & if_all(c(r6hibpe, r6lunge, r6diabe, r6cancre, r6hearte, r6stroke, r6psyche, r6catracte, r6parkine, r6hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 7" & if_any(c(r7hibpe, r7lunge, r7diabe, r7cancre, r7hearte, r7stroke, r7psyche, r7catracte, r7parkine, r7hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 7" & if_all(c(r7hibpe, r7lunge, r7diabe, r7cancre, r7hearte, r7stroke, r7psyche, r7catracte, r7parkine, r7hchole),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 8" & if_any(c(r8hibpe, r8lunge, r8diabe, r8cancre, r8hearte, r8stroke, r8psyche, r8catracte, r8parkine, r8hchole), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 8" & if_all(c(r8hibpe, r8lunge, r8diabe, r8cancre, r8hearte, r8stroke, r8psyche, r8catracte, r8parkine, r8hchole),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other disease variable for paired spouses
hshare_all_sp26 <- hshare_all_sp26 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exulcere = if_else(person_num == 1, rchrondis_exulcere[2], rchrondis_exulcere[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hshare_male <- hshare_all_sp26 %>% filter(ragender==1)
hshare_female <- hshare_all_sp26 %>% filter(ragender==2)

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1 <- glm(arthritis ~ sulcere + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_male, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sulcere + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sulcere + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exulcere + ramomeducl + radadeducl + rclstress, data=hshare_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sulcere + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exulcere + schrondis_exulcere + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sulcere + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sulcere + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_male, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_ulcere_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sulcere ~ "Spousal ulcer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sulcere ~ "Spousal ulcer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sulcere ~ "Spousal ulcer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exulcere ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sulcere ~ "Spousal ulcer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exulcere ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exulcere ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sulcere ~ "Spousal ulcer",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sulcere ~ "Spousal ulcer",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ sulcere + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2), data=hshare_female, family=binomial)
#Model 2: additionally adjusting for length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sulcere + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sulcere + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + rdrinkw + rsmokev + rchrondis_exulcere + ramomeducl + radadeducl + rclstress, data=hshare_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sulcere + rage + sage + rmbmicat2 + smbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + as.factor(rarelig_s2) + as.factor(srelig2) + as.factor(rabplace3) + as.factor(sbplace2) + hrural2 + rmcurln + hincome_max + hkcnt2 + as.factor(rpact) + as.factor(spact) + rdrinkw + sdrinkw + rsmokev + ssmokev + rchrondis_exulcere + schrondis_exulcere + ramomeducl + radadeducl + smomeducl + sdadeducl+ rclstress + sclstress, data=hshare_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sulcere + rmbmicat2 + raeducl + as.factor(roccup2_2), data=hshare_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sulcere + rmbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + rmcurln + hincome_max + hkcnt2, data=hshare_female, family=binomial)

#Combine all models into one table
hshare_adjusted_cc_nocausal_ulcere_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sulcere ~ "Spousal ulcer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sulcere ~ "Spousal ulcer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sulcere ~ "Spousal ulcer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exulcere ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sulcere ~ "Spousal ulcer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     smbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     `as.factor(rabplace3)` ~ "Respondent's birthplace",
                     `as.factor(sbplace2)` ~ "Spousal birthplace",
                     `as.factor(rarelig_s2)` ~ "Respondent's religion",
                     `as.factor(srelig2)` ~ "Respondent's religion",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children",
                     `as.factor(rpact)` ~ "Respondent's physical activity",
                     rdrinkw ~ "Respondent drinks alcohol weekly",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exulcere ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     `as.factor(spact)` ~ "Spousal physical activity",
                     sdrinkw ~ "Spouse drinks alcohol weekly",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exulcere ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sulcere ~ "Spousal ulcer",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sulcere ~ "Spousal ulcer",
                     rmbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     rmcurln ~ "Length of marriage",
                     hincome_max ~ "Household income (maximum)",
                     hkcnt2 ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#MHAS
######################################################
#Load data
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Data/MHAS')
load("hmhas_all_sp23.rda")

#Recode BMI
hmhas_all_sp23 <- hmhas_all_sp23 %>% mutate(
  rbmicat2=case_when(
    rbmicat==1 | rbmicat==2 | rbmicat==3 ~ rbmicat, 
    rbmicat==4 | rbmicat==5 | rbmicat==6 ~ 4, 
    TRUE ~ rbmicat),
  sbmicat2=case_when(
    sbmicat==1 | sbmicat==2 | sbmicat==3 ~ sbmicat, 
    sbmicat==4 | sbmicat==5 | sbmicat==6 ~ 4, 
    TRUE ~ sbmicat))

#Define variables' classes
hmhas_all_sp23 <- hmhas_all_sp23 %>% mutate(
  raeducl=factor(raeducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  seducl=factor(seducl, levels=c(1, 2, 3), labels=c("< Upper secondary","Upper secondary/vocational training","Tertiary"), ordered = TRUE),
  rameduc_m=factor(rameduc_m, levels=c(1, 2, 3, 4), labels=c("No education","Some primary","Primary", "More than primary"), ordered = TRUE),
  rafeduc_m=factor(rafeduc_m, levels=c(1, 2, 3, 4), labels=c("No education","Some primary","Primary", "More than primary"), ordered = TRUE),
  smomeducl=factor(smomeducl, levels=c(1, 2, 3, 4), labels=c("No education","Some primary","Primary", "More than primary"), ordered = TRUE),
  sdadeducl=factor(sdadeducl, levels=c(1, 2, 3, 4), labels=c("No education","Some primary","Primary", "More than primary"), ordered = TRUE),
  rbmicat2=factor(rbmicat2, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Pre-obesity","Obesity")),
  sbmicat2=factor(sbmicat2, levels = c(2, 1, 3, 4), labels = c("Normal weight","Underweight","Pre-obesity","Obesity")))
######################################################
#Hypertension
######################################################
#Create variable of any chronic conditions 
hmhas_all_sp23 <- hmhas_all_sp23 %>% mutate(
  rchrondis_exhibpe = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1diabe, r1cancre, r1respe, r1hrtatte, r1stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1diabe, r1cancre, r1respe, r1hrtatte, r1stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2diabe, r2cancre, r2respe, r2hrtatte, r2stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2diabe, r2cancre, r2respe, r2hrtatte, r2stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3diabe, r3cancre, r3respe, r3hrtatte, r3stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3diabe, r3cancre, r3respe, r3hrtatte, r3stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4diabe, r4cancre, r4respe, r4hrtatte, r4stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4diabe, r4cancre, r4respe, r4hrtatte, r4stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5diabe, r5cancre, r5respe, r5hrtatte, r5stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5diabe, r5cancre, r5respe, r5hrtatte, r5stroke),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other chronic disease variable for paired spouses
hmhas_all_sp23 <- hmhas_all_sp23 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exhibpe = if_else(person_num == 1, rchrondis_exhibpe[2], rchrondis_exhibpe[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hmhas_male <- hmhas_all_sp23 %>% filter(ragender==1) 
hmhas_female <- hmhas_all_sp23 %>% filter(ragender==2) 

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation to account for assortative mating
m1 <- glm(arthritis ~ shibpe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2), data=hmhas_male, family=binomial)
#Model 2: additionally adjusting for household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ shibpe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ shibpe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + rdrinkr + rsmokev + rchrondis_exhibpe + rameduc_m + rafeduc_m + rclstress, data=hmhas_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ shibpe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis_exhibpe + schrondis_exhibpe + rameduc_m + rafeduc_m + smomeducl + sdadeducl+ rclstress + sclstress, data=hmhas_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ shibpe + rbmicat2 + raeducl + as.factor(roccup2_2), data=hmhas_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ shibpe + rbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_male, family=binomial)

#Combine all models into one table
hmhas_adjusted_cc_nocausal_hibpe_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhibpe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ shibpe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2), data=hmhas_female, family=binomial)
#Model 2: additionally adjusting for household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ shibpe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ shibpe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + rdrinkr + rsmokev + rchrondis_exhibpe + rameduc_m + rafeduc_m + rclstress, data=hmhas_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ shibpe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis_exhibpe + schrondis_exhibpe + rameduc_m + rafeduc_m + smomeducl + sdadeducl+ rclstress + sclstress, data=hmhas_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ shibpe + rbmicat2 + raeducl + as.factor(roccup2_2), data=hmhas_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ shibpe + rbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_female, family=binomial)

#Combine all models into one table
hmhas_adjusted_cc_nocausal_hibpe_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhibpe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhibpe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     shibpe ~ "Spousal hypertension",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Diabetes
######################################################
#Create variable of any chronic conditions 
hmhas_all_sp23 <- hmhas_all_sp23 %>% mutate(
  rchrondis_exdiabe = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1cancre, r1respe, r1hrtatte, r1stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1cancre, r1respe, r1hrtatte, r1stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2cancre, r2respe, r2hrtatte, r2stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2cancre, r2respe, r2hrtatte, r2stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3cancre, r3respe, r3hrtatte, r3stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3cancre, r3respe, r3hrtatte, r3stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4cancre, r4respe, r4hrtatte, r4stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4cancre, r4respe, r4hrtatte, r4stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5cancre, r5respe, r5hrtatte, r5stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5cancre, r5respe, r5hrtatte, r5stroke),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other chronic disease variable for paired spouses
hmhas_all_sp23 <- hmhas_all_sp23 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exdiabe = if_else(person_num == 1, rchrondis_exdiabe[2], rchrondis_exdiabe[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hmhas_male <- hmhas_all_sp23 %>% filter(ragender==1) 
hmhas_female <- hmhas_all_sp23 %>% filter(ragender==2) 

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation to account for assortative mating
m1 <- glm(arthritis ~ sdiabe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2), data=hmhas_male, family=binomial)
#Model 2: additionally adjusting for household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sdiabe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sdiabe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + rdrinkr + rsmokev + rchrondis_exdiabe + rameduc_m + rafeduc_m + rclstress, data=hmhas_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sdiabe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis_exdiabe + schrondis_exdiabe + rameduc_m + rafeduc_m + smomeducl + sdadeducl+ rclstress + sclstress, data=hmhas_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sdiabe + rbmicat2 + raeducl + as.factor(roccup2_2), data=hmhas_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sdiabe + rbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_male, family=binomial)

#Combine all models into one table
hmhas_adjusted_cc_nocausal_diabe_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exdiabe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ sdiabe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2), data=hmhas_female, family=binomial)
#Model 2: additionally adjusting for household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sdiabe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sdiabe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + rdrinkr + rsmokev + rchrondis_exdiabe + rameduc_m + rafeduc_m + rclstress, data=hmhas_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sdiabe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis_exdiabe + schrondis_exdiabe + rameduc_m + rafeduc_m + smomeducl + sdadeducl+ rclstress + sclstress, data=hmhas_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sdiabe + rbmicat2 + raeducl + as.factor(roccup2_2), data=hmhas_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sdiabe + rbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_female, family=binomial)

#Combine all models into one table
hmhas_adjusted_cc_nocausal_diabe_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exdiabe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exdiabe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sdiabe ~ "Spousal diabetes",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Cancer
######################################################
#Create variable of any chronic conditions 
hmhas_all_sp23 <- hmhas_all_sp23 %>% mutate(
  rchrondis_excancre = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1respe, r1hrtatte, r1stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1respe, r1hrtatte, r1stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2respe, r2hrtatte, r2stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2respe, r2hrtatte, r2stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3respe, r3hrtatte, r3stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3respe, r3hrtatte, r3stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4diabe, r4respe, r4hrtatte, r4stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4diabe, r4respe, r4hrtatte, r4stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5diabe, r5respe, r5hrtatte, r5stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5diabe, r5respe, r5hrtatte, r5stroke),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other chronic disease variable for paired spouses
hmhas_all_sp23 <- hmhas_all_sp23 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_excancre = if_else(person_num == 1, rchrondis_excancre[2], rchrondis_excancre[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hmhas_male <- hmhas_all_sp23 %>% filter(ragender==1) 
hmhas_female <- hmhas_all_sp23 %>% filter(ragender==2) 

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation to account for assortative mating
m1 <- glm(arthritis ~ scancre + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2), data=hmhas_male, family=binomial)
#Model 2: additionally adjusting for household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ scancre + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ scancre + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + rdrinkr + rsmokev + rchrondis_excancre + rameduc_m + rafeduc_m + rclstress, data=hmhas_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ scancre + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis_excancre + schrondis_excancre + rameduc_m + rafeduc_m + smomeducl + sdadeducl+ rclstress + sclstress, data=hmhas_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ scancre + rbmicat2 + raeducl + as.factor(roccup2_2), data=hmhas_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ scancre + rbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_male, family=binomial)

#Combine all models into one table
hmhas_adjusted_cc_nocausal_cancre_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_excancre ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ scancre + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2), data=hmhas_female, family=binomial)
#Model 2: additionally adjusting for household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ scancre + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ scancre + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + rdrinkr + rsmokev + rchrondis_excancre + rameduc_m + rafeduc_m + rclstress, data=hmhas_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ scancre + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis_excancre + schrondis_excancre + rameduc_m + rafeduc_m + smomeducl + sdadeducl+ rclstress + sclstress, data=hmhas_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ scancre + rbmicat2 + raeducl + as.factor(roccup2_2), data=hmhas_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ scancre + rbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_female, family=binomial)

#Combine all models into one table
hmhas_adjusted_cc_nocausal_cancre_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     scancre ~ "Spousal cancer",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_excancre ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_excancre ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     scancre ~ "Spousal cancer",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Respiratory disease
######################################################
#Create variable of any chronic conditions 
hmhas_all_sp23 <- hmhas_all_sp23 %>% mutate(
  rchrondis_exrespe = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1hrtatte, r1stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1hrtatte, r1stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2hrtatte, r2stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2hrtatte, r2stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3hrtatte, r3stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3hrtatte, r3stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4diabe, r4cancre, r4hrtatte, r4stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4diabe, r4cancre, r4hrtatte, r4stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5diabe, r5cancre, r5hrtatte, r5stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5diabe, r5cancre, r5hrtatte, r5stroke),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other chronic disease variable for paired spouses
hmhas_all_sp23 <- hmhas_all_sp23 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exrespe = if_else(person_num == 1, rchrondis_exrespe[2], rchrondis_exrespe[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hmhas_male <- hmhas_all_sp23 %>% filter(ragender==1) 
hmhas_female <- hmhas_all_sp23 %>% filter(ragender==2) 

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation to account for assortative mating
m1 <- glm(arthritis ~ srespe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2), data=hmhas_male, family=binomial)
#Model 2: additionally adjusting for household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ srespe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ srespe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + rdrinkr + rsmokev + rchrondis_exrespe + rameduc_m + rafeduc_m + rclstress, data=hmhas_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ srespe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis_exrespe + schrondis_exrespe + rameduc_m + rafeduc_m + smomeducl + sdadeducl+ rclstress + sclstress, data=hmhas_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ srespe + rbmicat2 + raeducl + as.factor(roccup2_2), data=hmhas_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ srespe + rbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_male, family=binomial)

#Combine all models into one table
hmhas_adjusted_cc_nocausal_respe_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     srespe ~ "Spousal respiratory disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     srespe ~ "Spousal respiratory disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     srespe ~ "Spousal respiratory disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exrespe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     srespe ~ "Spousal respiratory disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exrespe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exrespe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     srespe ~ "Spousal respiratory disease",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     srespe ~ "Spousal respiratory disease",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ srespe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2), data=hmhas_female, family=binomial)
#Model 2: additionally adjusting for household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ srespe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ srespe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + rdrinkr + rsmokev + rchrondis_exrespe + rameduc_m + rafeduc_m + rclstress, data=hmhas_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ srespe + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis_exrespe + schrondis_exrespe + rameduc_m + rafeduc_m + smomeducl + sdadeducl+ rclstress + sclstress, data=hmhas_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ srespe + rbmicat2 + raeducl + as.factor(roccup2_2), data=hmhas_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ srespe + rbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_female, family=binomial)

#Combine all models into one table
hmhas_adjusted_cc_nocausal_respe_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     srespe ~ "Spousal respiratory disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     srespe ~ "Spousal respiratory disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     srespe ~ "Spousal respiratory disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exrespe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     srespe ~ "Spousal respiratory disease",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exrespe ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exrespe ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     srespe ~ "Spousal respiratory disease",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     srespe ~ "Spousal respiratory disease",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Heart attack
######################################################
#Create variable of any chronic conditions 
hmhas_all_sp23 <- hmhas_all_sp23 %>% mutate(
  rchrondis_exhrtatte = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1respe, r1stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1respe, r1stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2respe, r2stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2respe, r2stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3respe, r3stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3respe, r3stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4diabe, r4cancre, r4respe, r4stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4diabe, r4cancre, r4respe, r4stroke),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5diabe, r5cancre, r5respe, r5stroke), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5diabe, r5cancre, r5respe, r5stroke),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other chronic disease variable for paired spouses
hmhas_all_sp23 <- hmhas_all_sp23 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exhrtatte = if_else(person_num == 1, rchrondis_exhrtatte[2], rchrondis_exhrtatte[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hmhas_male <- hmhas_all_sp23 %>% filter(ragender==1) 
hmhas_female <- hmhas_all_sp23 %>% filter(ragender==2) 

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation to account for assortative mating
m1 <- glm(arthritis ~ shrtatte + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2), data=hmhas_male, family=binomial)
#Model 2: additionally adjusting for household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ shrtatte + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ shrtatte + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + rdrinkr + rsmokev + rchrondis_exhrtatte + rameduc_m + rafeduc_m + rclstress, data=hmhas_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ shrtatte + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis_exhrtatte + schrondis_exhrtatte + rameduc_m + rafeduc_m + smomeducl + sdadeducl+ rclstress + sclstress, data=hmhas_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ shrtatte + rbmicat2 + raeducl + as.factor(roccup2_2), data=hmhas_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ shrtatte + rbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_male, family=binomial)

#Combine all models into one table
hmhas_adjusted_cc_nocausal_hrtatte_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     shrtatte ~ "Spousal heart attack",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     shrtatte ~ "Spousal heart attack",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     shrtatte ~ "Spousal heart attack",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhrtatte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     shrtatte ~ "Spousal heart attack",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhrtatte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhrtatte ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     shrtatte ~ "Spousal heart attack",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     shrtatte ~ "Spousal heart attack",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ shrtatte + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2), data=hmhas_female, family=binomial)
#Model 2: additionally adjusting for household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ shrtatte + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ shrtatte + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + rdrinkr + rsmokev + rchrondis_exhrtatte + rameduc_m + rafeduc_m + rclstress, data=hmhas_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ shrtatte + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis_exhrtatte + schrondis_exhrtatte + rameduc_m + rafeduc_m + smomeducl + sdadeducl+ rclstress + sclstress, data=hmhas_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ shrtatte + rbmicat2 + raeducl + as.factor(roccup2_2), data=hmhas_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ shrtatte + rbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_female, family=binomial)

#Combine all models into one table
hmhas_adjusted_cc_nocausal_hrtatte_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     shrtatte ~ "Spousal heart attack",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     shrtatte ~ "Spousal heart attack",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     shrtatte ~ "Spousal heart attack",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhrtatte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     shrtatte ~ "Spousal heart attack",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exhrtatte ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exhrtatte ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     shrtatte ~ "Spousal heart attack",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     shrtatte ~ "Spousal heart attack",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#Stroke
######################################################
#Create variable of any chronic conditions 
hmhas_all_sp23 <- hmhas_all_sp23 %>% mutate(
  rchrondis_exstroke = case_when(
    inclusion_wave=="Wave 1" & if_any(c(r1hibpe, r1diabe, r1cancre, r1respe, r1hrtatte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 1" & if_all(c(r1hibpe, r1diabe, r1cancre, r1respe, r1hrtatte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 2" & if_any(c(r2hibpe, r2diabe, r2cancre, r2respe, r2hrtatte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 2" & if_all(c(r2hibpe, r2diabe, r2cancre, r2respe, r2hrtatte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 3" & if_any(c(r3hibpe, r3diabe, r3cancre, r3respe, r3hrtatte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 3" & if_all(c(r3hibpe, r3diabe, r3cancre, r3respe, r3hrtatte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 4" & if_any(c(r4hibpe, r4diabe, r4cancre, r4respe, r4hrtatte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 4" & if_all(c(r4hibpe, r4diabe, r4cancre, r4respe, r4hrtatte),  ~ .x == 0) ~ 0,
    inclusion_wave=="Wave 5" & if_any(c(r5hibpe, r5diabe, r5cancre, r5respe, r5hrtatte), ~ .x == 1) ~ 1,
    inclusion_wave=="Wave 5" & if_all(c(r5hibpe, r5diabe, r5cancre, r5respe, r5hrtatte),  ~ .x == 0) ~ 0,
    # Otherwise NA
    TRUE ~ NA_real_))

#Define any other chronic disease variable for paired spouses
hmhas_all_sp23 <- hmhas_all_sp23 %>%
  group_by(householdID) %>%
  filter(n() == 2) %>%  # Only keep complete pairs
  mutate(
    person_num = row_number(),
    schrondis_exstroke = if_else(person_num == 1, rchrondis_exstroke[2], rchrondis_exstroke[1])) %>%
  ungroup()

#Divide dataset by respondent gender
hmhas_male <- hmhas_all_sp23 %>% filter(ragender==1) 
hmhas_female <- hmhas_all_sp23 %>% filter(ragender==2) 

###Adjusted logistic regression with respondent's arthritis as the outcome and spousal arthritis as exposure 
##Define models
##Male respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation to account for assortative mating
m1 <- glm(arthritis ~ sstroke + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2), data=hmhas_male, family=binomial)
#Model 2: additionally adjusting for household income, and weekly contact with children, to account for measured spousal factors;
m2 <- glm(arthritis ~ sstroke + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_male, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3 <- glm(arthritis ~ sstroke + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + rdrinkr + rsmokev + rchrondis_exstroke + rameduc_m + rafeduc_m + rclstress, data=hmhas_male, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4 <- glm(arthritis ~ sstroke + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis_exstroke + schrondis_exstroke + rameduc_m + rafeduc_m + smomeducl + sdadeducl+ rclstress + sclstress, data=hmhas_male, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5 <- glm(arthritis ~ sstroke + rbmicat2 + raeducl + as.factor(roccup2_2), data=hmhas_male, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6 <- glm(arthritis ~ sstroke + rbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_male, family=binomial)

#Combine all models into one table
hmhas_adjusted_cc_nocausal_stroke_male <- tbl_merge(
  tbls = list(
    tbl_regression(m1, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exstroke ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))

##Female respondents
#Model 1: adjusting for respondent and spousal age, BMI, education, occupation, race and religion to account for assortative mating
m1_f <- glm(arthritis ~ sstroke + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2), data=hmhas_female, family=binomial)
#Model 2: additionally adjusting for household income, and weekly contact with children, to account for measured spousal factors;
m2_f <- glm(arthritis ~ sstroke + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_female, family=binomial)
#Model 3: further adjusting for individual-level (respondent) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m3_f <- glm(arthritis ~ sstroke + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + rdrinkr + rsmokev + rchrondis_exstroke + rameduc_m + rafeduc_m + rclstress, data=hmhas_female, family=binomial)
#Model 4: further adjusting for individual-level (spouse) factors including physical activity, drinking, ever smoking, any other chronic conditions, maternal education, paternal education, and childhood/lifetime stressful events, to account for potential residue confounding 
m4_f <- glm(arthritis ~ sstroke + rage + sage + rbmicat2 + sbmicat2 + raeducl + seducl + as.factor(roccup2_2) + as.factor(soccup2_2) + hrural2 + hitot + hkcnt + rpactvg + spactvg + rdrinkr + sdrinkr + rsmokev + ssmokev + rchrondis_exstroke + schrondis_exstroke + rameduc_m + rafeduc_m + smomeducl + sdadeducl+ rclstress + sclstress, data=hmhas_female, family=binomial)
#Model 5: Minimal suffice adjustment sets based on DAG
m5_f <- glm(arthritis ~ sstroke + rbmicat2 + raeducl + as.factor(roccup2_2), data=hmhas_female, family=binomial)
#Model 6: Model 5 additionaly adjusted for household living area, length of marriage, household income, and weekly contact with children, to account for measured spousal factors;
m6_f <- glm(arthritis ~ sstroke + rbmicat2 + raeducl + as.factor(roccup2_2) + hrural2 + hitot + hkcnt, data=hmhas_female, family=binomial)

#Combine all models into one table
hmhas_adjusted_cc_nocausal_stroke_female <- tbl_merge(
  tbls = list(
    tbl_regression(m1_f, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation")) %>%
      modify_header(estimate = "**Model 1 adjusted OR (95% CI)**"),
    
    tbl_regression(m2_f, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 2 adjusted OR (95% CI)**"),
    
    tbl_regression(m3_f, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day ",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 3 adjusted OR (95% CI)**"),
    
    tbl_regression(m4_f, exponentiate = TRUE,
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rage ~ "Respondent's age at interview",
                     sage ~ "Spousal age at interview",
                     rbmicat2 ~ "Respondent's measured BMI",
                     sbmicat2 ~ "Spousal measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     seducl ~ "Spousal highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     `as.factor(soccup2_2)` ~ "Spousal occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children",
                     rpactvg ~ "Respondent's physical activity",
                     rdrinkr ~ "Respondent's number of drinks per day",
                     rsmokev ~ "Respondent's ever smoking",
                     rchrondis_exstroke ~ "Respondent's any other chronic diseases",
                     rclstress ~ "Respondent's childhood/lifetime stressful events",
                     spactvg ~ "Spousal physical activity",
                     sdrinkr ~ "Spousal number of drinks per day",
                     ssmokev ~ "Spousal ever smoking",
                     schrondis_exstroke ~ "Spousal any other chronic diseases",
                     sclstress ~ "Spousal childhood/lifetime stressful events")) %>%
      modify_header(estimate = "**Model 4 adjusted OR (95% CI)**"),
    
    tbl_regression(m5_f, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation")) %>%
      modify_header(estimate = "**Model 5 adjusted OR (95% CI)**"),
    
    tbl_regression(m6_f, exponentiate = TRUE, 
                   label = list(
                     sstroke ~ "Spousal stroke",
                     rbmicat2 ~ "Respondent's measured BMI",
                     raeducl ~ "Respondent's highest attained education",
                     `as.factor(roccup2_2)` ~ "Respondent's occupation",
                     hrural2 ~ "Household living area",
                     hitot ~ "Household income (maximum)",
                     hkcnt ~ "Weekly contact with children")) %>%
      modify_header(estimate = "**Model 6 adjusted OR (95% CI)**")),
  tab_spanner = c("**Model 1**", "**Model 2**", "**Model 3**", "**Model 4**", "**Model 5**", "**Model 6**"))
######################################################
#KLoSA
######################################################

######################################################
#Save tables as excel
setwd('/Users/wengianche/Documents/UM MACAO FELLOW/Projects/Spousal aggregation of arthritis/Manuscript 1/Output/Statistical data')
#CHARLS
write_xlsx(
  list(
    "hcharls_hibpe_male" = as.data.frame(hcharls_adjusted_cc_nocausal_hibpe_male$table_body),
    "hcharls_hibpe_female" = as.data.frame(hcharls_adjusted_cc_nocausal_hibpe_female$table_body),
    "hcharls_diabe_male" = as.data.frame(hcharls_adjusted_cc_nocausal_diabe_male$table_body),
    "hcharls_diabe_female" = as.data.frame(hcharls_adjusted_cc_nocausal_diabe_female$table_body),
    "hcharls_cancre_male" = as.data.frame(hcharls_adjusted_cc_nocausal_cancre_male$table_body),
    "hcharls_cancre_female" = as.data.frame(hcharls_adjusted_cc_nocausal_cancre_female$table_body),
    "hcharls_lunge_male" = as.data.frame(hcharls_adjusted_cc_nocausal_lunge_male$table_body),
    "hcharls_lunge_female" = as.data.frame(hcharls_adjusted_cc_nocausal_lunge_female$table_body),
    "hcharls_hearte_male" = as.data.frame(hcharls_adjusted_cc_nocausal_hearte_male$table_body),
    "hcharls_hearte_female" = as.data.frame(hcharls_adjusted_cc_nocausal_hearte_female$table_body),
    "hcharls_stroke_male" = as.data.frame(hcharls_adjusted_cc_nocausal_stroke_male$table_body),
    "hcharls_stroke_female" = as.data.frame(hcharls_adjusted_cc_nocausal_stroke_female$table_body),
    "hcharls_psyche_male" = as.data.frame(hcharls_adjusted_cc_nocausal_psyche_male$table_body),
    "hcharls_psyche_female" = as.data.frame(hcharls_adjusted_cc_nocausal_psyche_female$table_body),
    "hcharls_dyslipe_male" = as.data.frame(hcharls_adjusted_cc_nocausal_dyslipe_male$table_body),
    "hcharls_dyslipe_female" = as.data.frame(hcharls_adjusted_cc_nocausal_dyslipe_female$table_body),
    "hcharls_livere_male" = as.data.frame(hcharls_adjusted_cc_nocausal_livere_male$table_body),
    "hcharls_livere_female" = as.data.frame(hcharls_adjusted_cc_nocausal_livere_female$table_body),
    "hcharls_kidneye_male" = as.data.frame(hcharls_adjusted_cc_nocausal_kidneye_male$table_body),
    "hcharls_kidneye_female" = as.data.frame(hcharls_adjusted_cc_nocausal_kidneye_female$table_body),
    "hcharls_digeste_male" = as.data.frame(hcharls_adjusted_cc_nocausal_digeste_male$table_body),
    "hcharls_digeste_female" = as.data.frame(hcharls_adjusted_cc_nocausal_digeste_female$table_body),
    "hcharls_asthmae_male" = as.data.frame(hcharls_adjusted_cc_nocausal_asthmae_male$table_body),
    "hcharls_asthmae_female" = as.data.frame(hcharls_adjusted_cc_nocausal_asthmae_female$table_body)
     ),
  path = "Table_familial_coaggregation_adjusted_nocausal_cc_other_chron_charls_251202.xlsx"
)

#ELSA
write_xlsx(
  list(
    "helsa_hibpe_male" = as.data.frame(helsa_adjusted_cc_nocausal_hibpe_male$table_body),
    "helsa_hibpe_female" = as.data.frame(helsa_adjusted_cc_nocausal_hibpe_female$table_body),
    "helsa_diabe_male" = as.data.frame(helsa_adjusted_cc_nocausal_diabe_male$table_body),
    "helsa_diabe_female" = as.data.frame(helsa_adjusted_cc_nocausal_diabe_female$table_body),
    "helsa_cancre_male" = as.data.frame(helsa_adjusted_cc_nocausal_cancre_male$table_body),
    "helsa_cancre_female" = as.data.frame(helsa_adjusted_cc_nocausal_cancre_female$table_body),
    "helsa_lunge_male" = as.data.frame(helsa_adjusted_cc_nocausal_lunge_male$table_body),
    "helsa_lunge_female" = as.data.frame(helsa_adjusted_cc_nocausal_lunge_female$table_body),
    "helsa_hearte_male" = as.data.frame(helsa_adjusted_cc_nocausal_hearte_male$table_body),
    "helsa_hearte_female" = as.data.frame(helsa_adjusted_cc_nocausal_hearte_female$table_body),
    "helsa_stroke_male" = as.data.frame(helsa_adjusted_cc_nocausal_stroke_male$table_body),
    "helsa_stroke_female" = as.data.frame(helsa_adjusted_cc_nocausal_stroke_female$table_body),
    "helsa_psyche_male" = as.data.frame(helsa_adjusted_cc_nocausal_psyche_male$table_body),
    "helsa_psyche_female" = as.data.frame(helsa_adjusted_cc_nocausal_psyche_female$table_body),
    "helsa_hchole_male" = as.data.frame(helsa_adjusted_cc_nocausal_hchole_male$table_body),
    "helsa_hchole_female" = as.data.frame(helsa_adjusted_cc_nocausal_hchole_female$table_body),
    "helsa_parkine_male" = as.data.frame(helsa_adjusted_cc_nocausal_parkine_male$table_body),
    "helsa_parkine_female" = as.data.frame(helsa_adjusted_cc_nocausal_parkine_female$table_body),
    "helsa_osteoe_male" = as.data.frame(helsa_adjusted_cc_nocausal_osteoe_male$table_body),
    "helsa_osteoe_female" = as.data.frame(helsa_adjusted_cc_nocausal_osteoe_female$table_body),
    "helsa_catracte_male" = as.data.frame(helsa_adjusted_cc_nocausal_catracte_male$table_body),
    "helsa_catracte_female" = as.data.frame(helsa_adjusted_cc_nocausal_catracte_female$table_body),
    "helsa_asthmae_male" = as.data.frame(helsa_adjusted_cc_nocausal_asthmae_male$table_body),
    "helsa_asthmae_female" = as.data.frame(helsa_adjusted_cc_nocausal_asthmae_female$table_body)
  ),
  path = "Table_familial_coaggregation_adjusted_nocausal_cc_other_chron_elsa_251203.xlsx"
)

#SHARE
write_xlsx(
  list(
    "hshare_hibpe_male" = as.data.frame(hshare_adjusted_cc_nocausal_hibpe_male$table_body),
    "hshare_hibpe_female" = as.data.frame(hshare_adjusted_cc_nocausal_hibpe_female$table_body),
    "hshare_diabe_male" = as.data.frame(hshare_adjusted_cc_nocausal_diabe_male$table_body),
    "hshare_diabe_female" = as.data.frame(hshare_adjusted_cc_nocausal_diabe_female$table_body),
    "hshare_cancre_male" = as.data.frame(hshare_adjusted_cc_nocausal_cancre_male$table_body),
    "hshare_cancre_female" = as.data.frame(hshare_adjusted_cc_nocausal_cancre_female$table_body),
    "hshare_lunge_male" = as.data.frame(hshare_adjusted_cc_nocausal_lunge_male$table_body),
    "hshare_lunge_female" = as.data.frame(hshare_adjusted_cc_nocausal_lunge_female$table_body),
    "hshare_hearte_male" = as.data.frame(hshare_adjusted_cc_nocausal_hearte_male$table_body),
    "hshare_hearte_female" = as.data.frame(hshare_adjusted_cc_nocausal_hearte_female$table_body),
    "hshare_stroke_male" = as.data.frame(hshare_adjusted_cc_nocausal_stroke_male$table_body),
    "hshare_stroke_female" = as.data.frame(hshare_adjusted_cc_nocausal_stroke_female$table_body),
    "hshare_psyche_male" = as.data.frame(hshare_adjusted_cc_nocausal_psyche_male$table_body),
    "hshare_psyche_female" = as.data.frame(hshare_adjusted_cc_nocausal_psyche_female$table_body),
    "hshare_hchole_male" = as.data.frame(hshare_adjusted_cc_nocausal_hchole_male$table_body),
    "hshare_hchole_female" = as.data.frame(hshare_adjusted_cc_nocausal_hchole_female$table_body),
    "hshare_parkine_male" = as.data.frame(hshare_adjusted_cc_nocausal_parkine_male$table_body),
    "hshare_parkine_female" = as.data.frame(hshare_adjusted_cc_nocausal_parkine_female$table_body),
    "hshare_ulcere_male" = as.data.frame(hshare_adjusted_cc_nocausal_ulcere_male$table_body),
    "hshare_ulcere_female" = as.data.frame(hshare_adjusted_cc_nocausal_ulcere_female$table_body),
    "hshare_catracte_male" = as.data.frame(hshare_adjusted_cc_nocausal_catracte_male$table_body),
    "hshare_catracte_female" = as.data.frame(hshare_adjusted_cc_nocausal_catracte_female$table_body)),
  path = "Table_familial_coaggregation_adjusted_nocausal_cc_other_chron_share_251203.xlsx"
)

#MHAS
write_xlsx(
  list(
    "hmhas_hibpe_male" = as.data.frame(hmhas_adjusted_cc_nocausal_hibpe_male$table_body),
    "hmhas_hibpe_female" = as.data.frame(hmhas_adjusted_cc_nocausal_hibpe_female$table_body),
    "hmhas_diabe_male" = as.data.frame(hmhas_adjusted_cc_nocausal_diabe_male$table_body),
    "hmhas_diabe_female" = as.data.frame(hmhas_adjusted_cc_nocausal_diabe_female$table_body),
    "hmhas_cancre_male" = as.data.frame(hmhas_adjusted_cc_nocausal_cancre_male$table_body),
    "hmhas_cancre_female" = as.data.frame(hmhas_adjusted_cc_nocausal_cancre_female$table_body),
    "hmhas_respe_male" = as.data.frame(hmhas_adjusted_cc_nocausal_respe_male$table_body),
    "hmhas_respe_female" = as.data.frame(hmhas_adjusted_cc_nocausal_respe_female$table_body),
    "hmhas_hrtatte_male" = as.data.frame(hmhas_adjusted_cc_nocausal_hrtatte_male$table_body),
    "hmhas_hrtatte_female" = as.data.frame(hmhas_adjusted_cc_nocausal_hrtatte_female$table_body),
    "hmhas_stroke_male" = as.data.frame(hmhas_adjusted_cc_nocausal_stroke_male$table_body),
    "hmhas_stroke_female" = as.data.frame(hmhas_adjusted_cc_nocausal_stroke_female$table_body)),
  path = "Table_familial_coaggregation_adjusted_nocausal_cc_other_chron_mhas_251203.xlsx"
)


###################################################### 
#5. Complete case_Spousal coaggregation of other chronic diseases in individuals with arthritis/rheumatism: Adjusted models (Causal direction from other chronic disease to arthritis)
###################################################### 
###################################################### 
###################################################### 
#ADDITIONAL ANALYSES
#1. Exclude Proxy interview: Crude models
#2. Exclude Proxy interview: Adjusted models
#3. Requiring >=2 self-reported doctor diagnosed arthritis across participating waves: Crude models
#4. Requiring >=2 self-reported doctor diagnosed arthritis across participating waves: Adjusted models
#5. Requiring >=2 self-reported doctor diagnosed other chronic diseases across participating waves: Crude models
#6. Requiring >=2 self-reported doctor diagnosed other chronic diseases across participating waves: Adjusted models
###################################################### 
#1. Exclude Proxy interview: Crude models
###################################################### 
###################################################### 
#2. Exclude Proxy interview: Adjusted models
###################################################### 
###################################################### 
#3. Requiring >=2 self-reported doctor diagnosed arthritis across participating waves: Crude models
###################################################### 
###################################################### 
#4. Requiring >=2 self-reported doctor diagnosed arthritis across participating waves: Adjusted models
###################################################### 
###################################################### 
#5. Requiring >=2 self-reported doctor diagnosed other chronic diseases across participating waves: Crude models
###################################################### 
###################################################### 
#6. Requiring >=2 self-reported doctor diagnosed other chronic diseases across participating waves: Adjusted models
###################################################### 
###################################################### 
